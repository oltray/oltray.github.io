var e=Object.defineProperty,t=(t,n,s)=>((t,n,s)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[n]=s)(t,"symbol"!=typeof n?n+"":n,s);import{r as n,a as s,g as a,R as r,N as o,O as l,H as i,b as c,d}from"./react-vendor-BpfFb6RJ.js";import{c as x,R as m,A as h,C as u,X as p,Y as f,T as y,L as g,a as b,P as v,b as j,d as N,B as w,e as k,f as S,g as M,h as C,i as A,j as D,k as z,l as $,m as F,n as I}from"./chart-vendor-DBG9Y8C0.js";import{X as P}from"./db-vendor-DCtitoAh.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var E={exports:{}},B={},O=n,R=Symbol.for("react.element"),T=Symbol.for("react.fragment"),L=Object.prototype.hasOwnProperty,q=O.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,W={key:!0,ref:!0,__self:!0,__source:!0};function V(e,t,n){var s,a={},r=null,o=null;for(s in void 0!==n&&(r=""+n),void 0!==t.key&&(r=""+t.key),void 0!==t.ref&&(o=t.ref),t)L.call(t,s)&&!W.hasOwnProperty(s)&&(a[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps)void 0===a[s]&&(a[s]=t[s]);return{$$typeof:R,type:e,key:r,ref:o,props:a,_owner:q.current}}B.Fragment=T,B.jsx=V,B.jsxs=V,E.exports=B;var H=E.exports,U={},K=s;U.createRoot=K.createRoot,U.hydrateRoot=K.hydrateRoot;
/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
var Y={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};
/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=(e,t)=>{const s=n.forwardRef(({color:s="currentColor",size:a=24,strokeWidth:r=2,absoluteStrokeWidth:o,className:l="",children:i,...c},d)=>{return n.createElement("svg",{ref:d,...Y,width:a,height:a,stroke:s,strokeWidth:o?24*Number(r)/Number(a):r,className:["lucide",`lucide-${x=e,x.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim()}`,l].join(" "),...c},[...t.map(([e,t])=>n.createElement(e,t)),...Array.isArray(i)?i:[i]]);var x});return s.displayName=`${e}`,s},_=G("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]),X=G("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),Z=G("ArrowDownRight",[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]]),J=G("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]),Q=G("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]),ee=G("Brain",[["path",{d:"M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 1.98-3A2.5 2.5 0 0 1 9.5 2Z",key:"1mhkh5"}],["path",{d:"M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 14.5 2Z",key:"1d6s00"}]]),te=G("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),ne=G("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),se=G("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),ae=G("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),re=G("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),oe=G("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),le=G("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),ie=G("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]),ce=G("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]),de=G("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),xe=G("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),me=G("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),he=G("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),ue=G("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),pe=G("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]),fe=G("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),ye=G("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",key:"1xcu5"}],["circle",{cx:"17.5",cy:"10.5",r:".5",key:"736e4u"}],["circle",{cx:"8.5",cy:"7.5",r:".5",key:"clrty"}],["circle",{cx:"6.5",cy:"12.5",r:".5",key:"1s4xz9"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]),ge=G("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]),be=G("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]),ve=G("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),je=G("PiggyBank",[["path",{d:"M19 5c-1.5 0-2.8 1.4-3 2-3.5-1.5-11-.3-11 5 0 1.8 0 3 2 4.5V20h4v-2h3v2h4v-4c1-.5 1.7-1 2-2h2v-4h-2c0-1-.5-1.5-1-2h0V5z",key:"uf6l00"}],["path",{d:"M2 9v1c0 1.1.9 2 2 2h1",key:"nm575m"}],["path",{d:"M16 11h0",key:"k2aug8"}]]),Ne=G("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),we=G("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1-2-1Z",key:"wqdwcb"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17V7",key:"pyj7ub"}]]),ke=G("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),Se=G("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Me=G("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]),Ce=G("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]),Ae=G("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),De=G("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]),ze=G("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),$e=G("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),Fe=G("XOctagon",[["polygon",{points:"7.86 2 16.14 2 22 7.86 22 16.14 16.14 22 7.86 22 2 16.14 2 7.86 7.86 2",key:"h1p8hx"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),Ie=G("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Pe=G("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),Ee={},Be=e=>{let t;const n=new Set,s=(e,s)=>{const a="function"==typeof e?e(t):e;if(!Object.is(a,t)){const e=t;t=(null!=s?s:"object"!=typeof a||null===a)?a:Object.assign({},t,a),n.forEach(n=>n(t,e))}},a=()=>t,r={setState:s,getState:a,getInitialState:()=>o,subscribe:e=>(n.add(e),()=>n.delete(e)),destroy:()=>{"production"!==(Ee?"production":void 0)&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},o=t=e(s,a,r);return r};var Oe={exports:{}},Re={},Te={exports:{}},Le={},qe=n;var We="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},Ve=qe.useState,He=qe.useEffect,Ue=qe.useLayoutEffect,Ke=qe.useDebugValue;function Ye(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!We(e,n)}catch(s){return!0}}var Ge="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var n=t(),s=Ve({inst:{value:n,getSnapshot:t}}),a=s[0].inst,r=s[1];return Ue(function(){a.value=n,a.getSnapshot=t,Ye(a)&&r({inst:a})},[e,n,t]),He(function(){return Ye(a)&&r({inst:a}),e(function(){Ye(a)&&r({inst:a})})},[e]),Ke(n),n};Le.useSyncExternalStore=void 0!==qe.useSyncExternalStore?qe.useSyncExternalStore:Ge,Te.exports=Le;var _e=Te.exports,Xe=n,Ze=_e;
/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Je="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},Qe=Ze.useSyncExternalStore,et=Xe.useRef,tt=Xe.useEffect,nt=Xe.useMemo,st=Xe.useDebugValue;Re.useSyncExternalStoreWithSelector=function(e,t,n,s,a){var r=et(null);if(null===r.current){var o={hasValue:!1,value:null};r.current=o}else o=r.current;r=nt(function(){function e(e){if(!i){if(i=!0,r=e,e=s(e),void 0!==a&&o.hasValue){var t=o.value;if(a(t,e))return l=t}return l=e}if(t=l,Je(r,e))return t;var n=s(e);return void 0!==a&&a(t,n)?(r=e,t):(r=e,l=n)}var r,l,i=!1,c=void 0===n?null:n;return[function(){return e(t())},null===c?void 0:function(){return e(c())}]},[t,n,s,a]);var l=Qe(e,r[0],r[1]);return tt(function(){o.hasValue=!0,o.value=l},[l]),st(l),l},Oe.exports=Re;const at=a(Oe.exports),rt={},{useDebugValue:ot}=r,{useSyncExternalStoreWithSelector:lt}=at;let it=!1;const ct=e=>e;const dt=e=>{"production"!==(rt?"production":void 0)&&"function"!=typeof e&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t="function"==typeof e?(e=>e?Be(e):Be)(e):e,n=(e,n)=>function(e,t=ct,n){"production"!==(rt?"production":void 0)&&n&&!it&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),it=!0);const s=lt(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return ot(s),s}(t,e,n);return Object.assign(n,t),n},xt=e=>e?dt(e):dt,mt=xt(e=>({theme:localStorage.getItem("finvis-theme")||"y2k",sidebarOpen:!1,setTheme:t=>{localStorage.setItem("finvis-theme",t),document.documentElement.setAttribute("data-theme",t),e({theme:t})},toggleSidebar:()=>e(e=>({sidebarOpen:!e.sidebarOpen})),setSidebarOpen:t=>e({sidebarOpen:t})})),ht=[{to:"/",icon:pe,label:"Dashboard"},{to:"/bills",icon:we,label:"Bills"},{to:"/debt",icon:ie,label:"Debt"},{to:"/income",icon:de,label:"Income"},{to:"/forecast",icon:ze,label:"Forecast"},{to:"/settings",icon:Se,label:"Settings"}];function ut(){const{sidebarOpen:e,setSidebarOpen:t}=mt();return H.jsxs(H.Fragment,{children:[e&&H.jsx("div",{className:"fixed inset-0 z-40 bg-black/50 lg:hidden",onClick:()=>t(!1)}),H.jsxs("aside",{className:x("fixed top-0 left-0 z-50 h-full w-60 bg-[var(--color-bg-secondary)] border-r border-[var(--color-border)]","flex flex-col","transform transition-transform duration-200 lg:translate-x-0 lg:static lg:z-auto",e?"translate-x-0":"-translate-x-full"),children:[H.jsxs("div",{className:"flex-shrink-0 flex items-center justify-between p-5 border-b border-[var(--color-border)]",children:[H.jsx("h1",{className:"text-xl font-bold font-display bg-gradient-to-r from-neon-pink to-neon-cyan bg-clip-text text-transparent",children:"FinVis"}),H.jsx("button",{className:"lg:hidden p-1 hover:bg-white/10 rounded",onClick:()=>t(!1),"aria-label":"Close menu",children:H.jsx(Ie,{size:20})})]}),H.jsx("nav",{className:"flex-1 overflow-y-auto p-3 space-y-1",children:ht.map(({to:e,icon:n,label:s})=>H.jsxs(o,{to:e,onClick:()=>t(!1),className:({isActive:e})=>x("flex items-center gap-3 px-4 py-2.5 rounded-lg text-sm font-medium transition-colors",e?"bg-neon-pink/10 text-neon-pink":"text-[var(--color-text-secondary)] hover:text-[var(--color-text-primary)] hover:bg-white/5"),children:[H.jsx(n,{size:18}),s]},e))}),H.jsx("div",{className:"flex-shrink-0 p-4 border-t border-[var(--color-border)]",children:H.jsx("p",{className:"text-xs text-[var(--color-text-muted)] text-center",children:"100% Private · Your Data Stays Local"})})]}),H.jsx("nav",{className:"fixed bottom-0 left-0 right-0 z-30 bg-[var(--color-bg-secondary)] border-t border-[var(--color-border)] lg:hidden",children:H.jsx("div",{className:"flex items-center justify-around py-2",children:ht.slice(0,5).map(({to:e,icon:t,label:n})=>H.jsxs(o,{to:e,className:({isActive:e})=>x("flex flex-col items-center gap-0.5 px-3 py-1 text-xs transition-colors",e?"text-neon-pink":"text-[var(--color-text-muted)]"),children:[H.jsx(t,{size:20}),H.jsx("span",{children:n})]},e))})})]})}function pt(){const e=mt(e=>e.toggleSidebar);return H.jsx("header",{className:"sticky top-0 z-20 bg-[var(--color-bg-primary)]/80 backdrop-blur-md border-b border-[var(--color-border)] lg:hidden",children:H.jsxs("div",{className:"flex items-center gap-4 px-4 py-3",children:[H.jsx("button",{onClick:e,className:"p-1.5 hover:bg-white/10 rounded-lg transition-colors","aria-label":"Toggle menu",children:H.jsx(fe,{size:22})}),H.jsx("h1",{className:"text-lg font-bold font-display bg-gradient-to-r from-neon-pink to-neon-cyan bg-clip-text text-transparent",children:"FinVis"})]})})}function ft(){return H.jsxs("div",{className:"flex min-h-screen",children:[H.jsx(ut,{}),H.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[H.jsx(pt,{}),H.jsx("main",{className:"flex-1 p-4 lg:p-8 pb-20 lg:pb-8",children:H.jsx(l,{})})]})]})}const yt={weekly:"Weekly",biweekly:"Biweekly",monthly:"Monthly",quarterly:"Quarterly",yearly:"Yearly"},gt={housing:"Housing",utilities:"Utilities",transportation:"Transportation",insurance:"Insurance",debt:"Debt",subscriptions:"Subscriptions",lifestyle:"Lifestyle",savings:"Savings",other:"Other"},bt={housing:"#ff0080",utilities:"#00fff9",transportation:"#b026ff",insurance:"#ffff00",debt:"#ff6b35",subscriptions:"#39ff14",lifestyle:"#ff69b4",savings:"#00bfff",other:"#888888"},vt={ongoing:"Ongoing",contract:"Contract",installment:"Installment","one-time":"One-Time"},jt={"credit-card":"Credit Card","student-loan":"Student Loan","personal-loan":"Personal Loan","auto-loan":"Auto Loan",other:"Other"},Nt={fixed:"Fixed APR",variable:"Variable APR"};const wt=new class extends P{constructor(){super("finvis"),t(this,"bills"),t(this,"incomes"),this.version(1).stores({bills:"id, name, category, dueDay, frequency, type",incomes:"id, name, payPeriod"})}},kt={getAll:async()=>wt.bills.toArray(),getById:async e=>wt.bills.get(e),async save(e){await wt.bills.put({...e,updatedAt:(new Date).toISOString()})},async delete(e){await wt.bills.delete(e)},async deleteAll(){await wt.bills.clear()},count:async()=>wt.bills.count()},St=xt((e,t)=>({bills:[],loading:!1,error:null,loadBills:async()=>{e({loading:!0,error:null});try{const t=await kt.getAll();e({bills:t,loading:!1})}catch(t){e({error:"Failed to load bills",loading:!1})}},addBill:async n=>{var s;try{const a=t().bills.length,r="debt"===n.category?`Debt ${a+1}`:`Bill ${a+1}`,o=function(e){const t=(new Date).toISOString();return{id:crypto.randomUUID(),frequency:"monthly",category:"other",dueDay:1,type:"ongoing",isPaid:!1,createdAt:t,updatedAt:t,...e}}({...n,name:(null==(s=n.name)?void 0:s.trim())||r});await kt.save(o),e({bills:[...t().bills,o]})}catch(a){e({error:"Failed to add bill"})}},updateBill:async n=>{try{const s={...n,updatedAt:(new Date).toISOString()};await kt.save(s),e({bills:t().bills.map(e=>e.id===n.id?s:e)})}catch(s){e({error:"Failed to update bill"})}},deleteBill:async n=>{try{await kt.delete(n),e({bills:t().bills.filter(e=>e.id!==n)})}catch(s){e({error:"Failed to delete bill"})}},togglePaid:async n=>{const s=t().bills.find(e=>e.id===n);if(!s)return;const a={...s,isPaid:!s.isPaid,updatedAt:(new Date).toISOString()};await kt.save(a),e({bills:t().bills.map(e=>e.id===n?a:e)})}})),Mt={weekly:"Weekly",biweekly:"Biweekly","semi-monthly":"Semi-Monthly",monthly:"Monthly",annually:"Annually"};const Ct={getAll:async()=>wt.incomes.toArray(),getById:async e=>wt.incomes.get(e),async save(e){await wt.incomes.put({...e,updatedAt:(new Date).toISOString()})},async delete(e){await wt.incomes.delete(e)},async deleteAll(){await wt.incomes.clear()}},At=xt((e,t)=>({incomes:[],loading:!1,error:null,loadIncomes:async()=>{e({loading:!0,error:null});try{const t=await Ct.getAll();e({incomes:t,loading:!1})}catch(t){e({error:"Failed to load income data",loading:!1})}},addIncome:async n=>{var s;try{const a=`Income ${t().incomes.length+1}`,r=function(e){const t=(new Date).toISOString();return{id:crypto.randomUUID(),payPeriod:"monthly",createdAt:t,updatedAt:t,...e}}({...n,name:(null==(s=n.name)?void 0:s.trim())||a});await Ct.save(r),e({incomes:[...t().incomes,r]})}catch(a){e({error:"Failed to add income"})}},updateIncome:async n=>{try{const s={...n,updatedAt:(new Date).toISOString()};await Ct.save(s),e({incomes:t().incomes.map(e=>e.id===n.id?s:e)})}catch(s){e({error:"Failed to update income"})}},deleteIncome:async n=>{try{await Ct.delete(n),e({incomes:t().incomes.filter(e=>e.id!==n)})}catch(s){e({error:"Failed to delete income"})}}})),Dt={weekly:52/12,biweekly:26/12,monthly:1,quarterly:1/3,yearly:1/12},zt={weekly:52/12,biweekly:26/12,"semi-monthly":2,monthly:1,annually:1/12};function $t(e,t){return e*Dt[t]}function Ft(e){return e.amount*zt[e.payPeriod]}function It(e){return e.reduce((e,t)=>e+$t(t.amount,t.frequency),0)}function Pt(e){return e.reduce((e,t)=>e+Ft(t),0)}function Et(e){const t=new Map;for(const s of e){const e=$t(s.amount,s.frequency),n=t.get(s.category)||{total:0,count:0};t.set(s.category,{total:n.total+e,count:n.count+1})}const n=Array.from(t.values()).reduce((e,t)=>e+t.total,0);return Array.from(t.entries()).map(([e,{total:t,count:s}])=>({category:e,total:t,percentage:n>0?t/n*100:0,count:s})).sort((e,t)=>t.total-e.total)}function Bt(e,t,n,s){const a=Pt(t),r=[];let o=0;for(let l=0;l<s;l++){const t=new Date(n.getFullYear(),n.getMonth()+l,1),s=t.getMonth(),i=t.getFullYear(),c=t.toLocaleDateString("en-US",{month:"short",year:"numeric"}),d=e.filter(e=>{if("one-time"===e.type){if(!e.contractEndDate)return!1;const t=new Date(e.contractEndDate);return t.getMonth()===s&&t.getFullYear()===i}return"contract"===e.type&&e.contractEndDate?new Date(e.contractEndDate)>=t:"installment"!==e.type||void 0===e.paymentsRemaining||e.paymentsRemaining>l}).map(e=>({name:e.name,amount:$t(e.amount,e.frequency),category:e.category})),x=d.reduce((e,t)=>e+t.amount,0),m=a-x;o+=m,r.push({month:s,year:i,label:c,totalIncome:a,totalExpenses:x,netCashFlow:m,runningBalance:o,bills:d})}return r}function Ot(e){return 0===e.length?0:e.reduce((e,t)=>e+t,0)/e.length}function Rt(e){if(e.length<2)return 0;const t=Ot(e),n=e.map(e=>(e-t)**2);return Math.sqrt(Ot(n))}function Tt(e,t){const n=Rt(t);return 0===n?0:(e-Ot(t))/n}function Lt(e,t,n){return Math.min(Math.max(e,t),n)}function qt(e,t){const n=Pt(t),s=It(e),a=Lt(2.5*(n>0?(n-s)/n*100:0),0,100),r=Lt(35*t.length,0,100),o=["housing","insurance","debt"],l=Lt(100*(1-e.filter(e=>o.includes(e.category)).reduce((e,t)=>e+t.amount,0)/(e.reduce((e,t)=>e+t.amount,0)||1)),0,100),i=Lt(16.7*(n-s>0?6:n>0?n/s*6:0),0,100),c=Lt(100*(1-(e.length>0?Math.max(...e.map(e=>e.amount/(n||1))):0)),0,100),d=Math.round(.3*a+.15*r+.15*l+.25*i+.15*c);let x,m;return x=d>=85?"A":d>=70?"B":d>=55?"C":d>=40?"D":"F",m=d>=75?"low":d>=55?"moderate":d>=35?"high":"critical",{overall:d,breakdown:{savingsRate:Math.round(a),incomeStability:Math.round(r),expenseFlexibility:Math.round(l),emergencyRunway:Math.round(i),billConcentration:Math.round(c)},grade:x,riskLevel:m}}const Wt=["housing","insurance","debt"],Vt=["lifestyle","subscriptions","other","transportation"];function Ht(e,t,n=6){const s=Bt(e,t,new Date,n),a=new Map;for(const u of s)for(const e of u.bills){const t=e.category;a.has(t)||a.set(t,[]);const n=a.get(t);for(;n.length<s.indexOf(u);)n.push(0);n[s.indexOf(u)]=(n[s.indexOf(u)]||0)+e.amount}const r=Array.from(a.entries()).map(([e,t])=>{const n=function(e){if(e.length<2)return 0;const t=e.length,n=(t-1)/2,s=Ot(e);let a=0,r=0;for(let o=0;o<t;o++)a+=(o-n)*(e[o]-s),r+=(o-n)**2;return 0===r?0:a/r}(t);let s="stable";return n>5?s="rising":n<-5&&(s="falling"),{category:e,monthlyAmounts:t,trend:s,slopePerMonth:n,volatility:Rt(t)}}),o=s.map((e,t)=>{const n=t>0?s[t-1].totalExpenses:e.totalExpenses,a=(r=n,o=e.totalExpenses,0===r?o>0?100:0:(o-r)/Math.abs(r)*100);var r,o;const l=Ot(s.slice(0,t+1).map(e=>e.totalExpenses));return{label:e.label,totalExpenses:e.totalExpenses,changePercent:0===t?0:a,movingAvg:l}}),l=e.filter(e=>Wt.includes(e.category)).reduce((e,t)=>e+$t(t.amount,t.frequency),0),i=e.filter(e=>Vt.includes(e.category)).reduce((e,t)=>e+$t(t.amount,t.frequency),0),c=l+i||1,d=[0,0,0,0];for(const u of e){d[Math.min(Math.floor((u.dueDay-1)/7),3)]+=$t(u.amount,u.frequency)}const x=d.indexOf(Math.max(...d)),m=r.filter(e=>"rising"===e.trend).sort((e,t)=>t.slopePerMonth-e.slopePerMonth),h=r.filter(e=>"falling"===e.trend).sort((e,t)=>e.slopePerMonth-t.slopePerMonth);return{categoryTrends:r,spendingVelocity:o,fixedVsVariableRatio:{fixed:l,variable:i,ratio:l/c},heaviestWeek:{weekLabel:["Days 1-7","Days 8-14","Days 15-21","Days 22-31"][x],amount:d[x]},topGrowingCategory:m[0]||null,topShrinkingCategory:h[0]||null}}function Ut(e){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(e)}function Kt({children:e,hover:t=!1,className:n,...s}){return H.jsx("div",{className:x("rounded-xl border border-[var(--color-border)] bg-[var(--color-bg-secondary)] p-6",t&&"transition-all hover:border-neon-pink/30 hover:shadow-glow-pink",n),...s,children:e})}function Yt(e,t){return new Date(t,e).toLocaleDateString("en-US",{month:"short",year:"numeric"})}const Gt=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];function _t(e,t){if(0===e)return"bg-white/5";const n=e/t;return n<.25?"bg-neon-pink/20":n<.5?"bg-neon-pink/40":n<.75?"bg-neon-pink/60":"bg-neon-pink/80"}function Xt({bills:e}){const t=new Date,[s,a]=n.useState(t.getMonth()),[r,o]=n.useState(t.getFullYear()),l=n.useMemo(()=>function(e,t,n){const s=new Date(t,n+1,0).getDate(),a=[];for(let r=1;r<=s;r++){const t=e.filter(e=>e.dueDay===r),n=t.reduce((e,t)=>e+$t(t.amount,t.frequency),0);a.push({day:r,amount:n,bills:t.map(e=>e.name)})}return a}(e,r,s),[e,r,s]),i=n.useMemo(()=>Math.max(...l.map(e=>e.amount),1),[l]),c=function(e,t){return new Date(t,e+1,0).getDate()}(s,r),d=function(e,t){return new Date(t,e,1).getDay()}(s,r);return H.jsxs(Kt,{children:[H.jsxs("div",{className:"flex items-center justify-between mb-4",children:[H.jsx("h3",{className:"text-lg font-bold font-display",children:"Payment Calendar"}),H.jsxs("div",{className:"flex items-center gap-2",children:[H.jsx("button",{onClick:()=>{0===s?(a(11),o(r-1)):a(s-1)},className:"p-1 hover:bg-white/10 rounded transition-colors","aria-label":"Previous month",children:H.jsx(ae,{size:18})}),H.jsx("span",{className:"text-sm font-mono min-w-[120px] text-center",children:Yt(s,r)}),H.jsx("button",{onClick:()=>{11===s?(a(0),o(r+1)):a(s+1)},className:"p-1 hover:bg-white/10 rounded transition-colors","aria-label":"Next month",children:H.jsx(re,{size:18})})]})]}),H.jsx("div",{className:"grid grid-cols-7 gap-1 mb-1",children:Gt.map(e=>H.jsx("div",{className:"text-xs text-center text-[var(--color-text-muted)] py-1",children:e},e))}),H.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[Array.from({length:d}).map((e,t)=>H.jsx("div",{className:"aspect-square"},`empty-${t}`)),Array.from({length:c}).map((e,t)=>{const n=t+1,s=l.find(e=>e.day===n),a=(null==s?void 0:s.amount)||0,r=(null==s?void 0:s.bills)||[];return H.jsxs("div",{className:`aspect-square rounded-md flex flex-col items-center justify-center relative group cursor-default ${_t(a,i)}`,children:[H.jsx("span",{className:"text-xs font-mono",children:n}),a>0&&H.jsx("span",{className:"text-[10px] font-mono text-neon-pink",children:Ut(a)}),a>0&&H.jsx("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 hidden group-hover:block z-10",children:H.jsxs("div",{className:"bg-[var(--color-bg-primary)] border border-[var(--color-border)] rounded-lg p-2 shadow-lg min-w-[140px]",children:[H.jsx("p",{className:"text-xs font-mono text-neon-cyan mb-1",children:Ut(a)}),r.map(e=>H.jsx("p",{className:"text-xs text-[var(--color-text-secondary)]",children:e},e))]})})]},n)})]}),H.jsxs("div",{className:"flex items-center justify-end gap-2 mt-4",children:[H.jsx("span",{className:"text-xs text-[var(--color-text-muted)]",children:"Less"}),H.jsx("div",{className:"flex gap-1",children:["bg-white/5","bg-neon-pink/20","bg-neon-pink/40","bg-neon-pink/60","bg-neon-pink/80"].map(e=>H.jsx("div",{className:`w-3 h-3 rounded-sm ${e}`},e))}),H.jsx("span",{className:"text-xs text-[var(--color-text-muted)]",children:"More"})]})]})}function Zt({bills:e,incomes:t,months:s=6}){const a=n.useMemo(()=>Bt(e,t,new Date,s),[e,t,s]).map(e=>({name:e.label,income:Math.round(100*e.totalIncome)/100,expenses:Math.round(100*e.totalExpenses)/100,balance:Math.round(100*e.runningBalance)/100}));return H.jsxs(Kt,{children:[H.jsx("h3",{className:"text-lg font-bold font-display mb-4",children:"Cash Flow Forecast"}),H.jsx("div",{className:"h-72",children:H.jsx(m,{width:"100%",height:"100%",children:H.jsxs(h,{data:a,margin:{top:5,right:10,left:0,bottom:0},children:[H.jsxs("defs",{children:[H.jsxs("linearGradient",{id:"incomeGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[H.jsx("stop",{offset:"5%",stopColor:"#39ff14",stopOpacity:.3}),H.jsx("stop",{offset:"95%",stopColor:"#39ff14",stopOpacity:0})]}),H.jsxs("linearGradient",{id:"expenseGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[H.jsx("stop",{offset:"5%",stopColor:"#ff0080",stopOpacity:.3}),H.jsx("stop",{offset:"95%",stopColor:"#ff0080",stopOpacity:0})]})]}),H.jsx(u,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.05)"}),H.jsx(p,{dataKey:"name",stroke:"var(--color-text-muted)",fontSize:12,fontFamily:"Space Mono"}),H.jsx(f,{stroke:"var(--color-text-muted)",fontSize:12,fontFamily:"Space Mono",tickFormatter:e=>`$${(e/1e3).toFixed(1)}k`}),H.jsx(y,{contentStyle:{backgroundColor:"var(--color-bg-primary)",border:"1px solid var(--color-border)",borderRadius:"8px",fontFamily:"Space Mono",fontSize:"12px"},formatter:e=>Ut(e)}),H.jsx(g,{wrapperStyle:{fontFamily:"Space Mono",fontSize:"12px"}}),H.jsx(b,{type:"monotone",dataKey:"income",stroke:"#39ff14",fill:"url(#incomeGradient)",strokeWidth:2,name:"Income"}),H.jsx(b,{type:"monotone",dataKey:"expenses",stroke:"#ff0080",fill:"url(#expenseGradient)",strokeWidth:2,name:"Expenses"})]})})})]})}function Jt({active:e,payload:t}){if(!e||!(null==t?void 0:t.length))return null;const n=t[0].payload;return H.jsxs("div",{style:{backgroundColor:"#0d0117",border:`1px solid ${n.color}`,borderRadius:"8px",padding:"8px 12px",fontFamily:"Space Mono, monospace",fontSize:"12px",boxShadow:`0 0 12px ${n.color}33`},children:[H.jsx("p",{style:{color:n.color,fontWeight:"bold",marginBottom:"4px"},children:n.name}),H.jsxs("p",{style:{color:"#ffffff",marginBottom:"2px"},children:[Ut(n.value),H.jsx("span",{style:{color:"rgba(255,255,255,0.4)",fontSize:"10px"},children:"/mo"})]}),H.jsxs("p",{style:{color:"rgba(255,255,255,0.5)",fontSize:"10px"},children:[n.percentage.toFixed(1),"% of spending"]})]})}function Qt({bills:e}){const t=n.useMemo(()=>Et(e),[e]),s=t.map(e=>({name:gt[e.category],value:Math.round(100*e.total)/100,color:bt[e.category],percentage:e.percentage}));return H.jsxs(Kt,{children:[H.jsx("h3",{className:"text-lg font-bold font-display mb-4",children:"Spending by Category"}),0===t.length?H.jsx("p",{className:"text-sm text-[var(--color-text-muted)] text-center py-8",children:"Add bills to see your category breakdown"}):H.jsxs("div",{className:"flex flex-col lg:flex-row items-center gap-6",children:[H.jsx("div",{className:"w-48 h-48 flex-shrink-0",children:H.jsx(m,{width:"100%",height:"100%",children:H.jsxs(v,{children:[H.jsx(j,{data:s,cx:"50%",cy:"50%",innerRadius:45,outerRadius:75,paddingAngle:2,dataKey:"value",children:s.map((e,t)=>H.jsx(N,{fill:e.color},t))}),H.jsx(y,{content:H.jsx(Jt,{})})]})})}),H.jsx("div",{className:"flex-1 w-full space-y-2",children:t.map(e=>H.jsxs("div",{className:"flex items-center gap-3",children:[H.jsx("div",{className:"w-3 h-3 rounded-full flex-shrink-0",style:{backgroundColor:bt[e.category]}}),H.jsx("span",{className:"text-sm flex-1",children:gt[e.category]}),H.jsx("span",{className:"text-sm font-mono text-[var(--color-text-secondary)]",children:Ut(e.total)}),H.jsxs("span",{className:"text-xs text-[var(--color-text-muted)] w-12 text-right",children:[e.percentage.toFixed(1),"%"]})]},e.category))})]})]})}function en({bills:e,incomes:t,months:s=6}){const a=n.useMemo(()=>Bt(e,t,new Date,s),[e,t,s]).map(e=>({name:e.label,income:Math.round(e.totalIncome),expenses:Math.round(e.totalExpenses),net:Math.round(e.netCashFlow)}));return H.jsxs(Kt,{children:[H.jsx("h3",{className:"text-lg font-bold font-display mb-4",children:"Income vs Expenses"}),H.jsx("div",{className:"h-56",children:H.jsx(m,{width:"100%",height:"100%",children:H.jsxs(w,{data:a,margin:{top:5,right:10,left:0,bottom:0},children:[H.jsx(u,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.05)"}),H.jsx(p,{dataKey:"name",stroke:"var(--color-text-muted)",fontSize:11,fontFamily:"Space Mono"}),H.jsx(f,{stroke:"var(--color-text-muted)",fontSize:11,fontFamily:"Space Mono",tickFormatter:e=>`$${(e/1e3).toFixed(1)}k`}),H.jsx(y,{contentStyle:{backgroundColor:"var(--color-bg-primary)",border:"1px solid var(--color-border)",borderRadius:"8px",fontSize:"12px"},formatter:e=>Ut(e)}),H.jsx(g,{wrapperStyle:{fontFamily:"Space Mono",fontSize:"11px"}}),H.jsx(k,{dataKey:"income",fill:"#39ff14",radius:[4,4,0,0],name:"Income"}),H.jsx(k,{dataKey:"expenses",fill:"#ff0080",radius:[4,4,0,0],name:"Expenses"})]})})})]})}function tn({bills:e,incomes:t}){const s=n.useMemo(()=>{if(0===t.length||0===e.length)return null;const n=t.reduce((e,t)=>e+Ft(t),0),s=new Map;for(const t of e){const e=$t(t.amount,t.frequency);s.set(t.category,(s.get(t.category)||0)+e)}const a=Array.from(s.entries()).sort((e,t)=>t[1]-e[1]),r=a.reduce((e,[,t])=>e+t,0),o=Math.max(n-r,0),l=300,i=[];let c=10;for(const e of t){const t=Ft(e),s=Math.max(t/n*260,12);i.push({label:e.name,amount:t,color:"#39ff14",x:20,y:c,height:s}),c+=s+6}const d=[];c=10;for(const[e,t]of a){const s=Math.max(t/n*260,12);d.push({label:gt[e],amount:t,color:bt[e],x:460,y:c,height:s}),c+=s+6}if(o>0){const e=Math.max(o/n*260,12);d.push({label:"Savings",amount:o,color:"#00fff9",x:460,y:c,height:e})}return{incomeNodes:i,catNodes:d,svgWidth:600,svgHeight:l,totalIncome:n}},[e,t]);if(!s)return H.jsxs(Kt,{children:[H.jsx("h3",{className:"text-lg font-bold font-display mb-2",children:"Money Flow"}),H.jsx("p",{className:"text-sm text-[var(--color-text-muted)] text-center py-8",children:"Add income and bills to see your money flow"})]});const{incomeNodes:a,catNodes:r,svgWidth:o,svgHeight:l}=s;return H.jsxs(Kt,{children:[H.jsx("h3",{className:"text-lg font-bold font-display mb-4",children:"Money Flow"}),H.jsx("div",{className:"overflow-x-auto",children:H.jsxs("svg",{viewBox:`0 0 ${o} ${l}`,className:"w-full",style:{minWidth:400,maxHeight:300},children:[a.map((e,t)=>r.map((n,o)=>{const l=n.amount/(s.totalIncome||1),i=e.height*l;if(i<.5)return null;const c=e.x+16,d=e.y+o/r.length*e.height,x=n.x,m=n.y+t/a.length*n.height,h=(c+x)/2;return H.jsx("path",{d:`M ${c} ${d} C ${h} ${d}, ${h} ${m}, ${x} ${m}`,fill:"none",stroke:n.color,strokeWidth:Math.max(i,1),opacity:.15},`${t}-${o}`)})),a.map((e,t)=>H.jsxs("g",{children:[H.jsx("rect",{x:e.x,y:e.y,width:16,height:e.height,rx:4,fill:e.color,opacity:.8}),H.jsxs("text",{x:e.x+22,y:e.y+e.height/2+4,fontSize:10,fontFamily:"Space Mono",fill:"var(--color-text-secondary)",children:[e.label," (",Ut(e.amount),")"]})]},`inc-${t}`)),r.map((e,t)=>H.jsxs("g",{children:[H.jsx("rect",{x:e.x,y:e.y,width:16,height:e.height,rx:4,fill:e.color,opacity:.8}),H.jsxs("text",{x:e.x+22,y:e.y+e.height/2+4,fontSize:10,fontFamily:"Space Mono",fill:"var(--color-text-secondary)",children:[e.label," (",Ut(e.amount),")"]})]},`cat-${t}`))]})})]})}function nn({data:e}){const t=e.map(e=>({...e,positive:e.changePercent>=0?e.changePercent:0,negative:e.changePercent<0?e.changePercent:0}));return H.jsxs(Kt,{children:[H.jsx("h3",{className:"text-lg font-bold font-display mb-4",children:"Spending Velocity"}),H.jsx("p",{className:"text-xs text-[var(--color-text-muted)] mb-4",children:"Month-over-month expense change rate with rolling average"}),H.jsx("div",{className:"h-56",children:H.jsx(m,{width:"100%",height:"100%",children:H.jsxs(S,{data:t,margin:{top:5,right:10,left:0,bottom:0},children:[H.jsx(u,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.05)"}),H.jsx(p,{dataKey:"label",stroke:"var(--color-text-muted)",fontSize:11,fontFamily:"Space Mono"}),H.jsx(f,{stroke:"var(--color-text-muted)",fontSize:11,fontFamily:"Space Mono",tickFormatter:e=>`${e.toFixed(0)}%`}),H.jsx(y,{contentStyle:{backgroundColor:"var(--color-bg-primary)",border:"1px solid var(--color-border)",borderRadius:"8px",fontSize:"12px"},formatter:(e,t)=>[`${e.toFixed(1)}%`,"positive"===t?"Increase":"negative"===t?"Decrease":"Moving Avg"]}),H.jsx(M,{y:0,stroke:"rgba(255,255,255,0.2)"}),H.jsx(k,{dataKey:"positive",fill:"#39ff14",radius:[4,4,0,0]}),H.jsx(k,{dataKey:"negative",fill:"#ff4444",radius:[0,0,4,4]}),H.jsx(C,{type:"monotone",dataKey:"movingAvg",stroke:"#00fff9",strokeWidth:2,dot:!1,name:"Avg Expenses"})]})})})]})}function sn({bills:e}){const t=n.useMemo(()=>{if(0===e.length)return[];const t=new Map;for(const s of e){const e=$t(s.amount,s.frequency);t.set(s.category,(t.get(s.category)||0)+e)}const n=Math.max(...t.values(),1);return Array.from(t.entries()).map(([e,t])=>({category:gt[e],current:Math.round(t),fullMark:Math.round(1.2*n)})).sort((e,t)=>t.current-e.current)},[e]);return t.length<3?H.jsxs(Kt,{children:[H.jsx("h3",{className:"text-lg font-bold font-display mb-2",children:"Spending Radar"}),H.jsx("p",{className:"text-sm text-[var(--color-text-muted)] text-center py-8",children:"Add bills in 3+ categories to see radar"})]}):H.jsxs(Kt,{children:[H.jsx("h3",{className:"text-lg font-bold font-display mb-4",children:"Spending Radar"}),H.jsx("div",{className:"h-64",children:H.jsx(m,{width:"100%",height:"100%",children:H.jsxs(A,{data:t,children:[H.jsx(D,{stroke:"rgba(255,255,255,0.1)"}),H.jsx(z,{dataKey:"category",tick:{fill:"var(--color-text-secondary)",fontSize:11,fontFamily:"Space Mono"}}),H.jsx($,{tick:{fill:"var(--color-text-muted)",fontSize:10},tickFormatter:e=>`$${e}`}),H.jsx(F,{name:"Current",dataKey:"current",stroke:"#ff0080",fill:"#ff0080",fillOpacity:.2,strokeWidth:2}),H.jsx(y,{contentStyle:{backgroundColor:"var(--color-bg-primary)",border:"1px solid var(--color-border)",borderRadius:"8px",fontSize:"12px"},formatter:e=>[`$${e}`,"Monthly"]})]})})})]})}function an(e){return e>=75?"#39ff14":e>=55?"#00fff9":e>=35?"#ffff00":"#ff4444"}function rn({score:e,size:t=180}){const n=(t-20)/2,s=t/2,a=t/2,r=Math.PI*n,o=e.overall/100*r,l=an(e.overall);return H.jsxs("div",{className:"flex flex-col items-center",children:[H.jsxs("svg",{width:t,height:t/2+20,viewBox:`0 0 ${t} ${t/2+20}`,children:[H.jsx("path",{d:`M ${s-n} ${a} A ${n} ${n} 0 0 1 ${s+n} ${a}`,fill:"none",stroke:"rgba(255,255,255,0.05)",strokeWidth:10,strokeLinecap:"round"}),H.jsx("path",{d:`M ${s-n} ${a} A ${n} ${n} 0 0 1 ${s+n} ${a}`,fill:"none",stroke:l,strokeWidth:10,strokeLinecap:"round",strokeDasharray:`${r}`,strokeDashoffset:r-o,style:{filter:`drop-shadow(0 0 8px ${l}40)`}}),H.jsx("text",{x:s,y:a-8,textAnchor:"middle",className:"fill-current",style:{fontSize:"32px",fontFamily:"Orbitron, sans-serif",fontWeight:700,fill:l},children:e.overall}),H.jsx("text",{x:s,y:a+12,textAnchor:"middle",style:{fontSize:"11px",fontFamily:"Space Mono",fill:"var(--color-text-muted)"},children:"/ 100"})]}),H.jsxs("div",{className:"text-center mt-1",children:[H.jsxs("span",{className:"text-lg font-bold font-display",style:{color:l},children:["Grade: ",e.grade]}),H.jsxs("p",{className:"text-xs text-[var(--color-text-muted)] capitalize",children:[e.riskLevel," risk"]})]}),H.jsx("div",{className:"w-full mt-4 space-y-1.5",children:Object.entries(e.breakdown).map(([e,t])=>H.jsxs("div",{className:"flex items-center gap-2",children:[H.jsx("span",{className:"text-xs text-[var(--color-text-secondary)] flex-1 capitalize",children:e.replace(/([A-Z])/g," $1").trim()}),H.jsx("div",{className:"w-24 h-1.5 bg-white/5 rounded-full overflow-hidden",children:H.jsx("div",{className:"h-full rounded-full transition-all",style:{width:`${t}%`,backgroundColor:an(t)}})}),H.jsx("span",{className:"text-xs font-mono w-8 text-right",style:{color:an(t)},children:t})]},e))})]})}function on({bills:e}){const t=n.useMemo(()=>{if(0===e.length)return[];const t=e.map(e=>$t(e.amount,e.frequency)),n=Ot(t),s=Rt(t),a=Math.max(...t),r=Math.max(Math.ceil(a/8),25),o=[];for(let e=0;e<=a;e+=r){const l=e+r,i=t.filter(t=>t>=e&&t<l).length;(i>0||e<a)&&o.push({range:`$${e}-${l}`,count:i,isOutlier:e>=n+2*s,from:e})}return o},[e]);return e.length<2?H.jsxs(Kt,{children:[H.jsx("h3",{className:"text-lg font-bold font-display mb-2",children:"Bill Distribution"}),H.jsx("p",{className:"text-sm text-[var(--color-text-muted)] text-center py-8",children:"Add more bills to see distribution"})]}):H.jsxs(Kt,{children:[H.jsx("h3",{className:"text-lg font-bold font-display mb-1",children:"Bill Distribution"}),H.jsx("p",{className:"text-xs text-[var(--color-text-muted)] mb-4",children:"Monthly amounts histogram · Red = outliers"}),H.jsx("div",{className:"h-48",children:H.jsx(m,{width:"100%",height:"100%",children:H.jsxs(w,{data:t,margin:{top:0,right:0,left:0,bottom:0},children:[H.jsx(p,{dataKey:"range",stroke:"var(--color-text-muted)",fontSize:10,fontFamily:"Space Mono"}),H.jsx(f,{stroke:"var(--color-text-muted)",fontSize:10,allowDecimals:!1}),H.jsx(y,{contentStyle:{backgroundColor:"var(--color-bg-primary)",border:"1px solid var(--color-border)",borderRadius:"8px",fontSize:"12px"},formatter:e=>[`${e} bill${1!==e?"s":""}`,"Count"]}),H.jsx(k,{dataKey:"count",radius:[4,4,0,0],children:t.map((e,t)=>H.jsx(N,{fill:e.isOutlier?"#ff4444":"#b026ff"},t))})]})})})]})}const ln=28,cn=58,dn=620-cn-32,xn=200,mn=ln+xn+88;function hn(e,t,n){return 1/(n*Math.sqrt(2*Math.PI))*Math.exp(-.5*Math.pow((e-t)/n,2))}function un({bills:e}){const[t,s]=n.useState(0),[a,r]=n.useState(null),[o,l]=n.useState(0),i=n.useRef(0),c=n.useMemo(()=>{if(e.length<3)return null;const t=e.map(e=>$t(e.amount,e.frequency)),n=t.reduce((e,t)=>e+t,0)/t.length,s=t.reduce((e,t)=>e+Math.pow(t-n,2),0)/t.length,a=Math.sqrt(s);if(a<.01)return null;const r=Math.max(0,n-3.5*a),o=n+3.5*a,l=e=>cn+(e-r)/(o-r)*dn,i=hn(n,n,a),c=`M ${Array.from({length:201},(e,t)=>{const s=r+t/200*(o-r);return`${l(s).toFixed(2)},${(c=hn(s,n,a),ln+xn-c/i*xn).toFixed(2)}`;var c}).join(" L ")}`,d=ln+xn,x=`${c} L ${(cn+dn).toFixed(2)},${d} L ${cn},${d} Z`,m=ln+xn+20,h=e.map((e,t)=>{const s=$t(e.amount,e.frequency),r=(s-n)/a,o=4*((13*t+5)%7-3);return{id:e.id,name:e.name,category:e.category,monthly:s,svgX:l(s),svgY:m+o,zScore:r,isOutlier:Math.abs(r)>2}}),u={left:l(n-a),right:l(n+a)},p={left:l(Math.max(r,n-2*a)),right:l(Math.min(o,n+2*a))},f=[-2,-1,0,1,2].map(e=>n+e*a).filter(e=>e>=r&&e<=o).map(e=>{const t=Math.round((e-n)/a);return{value:e,svgX:l(e),label:0===t?"μ":`${t>0?"+":""}${t}σ`}});return{billDots:h,curvePath:c,areaPath:x,mean:n,std:a,xMin:r,xMax:o,meanSvgX:l(n),sigma1:u,sigma2:p,xTicks:f}},[e]);if(n.useEffect(()=>{if(!c)return;s(0),l(0);let e=null;const t=n=>{e||(e=n);const a=Math.min((n-e)/1400,1),r=a<.5?4*a*a*a:1-Math.pow(-2*a+2,3)/2;s(r*dn),a<1?i.current=requestAnimationFrame(t):l(1)},n=setTimeout(()=>{i.current=requestAnimationFrame(t)},150);return()=>{clearTimeout(n),i.current&&cancelAnimationFrame(i.current)}},[c]),!c)return H.jsxs(Kt,{children:[H.jsx("h3",{className:"text-lg font-bold font-display mb-2",children:"Spending Distribution"}),H.jsx("p",{className:"text-sm text-[var(--color-text-muted)] text-center py-8",children:"Add at least 3 bills to see the distribution curve"})]});const{billDots:d,curvePath:x,areaPath:m,mean:h,std:u,meanSvgX:p,sigma1:f,sigma2:y,xTicks:g}=c,b=ln+xn,v=a?a.svgX>cn+dn/2?a.svgX-182:a.svgX+14:0,j=a?Math.max(ln,a.svgY-88):0;return H.jsxs(Kt,{children:[H.jsxs("div",{className:"flex items-start justify-between mb-1 gap-2 flex-wrap",children:[H.jsxs("div",{children:[H.jsx("h3",{className:"text-lg font-bold font-display",children:"Spending Distribution"}),H.jsxs("p",{className:"text-xs text-[var(--color-text-muted)] mt-0.5",children:["Normal distribution fit · hover a dot to inspect ·"," ",H.jsx("span",{style:{color:"#ef4444"},children:"red ring = outlier (>2σ)"})]})]}),H.jsxs("div",{className:"flex gap-4 text-xs font-mono shrink-0",children:[H.jsxs("span",{className:"text-[var(--color-text-muted)]",children:["μ ",H.jsx("span",{className:"text-neon-cyan",children:Ut(h)})]}),H.jsxs("span",{className:"text-[var(--color-text-muted)]",children:["σ ",H.jsx("span",{className:"text-neon-pink",children:Ut(u)})]})]})]}),H.jsx("div",{className:"w-full overflow-x-auto",children:H.jsxs("svg",{viewBox:`0 0 620 ${mn}`,className:"w-full",style:{minWidth:"300px"},children:[H.jsxs("defs",{children:[H.jsxs("linearGradient",{id:"sbc-fill",x1:"0",y1:"0",x2:"0",y2:"1",children:[H.jsx("stop",{offset:"0%",style:{stopColor:"var(--color-accent)",stopOpacity:.5}}),H.jsx("stop",{offset:"60%",style:{stopColor:"var(--color-accent-secondary)",stopOpacity:.14}}),H.jsx("stop",{offset:"100%",style:{stopColor:"var(--color-accent-secondary)",stopOpacity:0}})]}),H.jsxs("filter",{id:"sbc-outlier-glow",x:"-80%",y:"-80%",width:"260%",height:"260%",children:[H.jsx("feGaussianBlur",{stdDeviation:"3.5",result:"blur"}),H.jsxs("feMerge",{children:[H.jsx("feMergeNode",{in:"blur"}),H.jsx("feMergeNode",{in:"SourceGraphic"})]})]}),H.jsxs("filter",{id:"sbc-dot-glow",x:"-60%",y:"-60%",width:"220%",height:"220%",children:[H.jsx("feGaussianBlur",{stdDeviation:"2",result:"blur"}),H.jsxs("feMerge",{children:[H.jsx("feMergeNode",{in:"blur"}),H.jsx("feMergeNode",{in:"SourceGraphic"})]})]}),H.jsx("clipPath",{id:"sbc-clip",children:H.jsx("rect",{x:cn,y:0,width:t,height:mn})})]}),H.jsx("rect",{x:y.left,y:ln,width:y.right-y.left,height:xn,style:{fill:"var(--color-accent-secondary)",fillOpacity:.05}}),H.jsx("rect",{x:f.left,y:ln,width:f.right-f.left,height:xn,style:{fill:"var(--color-accent-secondary)",fillOpacity:.1}}),[{x:y.left+4,label:"-2σ",opacity:.4},{x:f.left+4,label:"-1σ",opacity:.6},{x:f.right-22,label:"+1σ",opacity:.6},{x:y.right-26,label:"+2σ",opacity:.4}].map(({x:e,label:t,opacity:n})=>H.jsx("text",{x:e,y:ln+13,fontSize:"9",fontFamily:"Space Mono",style:{fill:"var(--color-accent-secondary)",opacity:n},children:t},t)),H.jsx("path",{d:m,fill:"url(#sbc-fill)",clipPath:"url(#sbc-clip)"}),H.jsx("path",{d:x,fill:"none",strokeWidth:"2.5",style:{stroke:"var(--color-accent)"},clipPath:"url(#sbc-clip)"}),H.jsx("line",{x1:p,y1:ln,x2:p,y2:b,strokeWidth:"1.5",strokeDasharray:"5,3",style:{stroke:"var(--color-accent-secondary)"}}),H.jsx("text",{x:p+5,y:ln+16,fontSize:"10",fontFamily:"Space Mono",fontWeight:"bold",style:{fill:"var(--color-accent-secondary)"},children:"μ"}),H.jsx("line",{x1:cn,y1:b,x2:cn+dn,y2:b,strokeWidth:"1",style:{stroke:"var(--color-border)"}}),H.jsx("line",{x1:cn,y1:b+8,x2:cn+dn,y2:b+8,strokeWidth:"1",strokeDasharray:"3,5",style:{stroke:"var(--color-border)"}}),d.map((e,t)=>H.jsxs("g",{style:{cursor:"pointer"},onMouseEnter:()=>r(e),onMouseLeave:()=>r(null),children:[e.isOutlier&&H.jsx("circle",{cx:e.svgX,cy:e.svgY,r:8,fill:"none",stroke:"#ef4444",strokeWidth:"1.5",filter:"url(#sbc-outlier-glow)",opacity:.7*o,style:{transition:`opacity 0.4s ${.1+.012*t}s`}}),H.jsx("circle",{cx:e.svgX,cy:e.svgY,r:e.isOutlier?5:4,fill:bt[e.category],strokeWidth:e.isOutlier?1.5:.5,stroke:e.isOutlier?"#ef4444":"rgba(0,0,0,0.3)",filter:(null==a?void 0:a.id)===e.id?"url(#sbc-dot-glow)":void 0,opacity:o,style:{transition:`opacity 0.3s ${.05+.012*t}s`}})]},e.id)),H.jsx("text",{x:14,y:ln+100,textAnchor:"middle",fontSize:"9",fontFamily:"Space Mono",transform:`rotate(-90, 14, ${ln+100})`,style:{fill:"var(--color-text-muted)"},children:"PROBABILITY DENSITY"}),g.map(e=>H.jsxs("g",{children:[H.jsx("line",{x1:e.svgX,y1:b,x2:e.svgX,y2:b+5,strokeWidth:"1",style:{stroke:"var(--color-border)"}}),H.jsx("text",{x:e.svgX,y:b+46,textAnchor:"middle",fontSize:"9",fontFamily:"Space Mono",style:{fill:"var(--color-text-secondary)"},children:Ut(e.value)}),H.jsx("text",{x:e.svgX,y:b+59,textAnchor:"middle",fontSize:"9",fontFamily:"Space Mono",fontWeight:"μ"===e.label?"bold":"normal",style:{fill:"μ"===e.label?"var(--color-accent-secondary)":"var(--color-text-muted)"},children:e.label})]},e.label)),H.jsx("g",{transform:`translate(${cn}, ${mn-18})`,children:[{styleColor:"var(--color-accent)",opacity:.7,label:"Distribution curve"},{styleColor:"var(--color-accent-secondary)",opacity:.5,label:"±1σ / ±2σ bands"},{styleColor:"var(--color-text-muted)",opacity:1,label:"Individual bills"},{color:"#ef4444",opacity:1,label:"Outliers (>2σ)"}].map(({styleColor:e,color:t,opacity:n,label:s},a)=>H.jsxs("g",{transform:`translate(${130*a}, 0)`,children:[H.jsx("circle",{cx:5,cy:0,r:4,opacity:n,style:e?{fill:e}:void 0,fill:t??void 0}),H.jsx("text",{x:13,y:4,fontSize:"8.5",fontFamily:"Space Mono",style:{fill:"var(--color-text-muted)"},children:s})]},s))}),a&&H.jsxs("g",{children:[H.jsx("rect",{x:v,y:j,width:172,height:82,rx:"7",style:{fill:"var(--color-bg-secondary)",stroke:bt[a.category]},strokeWidth:"1"}),H.jsx("rect",{x:v,y:j,width:172,height:3,rx:"2",fill:bt[a.category],opacity:"0.8"}),H.jsx("text",{x:v+10,y:j+20,fontSize:"11",fontWeight:"bold",fontFamily:"Space Mono",fill:bt[a.category],children:a.name.length>19?a.name.slice(0,17)+"…":a.name}),H.jsxs("text",{x:v+10,y:j+36,fontSize:"11",fontFamily:"Space Mono",style:{fill:"var(--color-text-primary)"},children:[Ut(a.monthly),"/mo"]}),H.jsxs("text",{x:v+10,y:j+51,fontSize:"9.5",fontFamily:"Space Mono",style:{fill:"var(--color-accent-secondary)"},children:["z = ",a.zScore>0?"+":"",a.zScore.toFixed(2),"σ from mean"]}),H.jsxs("text",{x:v+10,y:j+65,fontSize:"9",fontFamily:"Space Mono",style:{fill:"var(--color-text-muted)"},children:[gt[a.category]," ·"," ",Math.abs(a.zScore)>2?"⚠ outlier":Math.abs(a.zScore)>1?"above avg":"typical"]}),H.jsxs("text",{x:v+10,y:j+78,fontSize:"9",fontFamily:"Space Mono",style:{fill:"var(--color-text-muted)"},children:[(a.monthly/h*100).toFixed(0),"% of avg spend"]})]})]})})]})}function pn({values:e,width:t=80,height:n=28,color:s,showTrend:a=!0}){if(e.length<2)return null;const r=Math.min(...e),o=Math.max(...e)-r||1,l=e[e.length-1]-e[0],i=s||(l>=0?"#39ff14":"#ff4444"),c=e.map((s,a)=>`${2+a/(e.length-1)*(t-4)},${2+(1-(s-r)/o)*(n-4)}`).join(" ");return H.jsxs("div",{className:"inline-flex items-center gap-1.5",children:[H.jsxs("svg",{width:t,height:n,className:"flex-shrink-0",children:[H.jsx("polyline",{points:c,fill:"none",stroke:i,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),e.length>0&&H.jsx("circle",{cx:2+(e.length-1)/(e.length-1)*(t-4),cy:2+(1-(e[e.length-1]-r)/o)*(n-4),r:2,fill:i})]}),a&&H.jsxs("span",{className:"text-xs font-mono",style:{color:i},children:[l>=0?"+":"",(l/(e[0]||1)*100).toFixed(0),"%"]})]})}const fn={info:{icon:ue,borderClass:"border-l-neon-cyan",bgClass:"bg-neon-cyan/5",iconClass:"text-neon-cyan"},success:{icon:te,borderClass:"border-l-neon-green",bgClass:"bg-neon-green/5",iconClass:"text-neon-green"},warning:{icon:X,borderClass:"border-l-neon-yellow",bgClass:"bg-neon-yellow/5",iconClass:"text-neon-yellow"},critical:{icon:Fe,borderClass:"border-l-red-500",bgClass:"bg-red-500/5",iconClass:"text-red-400"}};function yn({insight:e,onDismiss:t}){const n=fn[e.severity],s=n.icon;return H.jsxs("div",{className:x("border-l-4 rounded-r-lg p-3 flex items-start gap-3",n.borderClass,n.bgClass),children:[H.jsx(s,{size:18,className:x("flex-shrink-0 mt-0.5",n.iconClass)}),H.jsxs("div",{className:"flex-1 min-w-0",children:[H.jsxs("div",{className:"flex items-center gap-2",children:[H.jsx("h4",{className:"text-sm font-semibold",children:e.title}),e.metric&&H.jsx("span",{className:"text-xs font-mono text-[var(--color-text-muted)] bg-white/5 px-1.5 py-0.5 rounded",children:e.metric})]}),H.jsx("p",{className:"text-xs text-[var(--color-text-secondary)] mt-0.5",children:e.description})]}),t&&H.jsx("button",{onClick:()=>t(e.id),className:"text-[var(--color-text-muted)] hover:text-[var(--color-text-primary)] text-xs","aria-label":"Dismiss",children:"×"})]})}const gn=[{label:"Analyze spending",prompt:"Analyze my spending patterns and suggest optimizations."},{label:"Savings advice",prompt:"How can I improve my savings rate? Give specific suggestions."},{label:"Risk assessment",prompt:"Assess my financial risk and what I should do to improve."},{label:"Budget plan",prompt:"Create a suggested monthly budget based on my income and expenses."},{label:"Reduce bills",prompt:"Which bills or categories should I focus on reducing first?"}],bn=xt((e,t)=>({apiKey:localStorage.getItem("finvis-ai-key")||"",enabled:"true"===localStorage.getItem("finvis-ai-enabled"),messages:[],loading:!1,error:null,setApiKey:t=>{localStorage.setItem("finvis-ai-key",t),e({apiKey:t})},setEnabled:t=>{localStorage.setItem("finvis-ai-enabled",String(t)),e({enabled:t})},sendMessage:async(n,s,a,r)=>{const{apiKey:o,messages:l}=t();if(!o)return void e({error:"API key not configured. Go to Settings to add your Claude API key."});e({loading:!0,error:null});const i=[...l,{role:"user",content:n}];e({messages:i});try{const t=await async function(e,t,n,s,a){var r;const o={model:"claude-sonnet-4-5-20250929",max_tokens:1024,system:`${t}\n\n${n}`,messages:[...s.map(e=>({role:e.role,content:e.content})),{role:"user",content:a}]},l=await fetch("https://api.anthropic.com/v1/messages",{method:"POST",headers:{"Content-Type":"application/json","x-api-key":e,"anthropic-version":"2023-06-01","anthropic-dangerous-direct-browser-access":"true"},body:JSON.stringify(o)});if(!l.ok){const e=await l.text();throw new Error(`API error ${l.status}: ${e}`)}const i=null==(r=(await l.json()).content)?void 0:r.find(e=>"text"===e.type);return(null==i?void 0:i.text)||"No response generated."}(o,"You are FinVis AI, a helpful and non-judgmental financial advisor built into a privacy-first finance app. Your role:\n\n1. Analyze the user's financial data and provide actionable insights\n2. Be encouraging, never shaming about spending\n3. Focus on practical, specific suggestions\n4. Use the financial context provided to give personalized advice\n5. Keep responses concise (2-3 paragraphs max)\n6. Use currency formatting and percentages when relevant\n7. If asked about something outside your financial context, politely redirect\n\nImportant: All user financial data stays on their device. You only see aggregated summaries, never raw transaction data.",function(e,t,n){const s=Pt(t),a=It(e),r=s>0?(s-a)/s*100:0,o=Et(e).map(e=>`  ${gt[e.category]}: ${Ut(e.total)}/mo (${e.percentage.toFixed(1)}%)`).join("\n");return`Financial Overview:\n- Monthly income: ${Ut(s)} from ${t.length} source(s)\n- Monthly expenses: ${Ut(a)} across ${e.length} bill(s)\n- Net monthly: ${Ut(s-a)}\n- Savings rate: ${r.toFixed(1)}%\n- Financial health score: ${n.overall}/100 (Grade: ${n.grade}, ${n.riskLevel} risk)\n\nCategory Breakdown:\n${o}\n\nHealth Score Breakdown:\n- Savings Rate: ${n.breakdown.savingsRate}/100\n- Income Stability: ${n.breakdown.incomeStability}/100\n- Expense Flexibility: ${n.breakdown.expenseFlexibility}/100\n- Emergency Runway: ${n.breakdown.emergencyRunway}/100\n- Bill Concentration: ${n.breakdown.billConcentration}/100`}(s,a,r),l,n);e({messages:[...i,{role:"assistant",content:t}],loading:!1})}catch(c){e({error:c instanceof Error?c.message:"Failed to get AI response",loading:!1})}},clearHistory:()=>e({messages:[],error:null})}));function vn(){const{messages:e,loading:t,error:s,enabled:a,sendMessage:r,clearHistory:o}=bn(),l=St(e=>e.bills),i=At(e=>e.incomes),[c,d]=n.useState(""),[m,h]=n.useState(!1),u=n.useRef(null);if(n.useEffect(()=>{var e;null==(e=u.current)||e.scrollTo(0,u.current.scrollHeight)},[e]),!a)return null;const p=qt(l,i),f=async()=>{const e=c.trim();e&&!t&&(d(""),await r(e,l,i,p))};return H.jsxs("div",{className:"rounded-xl border border-[var(--color-border)] bg-[var(--color-bg-secondary)] overflow-hidden",children:[H.jsxs("button",{onClick:()=>h(!m),className:"w-full flex items-center justify-between p-4 hover:bg-white/5 transition-colors",children:[H.jsxs("div",{className:"flex items-center gap-2",children:[H.jsx(Q,{size:20,className:"text-neon-purple"}),H.jsx("h3",{className:"text-sm font-bold font-display",children:"FinVis AI"}),H.jsx("span",{className:"text-[10px] bg-neon-purple/20 text-neon-purple px-1.5 py-0.5 rounded-full",children:"Claude"})]}),m?H.jsx(se,{size:16}):H.jsx(oe,{size:16})]}),!m&&H.jsxs("div",{className:"border-t border-[var(--color-border)]",children:[H.jsxs("div",{ref:u,className:"h-64 overflow-y-auto p-4 space-y-3",children:[0===e.length&&H.jsxs("div",{className:"text-center py-6",children:[H.jsx(Q,{size:32,className:"mx-auto text-[var(--color-text-muted)] mb-2"}),H.jsx("p",{className:"text-sm text-[var(--color-text-secondary)]",children:"Ask me anything about your finances"}),H.jsx("div",{className:"flex flex-wrap gap-2 justify-center mt-3",children:gn.map(e=>H.jsx("button",{onClick:()=>(async e=>{t||await r(e,l,i,p)})(e.prompt),className:"text-xs px-2.5 py-1 rounded-full border border-[var(--color-border)] text-[var(--color-text-secondary)] hover:border-neon-purple hover:text-neon-purple transition-colors",children:e.label},e.label))})]}),e.map((e,t)=>H.jsx("div",{className:x("text-sm rounded-lg p-3 max-w-[90%]","user"===e.role?"bg-neon-pink/10 ml-auto":"bg-white/5"),children:H.jsx("p",{className:"whitespace-pre-wrap",children:e.content})},t)),t&&H.jsx("div",{className:"bg-white/5 rounded-lg p-3 max-w-[90%]",children:H.jsxs("div",{className:"flex items-center gap-2 text-sm text-[var(--color-text-muted)]",children:[H.jsx("div",{className:"w-2 h-2 bg-neon-purple rounded-full animate-pulse"}),"Thinking..."]})}),s&&H.jsx("div",{className:"text-xs text-red-400 bg-red-500/10 rounded-lg p-2",children:s})]}),H.jsxs("div",{className:"p-3 border-t border-[var(--color-border)] flex gap-2",children:[H.jsx("input",{value:c,onChange:e=>d(e.target.value),onKeyDown:e=>"Enter"===e.key&&f(),placeholder:"Ask FinVis AI...",className:"flex-1 bg-[var(--color-bg-primary)] border border-[var(--color-border)] rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-neon-purple",disabled:t}),H.jsx("button",{onClick:f,disabled:t||!c.trim(),className:"p-2 rounded-lg bg-neon-purple/20 text-neon-purple hover:bg-neon-purple/30 transition-colors disabled:opacity-50",children:H.jsx(ke,{size:16})}),e.length>0&&H.jsx("button",{onClick:o,className:"p-2 rounded-lg hover:bg-white/10 text-[var(--color-text-muted)] transition-colors","aria-label":"Clear chat",children:H.jsx(Ae,{size:16})})]})]})]})}function jn(){return H.jsx("div",{className:"flex items-center justify-center py-16",children:H.jsx("div",{className:"w-10 h-10 border-4 border-[var(--color-border)] border-t-neon-pink rounded-full animate-spin"})})}function Nn(){const{bills:e,loading:t,loadBills:s}=St(),{incomes:a,loading:r,loadIncomes:o}=At(),[l,i]=n.useState(new Set);n.useEffect(()=>{s(),o()},[s,o]);const c=n.useMemo(()=>Pt(a),[a]),d=n.useMemo(()=>It(e),[e]),m=n.useMemo(()=>function(e,t){const n=e.reduce((e,t)=>e+$t(t.amount,t.frequency),0),s=t-n;return{totalExpenses:n,remaining:s,savingsRate:t>0?s/t*100:0,billCount:e.length,paidCount:e.filter(e=>e.isPaid).length}}(e,c),[e,c]),h=n.useMemo(()=>qt(e,a),[e,a]),u=n.useMemo(()=>function(e,t){const n=[],s=Pt(t),a=It(e),r=s>0?(s-a)/s*100:0;if(0===e.length&&0===t.length)return[{id:"empty",title:"Get Started",description:"Add your income sources and bills to unlock smart insights.",severity:"info",category:"setup"}];r>=30?n.push({id:"savings-excellent",title:"Excellent Savings Rate",description:`You're saving ${r.toFixed(1)}% of your income. Outstanding financial discipline.`,severity:"success",category:"savings",metric:`${r.toFixed(1)}%`}):r>=15?n.push({id:"savings-good",title:"Healthy Savings Rate",description:`Saving ${r.toFixed(1)}% — above the recommended 15% minimum.`,severity:"success",category:"savings",metric:`${r.toFixed(1)}%`}):r>=0?n.push({id:"savings-low",title:"Low Savings Rate",description:`Only ${r.toFixed(1)}% savings rate. Consider reducing variable expenses to hit the 15% target.`,severity:"warning",category:"savings",metric:`${r.toFixed(1)}%`}):n.push({id:"savings-negative",title:"Spending Exceeds Income",description:`You're spending ${Ut(Math.abs(s-a))} more than you earn monthly. This is unsustainable.`,severity:"critical",category:"savings",metric:Ut(s-a)});const o=Et(e)[0];if(o&&o.percentage>50&&n.push({id:"concentration-high",title:"High Spending Concentration",description:`${gt[o.category]} accounts for ${o.percentage.toFixed(0)}% of all spending. Consider diversifying costs.`,severity:"warning",category:"concentration",metric:`${o.percentage.toFixed(0)}%`}),e.length>=3){const t=e.map(e=>$t(e.amount,e.frequency));for(let s=0;s<e.length;s++)Tt(t[s],t)>2&&n.push({id:`anomaly-${e[s].id}`,title:"Unusually High Bill",description:`"${e[s].name}" at ${Ut(t[s])}/mo is significantly higher than your average bill (${Ut(Ot(t))}/mo).`,severity:"info",category:"anomaly",metric:Ut(t[s])})}const l=Bt(e,t,new Date,6).filter(e=>e.netCashFlow<0);if(l.length>0&&n.push({id:"forecast-tight",title:`${l.length} Tight Month${l.length>1?"s":""} Ahead`,description:`${l.map(e=>e.label).join(", ")} show negative cash flow. Plan ahead.`,severity:l.length>=3?"critical":"warning",category:"forecast",metric:`${l.length} months`}),e.length>=2){const s=Ht(e,t,6);s.heaviestWeek.amount>0&&n.push({id:"heavy-week",title:"Heaviest Payment Period",description:`${s.heaviestWeek.weekLabel} is your heaviest payment window at ${Ut(s.heaviestWeek.amount)}/mo. Consider spreading due dates.`,severity:"info",category:"pattern",metric:s.heaviestWeek.weekLabel}),s.fixedVsVariableRatio.ratio>.75&&n.push({id:"inflexible",title:"High Fixed Costs",description:`${(100*s.fixedVsVariableRatio.ratio).toFixed(0)}% of spending is fixed (housing, insurance, debt). Limited room to cut in emergencies.`,severity:"warning",category:"flexibility",metric:`${(100*s.fixedVsVariableRatio.ratio).toFixed(0)}%`})}const i=qt(e,t);n.push({id:"health-score",title:`Financial Health: ${i.grade}`,description:`Overall score: ${i.overall}/100 (${i.riskLevel} risk). ${i.overall>=70?"Keep it up!":"Room for improvement."}`,severity:i.overall>=70?"success":i.overall>=45?"warning":"critical",category:"health",metric:`${i.overall}/100`}),1===t.length&&n.push({id:"single-income",title:"Single Income Source",description:"All income comes from one source. Consider diversifying to reduce risk.",severity:"info",category:"income",metric:"1 source"});const c=e.filter(e=>"subscriptions"===e.category);if(c.length>=5){const e=c.reduce((e,t)=>e+$t(t.amount,t.frequency),0);n.push({id:"sub-audit",title:"Subscription Audit Recommended",description:`You have ${c.length} subscriptions totaling ${Ut(e)}/mo. Review for unused services.`,severity:"info",category:"optimization",metric:Ut(e)})}const d={critical:0,warning:1,success:2,info:3};return n.sort((e,t)=>d[e.severity]-d[t.severity]),n}(e,a),[e,a]),p=n.useMemo(()=>Ht(e,a,6),[e,a]),f=n.useMemo(()=>Bt(e,a,new Date,6),[e,a]),y=f.map(e=>e.totalIncome),g=f.map(e=>e.totalExpenses),b=f.map(e=>e.runningBalance),v=u.filter(e=>!l.has(e.id)),j=m.remaining>=0;return t||r?H.jsx(jn,{}):H.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[H.jsxs("header",{className:"flex items-center justify-between",children:[H.jsxs("div",{children:[H.jsx("h1",{className:"text-3xl font-bold font-display bg-gradient-to-r from-neon-pink via-neon-purple to-neon-cyan bg-clip-text text-transparent",children:"Dashboard"}),H.jsx("p",{className:"text-sm text-[var(--color-text-secondary)] mt-1",children:"Financial command center"})]}),H.jsx("div",{className:"flex items-center gap-2",children:H.jsxs("div",{className:x("px-3 py-1.5 rounded-full text-xs font-bold font-mono border",h.overall>=70?"border-neon-green/30 text-neon-green bg-neon-green/10":h.overall>=45?"border-neon-yellow/30 text-neon-yellow bg-neon-yellow/10":"border-red-500/30 text-red-400 bg-red-500/10"),children:["Health: ",h.overall,"/100"]})})]}),H.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[H.jsxs(Kt,{children:[H.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[H.jsx(de,{size:16,className:"text-neon-green"}),H.jsx("span",{className:"text-xs text-[var(--color-text-muted)]",children:"Monthly Income"})]}),H.jsx("p",{className:"text-xl font-bold font-mono text-neon-green",children:Ut(c)}),H.jsx("div",{className:"mt-2",children:H.jsx(pn,{values:y,color:"#39ff14"})})]}),H.jsxs(Kt,{children:[H.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[H.jsx(we,{size:16,className:"text-neon-pink"}),H.jsx("span",{className:"text-xs text-[var(--color-text-muted)]",children:"Monthly Expenses"})]}),H.jsx("p",{className:"text-xl font-bold font-mono text-neon-pink",children:Ut(d)}),H.jsx("div",{className:"mt-2",children:H.jsx(pn,{values:g,color:"#ff0080"})})]}),H.jsxs(Kt,{children:[H.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[j?H.jsx(je,{size:16,className:"text-neon-green"}):H.jsx(X,{size:16,className:"text-red-400"}),H.jsx("span",{className:"text-xs text-[var(--color-text-muted)]",children:"Net Cash Flow"})]}),H.jsxs("p",{className:x("text-xl font-bold font-mono",j?"text-neon-green":"text-red-400"),children:[j?"+":"",Ut(m.remaining)]}),H.jsx("div",{className:"mt-2",children:H.jsx(pn,{values:b})})]}),H.jsxs(Kt,{children:[H.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[H.jsx(_,{size:16,className:"text-neon-purple"}),H.jsx("span",{className:"text-xs text-[var(--color-text-muted)]",children:"Savings Rate"})]}),H.jsxs("p",{className:x("text-xl font-bold font-mono",m.savingsRate>20?"text-neon-green":m.savingsRate>0?"text-neon-yellow":"text-red-400"),children:[m.savingsRate.toFixed(1),"%"]}),H.jsxs("div",{className:"mt-2 flex items-center gap-1.5",children:[m.savingsRate>=15?H.jsx(ze,{size:14,className:"text-neon-green"}):H.jsx(De,{size:14,className:"text-red-400"}),H.jsx("span",{className:"text-xs text-[var(--color-text-muted)]",children:m.savingsRate>=15?"On target":"Below 15% target"})]})]})]}),H.jsxs(Kt,{children:[H.jsxs("div",{className:"flex items-center justify-between mb-3",children:[H.jsx("h3",{className:"text-sm font-semibold text-[var(--color-text-secondary)]",children:"Bills Paid This Month"}),H.jsxs("span",{className:"text-sm font-mono",children:[m.paidCount,"/",m.billCount]})]}),H.jsx("div",{className:"h-2 bg-white/5 rounded-full overflow-hidden",children:H.jsx("div",{className:"h-full bg-gradient-to-r from-neon-pink to-neon-cyan rounded-full transition-all",style:{width:(m.billCount>0?m.paidCount/m.billCount*100:0)+"%"}})})]}),v.length>0&&H.jsxs("div",{children:[H.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[H.jsx(ee,{size:18,className:"text-neon-purple"}),H.jsx("h2",{className:"text-lg font-bold font-display",children:"Smart Insights"}),H.jsx("span",{className:"text-xs bg-neon-purple/20 text-neon-purple px-2 py-0.5 rounded-full",children:v.length})]}),H.jsx("div",{className:"grid gap-2 sm:grid-cols-2",children:v.map(e=>H.jsx(yn,{insight:e,onDismiss:e=>i(t=>new Set([...t,e]))},e.id))})]}),H.jsx(vn,{}),H.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[H.jsx(Zt,{bills:e,incomes:a}),H.jsx(en,{bills:e,incomes:a})]}),H.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[H.jsx(Qt,{bills:e}),H.jsx(tn,{bills:e,incomes:a})]}),H.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[H.jsx(nn,{data:p.spendingVelocity}),H.jsx(sn,{bills:e})]}),H.jsx(Xt,{bills:e}),H.jsx(un,{bills:e}),H.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[H.jsxs(Kt,{children:[H.jsx("h3",{className:"text-lg font-bold font-display mb-4",children:"Financial Health"}),H.jsx(rn,{score:h})]}),H.jsx(on,{bills:e})]})]})}function wn({bill:e,onEdit:t,onDelete:n,onTogglePaid:s}){const a=$t(e.amount,e.frequency);return H.jsx(Kt,{hover:!0,className:x("relative",e.isPaid&&"opacity-60"),children:H.jsxs("div",{className:"flex items-start justify-between gap-3",children:[H.jsxs("div",{className:"flex-1 min-w-0",children:[H.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[H.jsx("div",{className:"w-2.5 h-2.5 rounded-full flex-shrink-0",style:{backgroundColor:bt[e.category]}}),H.jsx("h4",{className:"font-semibold truncate",children:e.name}),e.isPaid&&H.jsx("span",{className:"text-xs bg-neon-green/20 text-neon-green px-2 py-0.5 rounded-full",children:"Paid"})]}),H.jsxs("div",{className:"flex items-baseline gap-2",children:[H.jsx("span",{className:"text-xl font-mono font-bold text-neon-cyan",children:Ut(e.amount)}),H.jsxs("span",{className:"text-xs text-[var(--color-text-muted)]",children:["/ ",yt[e.frequency].toLowerCase()]})]}),"monthly"!==e.frequency&&H.jsxs("p",{className:"text-xs text-[var(--color-text-muted)] font-mono mt-0.5",children:[Ut(a),"/mo equivalent"]}),H.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[H.jsx("span",{className:"text-xs text-[var(--color-text-secondary)] bg-white/5 px-2 py-0.5 rounded",children:gt[e.category]}),H.jsxs("span",{className:"text-xs text-[var(--color-text-muted)]",children:["Due: Day ",e.dueDay]})]}),e.notes&&H.jsx("p",{className:"text-xs text-[var(--color-text-muted)] mt-2 italic",children:e.notes})]}),H.jsxs("div",{className:"flex flex-col gap-1",children:[H.jsx("button",{onClick:()=>s(e.id),className:x("p-1.5 rounded-lg transition-colors",e.isPaid?"bg-neon-green/20 text-neon-green":"hover:bg-white/10 text-[var(--color-text-muted)]"),"aria-label":e.isPaid?"Mark unpaid":"Mark paid",children:H.jsx(ne,{size:16})}),H.jsx("button",{onClick:()=>t(e),className:"p-1.5 rounded-lg hover:bg-white/10 text-[var(--color-text-muted)] transition-colors","aria-label":"Edit bill",children:H.jsx(ve,{size:16})}),H.jsx("button",{onClick:()=>n(e.id),className:"p-1.5 rounded-lg hover:bg-red-500/10 text-[var(--color-text-muted)] hover:text-red-400 transition-colors","aria-label":"Delete bill",children:H.jsx(Ae,{size:16})})]})]})})}function kn({variant:e="primary",size:t="md",children:n,className:s,...a}){return H.jsx("button",{className:x("inline-flex items-center justify-center gap-2 rounded-lg font-semibold transition-all","disabled:opacity-50 disabled:cursor-not-allowed",{"bg-gradient-to-r from-neon-pink via-neon-purple to-neon-cyan text-white hover:shadow-glow-pink hover:-translate-y-0.5 active:translate-y-0":"primary"===e,"border-2 border-neon-cyan text-neon-cyan hover:bg-neon-cyan/10":"secondary"===e,"border-2 border-red-500 text-red-400 hover:bg-red-500/10":"danger"===e,"text-[var(--color-text-secondary)] hover:text-[var(--color-text-primary)] hover:bg-white/5":"ghost"===e},{"px-3 py-1.5 text-sm":"sm"===t,"px-5 py-2.5 text-sm":"md"===t,"px-6 py-3 text-base":"lg"===t},s),...a,children:n})}function Sn({label:e,hint:t,error:n,prefix:s,className:a,id:r,...o}){const l=r||e.toLowerCase().replace(/\s+/g,"-");return H.jsxs("div",{className:"flex flex-col gap-1.5",children:[H.jsx("label",{htmlFor:l,className:"text-sm font-semibold text-[var(--color-text-primary)]",children:e}),H.jsxs("div",{className:"relative",children:[s&&H.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-[var(--color-text-muted)] font-mono",children:s}),H.jsx("input",{id:l,className:x("w-full rounded-lg border-2 border-[var(--color-border)] bg-[var(--color-bg-secondary)]","px-3 py-2.5 text-[var(--color-text-primary)]","transition-colors focus:border-[var(--color-accent)] focus:outline-none","placeholder:text-[var(--color-text-muted)]",s&&"pl-8",n&&"border-red-500",a),"aria-describedby":t?`${l}-hint`:void 0,"aria-invalid":!!n,...o})]}),t&&!n&&H.jsx("span",{id:`${l}-hint`,className:"text-xs text-[var(--color-text-muted)]",children:t}),n&&H.jsx("span",{role:"alert",className:"text-xs text-red-400",children:n})]})}function Mn({label:e,options:t,className:n,id:s,...a}){const r=s||e.toLowerCase().replace(/\s+/g,"-");return H.jsxs("div",{className:"flex flex-col gap-1.5",children:[H.jsx("label",{htmlFor:r,className:"text-sm font-semibold text-[var(--color-text-primary)]",children:e}),H.jsx("select",{id:r,className:x("w-full rounded-lg border-2 border-[var(--color-border)] bg-[var(--color-bg-secondary)]","px-3 py-2.5 text-[var(--color-text-primary)]","transition-colors focus:border-[var(--color-accent)] focus:outline-none",n),...a,children:t.map(e=>H.jsx("option",{value:e.value,children:e.label},e.value))})]})}function Cn({bill:e,onSubmit:t,onCancel:s}){var a,r,o,l;const[i,c]=n.useState((null==e?void 0:e.name)||""),[d,x]=n.useState((null==(a=null==e?void 0:e.amount)?void 0:a.toString())||""),[m,h]=n.useState((null==e?void 0:e.frequency)||"monthly"),[u,p]=n.useState((null==e?void 0:e.category)||"other"),[f,y]=n.useState((null==e?void 0:e.type)||"ongoing"),[g,b]=n.useState((null==(r=null==e?void 0:e.dueDay)?void 0:r.toString())||"1"),[v,j]=n.useState((null==e?void 0:e.notes)||""),[N,w]=n.useState((null==e?void 0:e.debtType)||"credit-card"),[k,S]=n.useState((null==e?void 0:e.aprType)||"fixed"),[M,C]=n.useState((null==(o=null==e?void 0:e.apr)?void 0:o.toString())||""),[A,D]=n.useState((null==(l=null==e?void 0:e.principalBalance)?void 0:l.toString())||""),[z,$]=n.useState({});return H.jsxs("form",{onSubmit:n=>{if(n.preventDefault(),!(()=>{const e={},t=parseFloat(d);(!d||isNaN(t)||t<=0)&&(e.amount="Enter a valid amount");const n=parseInt(g);return(isNaN(n)||n<1||n>31)&&(e.dueDay="Enter a day between 1-31"),$(e),0===Object.keys(e).length})())return;const s="debt"===u?{debtType:N,aprType:k,apr:M?parseFloat(M):void 0,principalBalance:A?parseFloat(A):void 0}:{};t({...e||{},name:i.trim(),amount:parseFloat(d),frequency:m,category:u,type:f,dueDay:parseInt(g),notes:v.trim()||void 0,...s})},className:"space-y-4",children:[H.jsx(Sn,{label:"Bill Name",value:i,onChange:e=>c(e.target.value),placeholder:"Auto-named if blank",hint:i.trim()?void 0:"debt"===u?'Will be named "Debt N"':'Will be named "Bill N"'}),H.jsx(Sn,{label:"Amount",type:"number",value:d,onChange:e=>x(e.target.value),placeholder:"0.00",prefix:"$",step:"0.01",min:"0",error:z.amount}),H.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[H.jsx(Mn,{label:"Frequency",value:m,onChange:e=>h(e.target.value),options:Object.entries(yt).map(([e,t])=>({value:e,label:t}))}),H.jsx(Mn,{label:"Category",value:u,onChange:e=>p(e.target.value),options:Object.entries(gt).map(([e,t])=>({value:e,label:t}))})]}),H.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[H.jsx(Mn,{label:"Type",value:f,onChange:e=>y(e.target.value),options:Object.entries(vt).map(([e,t])=>({value:e,label:t}))}),H.jsx(Sn,{label:"Due Day",type:"number",value:g,onChange:e=>b(e.target.value),min:"1",max:"31",hint:"Day of month (1-31)",error:z.dueDay})]}),H.jsx(Sn,{label:"Notes",value:v,onChange:e=>j(e.target.value),placeholder:"Optional notes..."}),"debt"===u&&H.jsxs("div",{className:"border border-[var(--color-border)] rounded-lg p-4 space-y-4",children:[H.jsx("p",{className:"text-sm font-medium text-[var(--color-text-secondary)]",children:"Debt Details (Optional)"}),H.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[H.jsx(Mn,{label:"Debt Type",value:N,onChange:e=>w(e.target.value),options:Object.entries(jt).map(([e,t])=>({value:e,label:t}))}),H.jsx(Mn,{label:"APR Type",value:k,onChange:e=>S(e.target.value),options:Object.entries(Nt).map(([e,t])=>({value:e,label:t}))})]}),H.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[H.jsx(Sn,{label:"APR (%)",type:"number",value:M,onChange:e=>C(e.target.value),placeholder:"e.g. 19.99",step:"0.01",min:"0"}),H.jsx(Sn,{label:"Principal Balance",type:"number",value:A,onChange:e=>D(e.target.value),placeholder:"0.00",prefix:"$",step:"0.01",min:"0"})]})]}),H.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[H.jsx(kn,{type:"button",variant:"ghost",onClick:s,children:"Cancel"}),H.jsx(kn,{type:"submit",children:e?"Update Bill":"Add Bill"})]})]})}function An({open:e,onClose:t,title:s,children:a}){return n.useEffect(()=>{if(!e)return;const n=e=>{"Escape"===e.key&&t()};return document.addEventListener("keydown",n),document.body.style.overflow="hidden",()=>{document.removeEventListener("keydown",n),document.body.style.overflow=""}},[e,t]),e?H.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",role:"dialog","aria-modal":"true","aria-labelledby":"modal-title",children:[H.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:t}),H.jsxs("div",{className:"relative w-full max-w-lg rounded-2xl bg-[var(--color-bg-primary)] border border-[var(--color-border)] shadow-2xl",children:[H.jsxs("div",{className:"flex items-center justify-between p-5 border-b border-[var(--color-border)]",children:[H.jsx("h2",{id:"modal-title",className:"text-lg font-bold font-display",children:s}),H.jsx("button",{onClick:t,className:"rounded-full p-1.5 hover:bg-white/10 transition-colors","aria-label":"Close",children:H.jsx(Ie,{size:20})})]}),H.jsx("div",{className:"p-5",children:a})]})]}):null}function Dn({icon:e,title:t,description:n,action:s}){return H.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-center max-w-sm mx-auto",children:[H.jsx("div",{className:"text-[var(--color-text-muted)] mb-4",children:H.jsx(e,{size:56,strokeWidth:1})}),H.jsx("h3",{className:"text-xl font-bold mb-2",children:t}),H.jsx("p",{className:"text-sm text-[var(--color-text-secondary)] mb-6",children:n}),s]})}function zn(){const{bills:e,loading:t,loadBills:s,addBill:a,updateBill:r,deleteBill:o,togglePaid:l}=St(),[i,c]=n.useState(!1),[d,x]=n.useState(),[m,h]=n.useState(null);n.useEffect(()=>{s()},[s]);const u=e=>{x(e),c(!0)};return t?H.jsx(jn,{}):H.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[H.jsxs("div",{className:"flex items-center justify-between",children:[H.jsxs("div",{children:[H.jsx("h1",{className:"text-3xl font-bold font-display bg-gradient-to-r from-neon-pink to-neon-cyan bg-clip-text text-transparent",children:"Bills"}),H.jsxs("p",{className:"text-sm text-[var(--color-text-secondary)] mt-1",children:[e.length," bill",1!==e.length?"s":""," tracked"]})]}),H.jsxs(kn,{onClick:()=>{x(void 0),c(!0)},children:[H.jsx(Ne,{size:18}),"Add Bill"]})]}),0===e.length?H.jsx(Dn,{icon:we,title:"No bills yet",description:"Get started by adding your first bill. We'll help you track and forecast your expenses.",action:H.jsxs(kn,{onClick:()=>c(!0),children:[H.jsx(Ne,{size:18}),"Add Your First Bill"]})}):H.jsx("div",{className:"grid gap-4 sm:grid-cols-2",children:e.map(e=>H.jsx(wn,{bill:e,onEdit:u,onDelete:e=>h(e),onTogglePaid:l},e.id))}),H.jsx(An,{open:i,onClose:()=>{c(!1),x(void 0)},title:d?"Edit Bill":"Add Bill",children:H.jsx(Cn,{bill:d,onSubmit:async e=>{d?await r({...d,...e}):await a(e),c(!1),x(void 0)},onCancel:()=>{c(!1),x(void 0)}})}),H.jsxs(An,{open:!!m,onClose:()=>h(null),title:"Delete Bill?",children:[H.jsx("p",{className:"text-sm text-[var(--color-text-secondary)] mb-4",children:"Are you sure you want to delete this bill? This action cannot be undone."}),H.jsxs("div",{className:"flex justify-end gap-3",children:[H.jsx(kn,{variant:"ghost",onClick:()=>h(null),children:"Cancel"}),H.jsx(kn,{variant:"danger",onClick:()=>m&&(async e=>{await o(e),h(null)})(m),children:"Delete"})]})]})]})}function $n(){const{incomes:e,loading:t,loadIncomes:s,addIncome:a,updateIncome:r,deleteIncome:o}=At(),[l,i]=n.useState(!1),[c,d]=n.useState(),[x,m]=n.useState(""),[h,u]=n.useState(""),[p,f]=n.useState("monthly");n.useEffect(()=>{s()},[s]);const y=()=>{m(""),u(""),f("monthly"),d(void 0)},g=Pt(e);return t?H.jsx(jn,{}):H.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[H.jsxs("div",{className:"flex items-center justify-between",children:[H.jsxs("div",{children:[H.jsx("h1",{className:"text-3xl font-bold font-display bg-gradient-to-r from-neon-pink to-neon-cyan bg-clip-text text-transparent",children:"Income"}),H.jsxs("p",{className:"text-sm text-[var(--color-text-secondary)] mt-1",children:["Total monthly: ",H.jsx("span",{className:"font-mono text-neon-green",children:Ut(g)})]})]}),H.jsxs(kn,{onClick:()=>{y(),i(!0)},children:[H.jsx(Ne,{size:18}),"Add Income"]})]}),0===e.length?H.jsx(Dn,{icon:de,title:"No income set",description:"Add your income sources to see cash flow forecasts and spending analysis.",action:H.jsxs(kn,{onClick:()=>i(!0),children:[H.jsx(Ne,{size:18}),"Add Income"]})}):H.jsx("div",{className:"grid gap-4 sm:grid-cols-2",children:e.map(e=>H.jsx(Kt,{hover:!0,children:H.jsxs("div",{className:"flex items-start justify-between",children:[H.jsxs("div",{children:[H.jsx("h4",{className:"font-semibold",children:e.name}),H.jsx("p",{className:"text-xl font-mono font-bold text-neon-green mt-1",children:Ut(e.amount)}),H.jsxs("p",{className:"text-xs text-[var(--color-text-muted)]",children:[Mt[e.payPeriod]," ·"," ",Ut(Ft(e)),"/mo"]})]}),H.jsxs("div",{className:"flex gap-1",children:[H.jsx("button",{onClick:()=>(e=>{d(e),m(e.name),u(e.amount.toString()),f(e.payPeriod),i(!0)})(e),className:"p-1.5 rounded-lg hover:bg-white/10 text-[var(--color-text-muted)] transition-colors","aria-label":"Edit income",children:H.jsx(ve,{size:16})}),H.jsx("button",{onClick:()=>o(e.id),className:"p-1.5 rounded-lg hover:bg-red-500/10 text-[var(--color-text-muted)] hover:text-red-400 transition-colors","aria-label":"Delete income",children:H.jsx(Ae,{size:16})})]})]})},e.id))}),H.jsx(An,{open:l,onClose:()=>{i(!1),y()},title:c?"Edit Income":"Add Income",children:H.jsxs("form",{onSubmit:async e=>{e.preventDefault();const t=parseFloat(h);!x.trim()||isNaN(t)||t<=0||(c?await r({...c,name:x.trim(),amount:t,payPeriod:p}):await a({name:x.trim(),amount:t,payPeriod:p}),y(),i(!1))},className:"space-y-4",children:[H.jsx(Sn,{label:"Source Name",value:x,onChange:e=>m(e.target.value),placeholder:"e.g., Primary Job"}),H.jsx(Sn,{label:"Amount",type:"number",value:h,onChange:e=>u(e.target.value),placeholder:"0.00",prefix:"$",step:"0.01",min:"0"}),H.jsx(Mn,{label:"Pay Period",value:p,onChange:e=>f(e.target.value),options:Object.entries(Mt).map(([e,t])=>({value:e,label:t}))}),H.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[H.jsx(kn,{type:"button",variant:"ghost",onClick:()=>{i(!1),y()},children:"Cancel"}),H.jsx(kn,{type:"submit",children:c?"Update":"Add Income"})]})]})})]})}const Fn=[{id:"cut-subs-50",label:"Cut subscriptions 50%",description:"What if you halved all subscription costs?",apply:e=>e.map(e=>"subscriptions"===e.category?{...e,amount:.5*e.amount}:e)},{id:"cut-lifestyle-30",label:"Cut lifestyle 30%",description:"What if you reduced lifestyle spending by 30%?",apply:e=>e.map(e=>"lifestyle"===e.category?{...e,amount:.7*e.amount}:e)},{id:"lose-10pct",label:"Income drops 10%",description:"What if your income decreased by 10%?",apply:e=>e},{id:"cut-all-10",label:"Cut everything 10%",description:"What if you negotiated 10% off all bills?",apply:e=>e.map(e=>({...e,amount:.9*e.amount}))}];function In(){var e,t;const{bills:s,loading:a,loadBills:r}=St(),{incomes:o,loading:l,loadIncomes:i}=At(),[c,d]=n.useState(6),[m,h]=n.useState(null);n.useEffect(()=>{r(),i()},[r,i]);const u=Fn.find(e=>e.id===m),p=u?u.apply(s):s,f="lose-10pct"===m?o.map(e=>({...e,amount:.9*e.amount})):o,y=n.useMemo(()=>Bt(p,f,new Date,c),[p,f,c]),g=n.useMemo(()=>Bt(s,o,new Date,c),[s,o,c]),b=n.useMemo(()=>Pt(f),[f]),v=n.useMemo(()=>It(p),[p]),j=n.useMemo(()=>qt(p,f),[p,f]),N=n.useMemo(()=>function(e,t,n){const s=e-t;if(s>=0)return null;const a=n/Math.abs(s);return Math.floor(30*a)}(b,v,b),[b,v]);return a||l?H.jsx(jn,{}):0===s.length&&0===o.length?H.jsx("div",{className:"max-w-4xl mx-auto",children:H.jsx(Dn,{icon:ze,title:"No data to forecast",description:"Add bills and income sources to see your cash flow forecast."})}):H.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[H.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-3",children:[H.jsxs("div",{children:[H.jsx("h1",{className:"text-3xl font-bold font-display bg-gradient-to-r from-neon-pink to-neon-cyan bg-clip-text text-transparent",children:"Forecast"}),H.jsxs("p",{className:"text-sm text-[var(--color-text-secondary)] mt-1",children:[c,"-month cash flow projection",m&&H.jsx("span",{className:"text-neon-yellow ml-2",children:"(What-If active)"})]})]}),H.jsx("div",{className:"flex gap-2",children:[3,6,12].map(e=>H.jsxs(kn,{size:"sm",variant:c===e?"primary":"ghost",onClick:()=>d(e),children:[e,"mo"]},e))})]}),H.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[H.jsxs(Kt,{children:[H.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[H.jsx(J,{size:16,className:"text-neon-green"}),H.jsx("span",{className:"text-xs text-[var(--color-text-muted)]",children:"Monthly Income"})]}),H.jsx("p",{className:"text-xl font-mono font-bold text-neon-green",children:Ut(b)}),H.jsx(pn,{values:y.map(e=>e.totalIncome),color:"#39ff14"})]}),H.jsxs(Kt,{children:[H.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[H.jsx(Z,{size:16,className:"text-neon-pink"}),H.jsx("span",{className:"text-xs text-[var(--color-text-muted)]",children:"Monthly Expenses"})]}),H.jsx("p",{className:"text-xl font-mono font-bold text-neon-pink",children:Ut(v)}),H.jsx(pn,{values:y.map(e=>e.totalExpenses),color:"#ff0080"})]}),H.jsxs(Kt,{children:[H.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[null!==N?H.jsx(X,{size:16,className:"text-neon-yellow"}):H.jsx(le,{size:16,className:"text-neon-cyan"}),H.jsx("span",{className:"text-xs text-[var(--color-text-muted)]",children:"Runway"})]}),H.jsx("p",{className:"text-xl font-mono font-bold",children:null!==N?H.jsxs("span",{className:"text-neon-yellow",children:[N," days"]}):H.jsx("span",{className:"text-neon-green",children:"Sustainable"})})]}),H.jsxs(Kt,{children:[H.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[H.jsx(Me,{size:16,className:"text-neon-purple"}),H.jsx("span",{className:"text-xs text-[var(--color-text-muted)]",children:"Health Grade"})]}),H.jsxs("p",{className:x("text-xl font-mono font-bold",j.overall>=70?"text-neon-green":j.overall>=45?"text-neon-yellow":"text-red-400"),children:[j.grade," (",j.overall,"/100)"]})]})]}),H.jsxs(Kt,{children:[H.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[H.jsx(Pe,{size:18,className:"text-neon-yellow"}),H.jsx("h3",{className:"text-sm font-bold font-display",children:"What-If Scenarios"})]}),H.jsxs("div",{className:"flex flex-wrap gap-2",children:[Fn.map(e=>H.jsx("button",{onClick:()=>h(m===e.id?null:e.id),className:x("px-3 py-1.5 rounded-lg text-xs font-medium border transition-all",m===e.id?"border-neon-yellow text-neon-yellow bg-neon-yellow/10":"border-[var(--color-border)] text-[var(--color-text-secondary)] hover:border-neon-yellow/50"),title:e.description,children:e.label},e.id)),m&&H.jsx("button",{onClick:()=>h(null),className:"px-3 py-1.5 rounded-lg text-xs text-[var(--color-text-muted)] hover:text-[var(--color-text-primary)]",children:"Reset"})]}),u&&H.jsx("p",{className:"text-xs text-neon-yellow/70 mt-2",children:u.description})]}),H.jsx(Zt,{bills:p,incomes:f,months:c}),H.jsxs(Kt,{children:[H.jsx("h3",{className:"text-lg font-bold font-display mb-4",children:"Monthly Breakdown"}),H.jsx("div",{className:"overflow-x-auto",children:H.jsxs("table",{className:"w-full text-sm",children:[H.jsx("thead",{children:H.jsxs("tr",{className:"text-left text-[var(--color-text-muted)] border-b border-[var(--color-border)]",children:[H.jsx("th",{className:"pb-2 font-medium",children:"Risk"}),H.jsx("th",{className:"pb-2 font-medium",children:"Month"}),H.jsx("th",{className:"pb-2 font-medium text-right",children:"Income"}),H.jsx("th",{className:"pb-2 font-medium text-right",children:"Expenses"}),H.jsx("th",{className:"pb-2 font-medium text-right",children:"Net"}),H.jsx("th",{className:"pb-2 font-medium text-right",children:"Balance"}),m&&H.jsx("th",{className:"pb-2 font-medium text-right",children:"vs Base"})]})}),H.jsx("tbody",{children:y.map((e,t)=>{const n=e.netCashFlow>=.2*e.totalIncome?"bg-neon-green":e.netCashFlow>=0?"bg-neon-yellow":"bg-red-500",s=m&&g[t]?e.runningBalance-g[t].runningBalance:null;return H.jsxs("tr",{className:"border-b border-[var(--color-border)]/50",children:[H.jsx("td",{className:"py-2.5",children:H.jsx("div",{className:`w-2.5 h-2.5 rounded-full ${n}`,title:e.netCashFlow>=.2*e.totalIncome?"Low risk":e.netCashFlow>=0?"Moderate risk":"High risk"})}),H.jsx("td",{className:"py-2.5 font-mono",children:e.label}),H.jsx("td",{className:"py-2.5 text-right font-mono text-neon-green",children:Ut(e.totalIncome)}),H.jsx("td",{className:"py-2.5 text-right font-mono text-neon-pink",children:Ut(e.totalExpenses)}),H.jsxs("td",{className:"py-2.5 text-right font-mono "+(e.netCashFlow>=0?"text-neon-green":"text-red-400"),children:[e.netCashFlow>=0?"+":"",Ut(e.netCashFlow)]}),H.jsx("td",{className:"py-2.5 text-right font-mono "+(e.runningBalance>=0?"text-neon-cyan":"text-red-400"),children:Ut(e.runningBalance)}),m&&H.jsx("td",{className:"py-2.5 text-right font-mono text-xs "+(null!==s&&s>=0?"text-neon-green":"text-red-400"),children:null!==s?`${s>=0?"+":""}${Ut(s)}`:"-"})]},t)})})]})}),H.jsxs("div",{className:"flex items-center gap-4 mt-3 text-xs text-[var(--color-text-muted)]",children:[H.jsxs("div",{className:"flex items-center gap-1.5",children:[H.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-neon-green"}),"Low risk"]}),H.jsxs("div",{className:"flex items-center gap-1.5",children:[H.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-neon-yellow"}),"Moderate"]}),H.jsxs("div",{className:"flex items-center gap-1.5",children:[H.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-red-500"}),"High risk"]})]})]}),H.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[H.jsxs(Kt,{children:[H.jsxs("h3",{className:"text-lg font-bold font-display mb-4",children:["Financial Health",m&&H.jsx("span",{className:"text-xs text-neon-yellow ml-2",children:"(Scenario)"})]}),H.jsx(rn,{score:j})]}),H.jsxs(Kt,{children:[H.jsx("h3",{className:"text-lg font-bold font-display mb-4",children:"Balance Projection"}),H.jsx(pn,{values:y.map(e=>e.runningBalance),width:300,height:120}),H.jsxs("div",{className:"mt-4 grid grid-cols-2 gap-3",children:[H.jsxs("div",{children:[H.jsx("p",{className:"text-xs text-[var(--color-text-muted)]",children:"End of Period"}),H.jsx("p",{className:x("text-lg font-mono font-bold",(null==(e=y[y.length-1])?void 0:e.runningBalance)>=0?"text-neon-cyan":"text-red-400"),children:Ut((null==(t=y[y.length-1])?void 0:t.runningBalance)||0)})]}),H.jsxs("div",{children:[H.jsx("p",{className:"text-xs text-[var(--color-text-muted)]",children:"Avg Monthly Net"}),H.jsx("p",{className:"text-lg font-mono font-bold text-neon-cyan",children:Ut(y.reduce((e,t)=>e+t.netCashFlow,0)/(y.length||1))})]})]})]})]})]})}const Pn=[{id:"y2k",name:"Y2K Cyberpunk",desc:"Bold neon aesthetic",preview:"from-[#ff0080] to-[#00fff9]"},{id:"neutral",name:"Neutral",desc:"Clean & professional",preview:"from-blue-500 to-emerald-500"},{id:"high-contrast",name:"High Contrast",desc:"Maximum readability",preview:"from-yellow-300 to-cyan-300"},{id:"dark-minimal",name:"Dark Minimal",desc:"Sleek & understated",preview:"from-indigo-500 to-violet-400"},{id:"sunset",name:"Sunset",desc:"Warm amber & gold",preview:"from-[#ff6b35] to-[#ffd700]"},{id:"ocean",name:"Ocean Depths",desc:"Electric blue & mint",preview:"from-[#00d4ff] to-[#00ffaa]"},{id:"forest",name:"Forest",desc:"Deep greens & lime",preview:"from-[#39ff14] to-[#80ffb4]"},{id:"dracula",name:"Dracula",desc:"Classic dev palette",preview:"from-[#ff79c6] to-[#bd93f9]"},{id:"matrix",name:"Matrix",desc:"Terminal phosphor green",preview:"from-[#00ff41] to-[#007a1f]"},{id:"rose-gold",name:"Rose Gold",desc:"Luxurious rose & gold",preview:"from-[#ff7eb3] to-[#ffd700]"}];function En(){const{theme:e,setTheme:t}=mt(),{loadBills:s}=St(),{loadIncomes:a}=At(),[r,o]=n.useState(!1),[l,i]=n.useState(!1),c=n.useRef(null),{apiKey:d,enabled:m,setApiKey:h,setEnabled:u}=bn(),p=e=>{const t=null==e?"":String(e);return t.includes(",")||t.includes('"')||t.includes("\n")?`"${t.replace(/"/g,'""')}"`:t},f=e=>e.map(p).join(","),y=(e,t)=>{const n=new Blob([e],{type:"text/csv"}),s=URL.createObjectURL(n),a=document.createElement("a");a.href=s,a.download=t,a.click(),URL.revokeObjectURL(s)},g=e=>{const t=[];let n="",s=!1;for(let a=0;a<e.length;a++){const r=e[a];s?'"'===r?'"'===e[a+1]?(n+='"',a++):s=!1:n+=r:'"'===r?s=!0:","===r?(t.push(n),n=""):n+=r}return t.push(n),t},b=["weekly","biweekly","monthly","quarterly","yearly"],v=["housing","utilities","transportation","insurance","debt","subscriptions","lifestyle","savings","other"],j=["ongoing","contract","installment","one-time"],N=["weekly","biweekly","semi-monthly","monthly","annually"],w=["credit-card","student-loan","personal-loan","auto-loan","other"],k=["fixed","variable"];return H.jsxs("div",{className:"max-w-3xl mx-auto space-y-6",children:[H.jsx("h1",{className:"text-3xl font-bold font-display bg-gradient-to-r from-neon-pink to-neon-cyan bg-clip-text text-transparent",children:"Settings"}),H.jsxs(Kt,{children:[H.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[H.jsx(ye,{size:20,className:"text-neon-purple"}),H.jsx("h2",{className:"text-lg font-bold",children:"Theme"})]}),H.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3",children:Pn.map(n=>H.jsxs("button",{onClick:()=>t(n.id),className:x("p-3 rounded-lg border-2 text-left transition-all",e===n.id?"border-[var(--color-accent)] bg-[var(--color-accent)]/10":"border-[var(--color-border)] hover:border-[var(--color-text-muted)]"),children:[H.jsx("div",{className:`h-2 w-12 rounded-full bg-gradient-to-r ${n.preview} mb-2`}),H.jsx("p",{className:"text-sm font-semibold text-[var(--color-text-primary)]",children:n.name}),H.jsx("p",{className:"text-xs text-[var(--color-text-muted)]",children:n.desc})]},n.id))})]}),H.jsxs(Kt,{children:[H.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[H.jsx(Q,{size:20,className:"text-neon-purple"}),H.jsx("h2",{className:"text-lg font-bold",children:"FinVis AI"}),H.jsx("span",{className:"text-[10px] bg-neon-purple/20 text-neon-purple px-1.5 py-0.5 rounded-full",children:"Optional"})]}),H.jsxs("div",{className:"space-y-4",children:[H.jsxs("div",{className:"flex items-center justify-between",children:[H.jsxs("div",{children:[H.jsx("p",{className:"text-sm font-medium",children:"Enable AI Insights"}),H.jsx("p",{className:"text-xs text-[var(--color-text-muted)]",children:"Chat with Claude about your finances"})]}),H.jsx("button",{onClick:()=>u(!m),className:x("relative w-11 h-6 rounded-full transition-colors",m?"bg-neon-purple":"bg-white/10"),children:H.jsx("div",{className:x("absolute top-0.5 w-5 h-5 rounded-full bg-white transition-transform",m?"translate-x-[22px]":"translate-x-0.5")})})]}),m&&H.jsxs(H.Fragment,{children:[H.jsx("div",{className:"border-t border-[var(--color-border)]"}),H.jsxs("div",{children:[H.jsx("label",{className:"block text-sm font-medium mb-1.5",children:"Claude API Key"}),H.jsx("div",{className:"flex gap-2",children:H.jsxs("div",{className:"relative flex-1",children:[H.jsx("input",{type:l?"text":"password",value:d,onChange:e=>h(e.target.value),placeholder:"sk-ant-...",className:"w-full bg-[var(--color-bg-primary)] border border-[var(--color-border)] rounded-lg px-3 py-2 text-sm font-mono focus:outline-none focus:border-neon-purple pr-10"}),H.jsx("button",{type:"button",onClick:()=>i(!l),className:"absolute right-2 top-1/2 -translate-y-1/2 text-[var(--color-text-muted)] hover:text-[var(--color-text-primary)]",children:l?H.jsx(me,{size:16}):H.jsx(he,{size:16})})]})}),H.jsxs("p",{className:"text-xs text-[var(--color-text-muted)] mt-1.5",children:["Get your key from"," ",H.jsx("a",{href:"https://console.anthropic.com/settings/keys",target:"_blank",rel:"noopener noreferrer",className:"text-neon-purple hover:underline",children:"console.anthropic.com"})]})]}),H.jsx("div",{className:"border-t border-[var(--color-border)]"}),H.jsxs("div",{className:"rounded-lg bg-neon-purple/5 border border-neon-purple/20 p-3",children:[H.jsx("p",{className:"text-xs font-semibold text-neon-purple mb-1",children:"Privacy Notice"}),H.jsxs("ul",{className:"text-xs text-[var(--color-text-secondary)] space-y-1 list-disc list-inside",children:[H.jsx("li",{children:"Your API key is stored locally in your browser only"}),H.jsx("li",{children:"Only aggregated summaries (totals, ratios, categories) are sent — never raw transaction details"}),H.jsx("li",{children:"Conversations are not stored on any server"}),H.jsx("li",{children:"You can disable AI at any time and all chat history is cleared"})]})]})]})]})]}),H.jsxs(Kt,{children:[H.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[H.jsx(ce,{size:20,className:"text-neon-cyan"}),H.jsx("h2",{className:"text-lg font-bold",children:"Data Management"})]}),H.jsxs("div",{className:"space-y-3",children:[H.jsxs("div",{className:"flex items-center justify-between",children:[H.jsxs("div",{children:[H.jsx("p",{className:"text-sm font-medium",children:"Export Data"}),H.jsx("p",{className:"text-xs text-[var(--color-text-muted)]",children:"Download bills, debts, and incomes as CSV files"})]}),H.jsxs(kn,{size:"sm",variant:"secondary",onClick:async()=>{const e=(new Date).toISOString().split("T")[0],t=await kt.getAll(),n=await Ct.getAll();if(t.length>0){const n=[f(["id","name","amount","frequency","category","dueDay","type","contractEndDate","paymentsRemaining","isPaid","notes","debtType","aprType","apr","principalBalance","createdAt","updatedAt"]),...t.map(e=>f([e.id,e.name,e.amount,e.frequency,e.category,e.dueDay,e.type,e.contractEndDate??"",e.paymentsRemaining??"",e.isPaid,e.notes??"",e.debtType??"",e.aprType??"",e.apr??"",e.principalBalance??"",e.createdAt,e.updatedAt]))];y(n.join("\n"),`finvis-bills-${e}.csv`)}if(n.length>0){const t=[f(["id","name","amount","payPeriod","createdAt","updatedAt"]),...n.map(e=>f([e.id,e.name,e.amount,e.payPeriod,e.createdAt,e.updatedAt]))];y(t.join("\n"),`finvis-incomes-${e}.csv`)}},children:[H.jsx(xe,{size:16}),"Export"]})]}),H.jsx("div",{className:"border-t border-[var(--color-border)]"}),H.jsxs("div",{className:"flex items-center justify-between",children:[H.jsxs("div",{children:[H.jsx("p",{className:"text-sm font-medium",children:"Import Data"}),H.jsx("p",{className:"text-xs text-[var(--color-text-muted)]",children:"Import a bills, debts, or incomes CSV file"})]}),H.jsxs("div",{children:[H.jsx("input",{ref:c,type:"file",accept:".csv",onChange:async e=>{var t,n,r;const o=null==(t=e.target.files)?void 0:t[0];if(o){try{const e=(e=>{const t=e.trim().split("\n");if(t.length<2)return[];const n=g(t[0]);return t.slice(1).map(e=>{const t=g(e);return Object.fromEntries(n.map((e,n)=>[e,t[n]??""]))})})(await o.text());if(0===e.length)throw new Error("Empty file");const t=Object.keys(e[0]),l=(new Date).toISOString();if(t.includes("payPeriod")){let t=(await Ct.getAll()).length;for(const s of e){const e=parseFloat(s.amount);if(isNaN(e))continue;t++;const a=`Income ${t}`;await Ct.save({id:s.id||crypto.randomUUID(),name:(null==(n=s.name)?void 0:n.trim())||a,amount:e,payPeriod:N.includes(s.payPeriod)?s.payPeriod:"monthly",createdAt:s.createdAt||l,updatedAt:s.updatedAt||l})}await a()}else{if(!t.includes("frequency")&&!t.includes("category"))throw new Error("Unrecognized CSV format");{const t=await kt.getAll();let n=t.filter(e=>"debt"!==e.category).length,a=t.filter(e=>"debt"===e.category).length;for(const s of e){const e=parseFloat(s.amount);if(isNaN(e))continue;const t=v.includes(s.category)?s.category:"other",o="debt"===t;o?a++:n++;const i=o?`Debt ${a}`:`Bill ${n}`,c=s.apr?parseFloat(s.apr):void 0,d=s.principalBalance?parseFloat(s.principalBalance):void 0;await kt.save({id:s.id||crypto.randomUUID(),name:(null==(r=s.name)?void 0:r.trim())||i,amount:e,frequency:b.includes(s.frequency)?s.frequency:"monthly",category:t,dueDay:parseInt(s.dueDay,10)||1,type:j.includes(s.type)?s.type:"ongoing",contractEndDate:s.contractEndDate||void 0,paymentsRemaining:s.paymentsRemaining?parseInt(s.paymentsRemaining,10):void 0,isPaid:"true"===s.isPaid,notes:s.notes||void 0,debtType:w.includes(s.debtType)?s.debtType:void 0,aprType:k.includes(s.aprType)?s.aprType:void 0,apr:!isNaN(c)&&c>=0?c:void 0,principalBalance:!isNaN(d)&&d>=0?d:void 0,createdAt:s.createdAt||l,updatedAt:s.updatedAt||l})}await s()}}}catch{alert("Invalid CSV file. Import a bills, debts, or incomes CSV exported from FinVis.")}c.current&&(c.current.value="")}},className:"hidden"}),H.jsxs(kn,{size:"sm",variant:"secondary",onClick:()=>{var e;return null==(e=c.current)?void 0:e.click()},children:[H.jsx($e,{size:16}),"Import"]})]})]}),H.jsx("div",{className:"border-t border-[var(--color-border)]"}),H.jsxs("div",{className:"flex items-center justify-between",children:[H.jsxs("div",{children:[H.jsx("p",{className:"text-sm font-medium text-red-400",children:"Clear All Data"}),H.jsx("p",{className:"text-xs text-[var(--color-text-muted)]",children:"Permanently delete everything"})]}),r?H.jsxs("div",{className:"flex gap-2",children:[H.jsx(kn,{size:"sm",variant:"ghost",onClick:()=>o(!1),children:"Cancel"}),H.jsx(kn,{size:"sm",variant:"danger",onClick:async()=>{await kt.deleteAll(),await Ct.deleteAll(),await s(),await a(),o(!1)},children:"Confirm"})]}):H.jsxs(kn,{size:"sm",variant:"danger",onClick:()=>o(!0),children:[H.jsx(Ae,{size:16}),"Clear"]})]})]})]}),H.jsxs(Kt,{children:[H.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[H.jsx(Me,{size:20,className:"text-neon-green"}),H.jsx("h2",{className:"text-lg font-bold",children:"Privacy"})]}),H.jsxs("div",{className:"space-y-2 text-sm text-[var(--color-text-secondary)]",children:[H.jsx("p",{children:"FinVis is 100% privacy-first:"}),H.jsxs("ul",{className:"list-disc list-inside space-y-1 text-xs",children:[H.jsx("li",{children:"All data stored locally on your device (IndexedDB)"}),H.jsx("li",{children:"No data is ever sent to any server (unless AI is enabled)"}),H.jsx("li",{children:"No analytics or tracking of any kind"}),H.jsx("li",{children:"Works completely offline"}),H.jsx("li",{children:"Open source and auditable"}),m&&H.jsx("li",{className:"text-neon-purple",children:"AI mode: only aggregated summaries are sent to the Claude API"})]})]})]}),H.jsx(Kt,{children:H.jsx("p",{className:"text-xs text-center text-[var(--color-text-muted)]",children:"FinVis v2.0.0 · Privacy-First Finance Visualizer · MIT License"})})]})}function Bn(e){const t=[];let n="",s=!1;for(let a=0;a<e.length;a++){const r=e[a];s?'"'===r?'"'===e[a+1]?(n+='"',a++):s=!1:n+=r:'"'===r?s=!0:","===r?(t.push(n),n=""):n+=r}return t.push(n),t}function On(){const[e,t]=n.useState(!1),[s,a]=n.useState(!1),{loadBills:r}=St();n.useEffect(()=>{kt.count().then(e=>{0===e&&t(!0)})},[]);return e?H.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[H.jsx("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm"}),H.jsxs("div",{className:"relative w-full max-w-md rounded-2xl bg-[var(--color-bg-primary)] border border-[var(--color-border)] shadow-2xl overflow-hidden",children:[H.jsx("div",{className:"h-1 w-full bg-gradient-to-r from-neon-pink via-neon-purple to-neon-cyan"}),H.jsxs("div",{className:"p-8 text-center",children:[H.jsx("h1",{className:"text-3xl font-bold font-display bg-gradient-to-r from-neon-pink to-neon-cyan bg-clip-text text-transparent mb-2",children:"Welcome to FinVis"}),H.jsx("p",{className:"text-sm text-[var(--color-text-muted)] mb-8",children:"Your privacy-first finance visualizer. How would you like to get started?"}),H.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[H.jsxs("button",{onClick:async()=>{a(!0);try{const e=await fetch("/n/finvis/sample_bills.csv"),n=function(e){const t=e.trim().split("\n");if(t.length<2)return[];const n=Bn(t[0]);return t.slice(1).filter(e=>e.trim()).map(e=>{const t=Bn(e);return Object.fromEntries(n.map((e,n)=>[e,t[n]??""]))})}(await e.text()),s=(new Date).toISOString();for(const t of n)await kt.save({id:t.id,name:t.name,amount:parseFloat(t.amount),frequency:t.frequency,category:t.category,dueDay:parseInt(t.dueDay,10)||1,type:t.type,isPaid:"true"===t.isPaid,notes:t.notes||void 0,contractEndDate:t.contractEndDate||void 0,paymentsRemaining:t.paymentsRemaining?parseInt(t.paymentsRemaining,10):void 0,createdAt:t.createdAt||s,updatedAt:t.updatedAt||s});await r(),t(!1)}catch{a(!1)}},disabled:s,className:"group flex flex-col items-center gap-3 p-5 rounded-xl border-2 border-neon-purple/40 hover:border-neon-purple bg-neon-purple/5 hover:bg-neon-purple/10 transition-all disabled:opacity-50 disabled:cursor-not-allowed text-left",children:[H.jsx(Ce,{size:28,className:"text-neon-purple group-hover:scale-110 transition-transform"}),H.jsxs("div",{children:[H.jsx("p",{className:"font-semibold text-sm",children:"Load Sample Data"}),H.jsx("p",{className:"text-xs text-[var(--color-text-muted)] mt-1 leading-relaxed",children:"Explore with 40 realistic bills across all categories"})]})]}),H.jsxs("button",{onClick:()=>t(!1),disabled:s,className:"group flex flex-col items-center gap-3 p-5 rounded-xl border-2 border-[var(--color-border)] hover:border-neon-cyan bg-transparent hover:bg-neon-cyan/5 transition-all disabled:opacity-50 disabled:cursor-not-allowed text-left",children:[H.jsx(ge,{size:28,className:"text-neon-cyan group-hover:scale-110 transition-transform"}),H.jsxs("div",{children:[H.jsx("p",{className:"font-semibold text-sm",children:"Start Fresh"}),H.jsx("p",{className:"text-xs text-[var(--color-text-muted)] mt-1 leading-relaxed",children:"Add your own bills and income from scratch"})]})]})]}),s&&H.jsx("p",{className:"text-xs text-neon-purple mt-5 animate-pulse",children:"Loading sample data..."})]})]})]}):null}const Rn=["#ff6b35","#b026ff","#00fff9","#ffff00","#39ff14","#ff0080"];function Tn(e){const t=new Date;return t.setMonth(t.getMonth()+e),t.toLocaleDateString("en-US",{month:"short",year:"numeric"})}function Ln(e){const t=function(e){const t=e.principalBalance??0,n=e.amount,s=e.apr??0;if(t<=0||n<=0)return[];const a=s/100/12,r=[];let o=t,l=0;for(;o>.005&&l<600;){l++;const e=a>0?o*a:0,t=Math.min(n-e,o);if(t<=0){if(r.push({month:l,label:Tn(l),payment:n,principal:0,interest:e,balance:o}),l>=600)break;continue}const s=t+e;o=Math.max(0,o-t),r.push({month:l,label:Tn(l),payment:Math.round(100*s)/100,principal:Math.round(100*t)/100,interest:Math.round(100*e)/100,balance:Math.round(100*o)/100})}return r}(e),n=t.reduce((e,t)=>e+t.payment,0),s=t.reduce((e,t)=>e+t.interest,0),a=t.length;return{bill:e,monthlyPayment:e.amount,payoffMonths:a,totalPaid:Math.round(100*n)/100,totalInterest:Math.round(100*s)/100,schedule:t}}function qn({label:e,value:t,color:n}){return H.jsxs("div",{className:"rounded-lg border p-4 space-y-1",style:{borderColor:`${n}33`,backgroundColor:`${n}08`},children:[H.jsx("p",{className:"text-xs text-[var(--color-text-muted)] font-mono uppercase tracking-wider",children:e}),H.jsx("p",{className:"text-2xl font-bold font-mono",style:{color:n},children:t})]})}function Wn({portfolio:e}){return H.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[H.jsx(qn,{label:"Total Owed",value:Ut(e.totalBalance),color:"#ff6b35"}),H.jsx(qn,{label:"Monthly Payments",value:Ut(e.totalMonthlyPayment),color:"#00fff9"}),H.jsx(qn,{label:"Total Interest",value:Ut(e.totalInterest),color:"#ffff00"}),H.jsx(qn,{label:"Weighted APR",value:`${e.weightedApr.toFixed(2)}%`,color:"#b026ff"})]})}function Vn({schedule:e}){const[t,s]=n.useState(!1);if(0===e.length)return H.jsx("p",{className:"text-xs text-[var(--color-text-muted)] py-4 text-center font-mono",children:"Enter balance and monthly payment to see amortization schedule"});const a=t?e:e.slice(0,12),r=e.reduce((e,t)=>e+t.principal,0),o=e.reduce((e,t)=>e+t.interest,0),l=e.reduce((e,t)=>e+t.payment,0);return H.jsxs("div",{className:"space-y-2",children:[H.jsx("div",{className:"max-h-64 overflow-y-auto rounded border border-[var(--color-border)]",children:H.jsxs("table",{className:"w-full text-xs font-mono",children:[H.jsx("thead",{className:"sticky top-0 bg-[var(--color-bg-secondary)]",children:H.jsxs("tr",{className:"border-b border-[var(--color-border)]",children:[H.jsx("th",{className:"text-left px-2 py-1.5 text-[var(--color-text-muted)]",children:"Month"}),H.jsx("th",{className:"text-right px-2 py-1.5 text-[var(--color-text-muted)]",children:"Payment"}),H.jsx("th",{className:"text-right px-2 py-1.5 text-cyan-400",children:"Principal"}),H.jsx("th",{className:"text-right px-2 py-1.5 text-pink-400",children:"Interest"}),H.jsx("th",{className:"text-right px-2 py-1.5 text-[var(--color-text-muted)]",children:"Balance"})]})}),H.jsx("tbody",{children:a.map((e,t)=>H.jsxs("tr",{className:t%2==0?"bg-white/5":"",children:[H.jsx("td",{className:"px-2 py-1 text-[var(--color-text-secondary)]",children:e.label}),H.jsx("td",{className:"px-2 py-1 text-right text-[var(--color-text-primary)]",children:Ut(e.payment)}),H.jsx("td",{className:"px-2 py-1 text-right text-cyan-400",children:Ut(e.principal)}),H.jsx("td",{className:"px-2 py-1 text-right text-pink-400",children:Ut(e.interest)}),H.jsx("td",{className:"px-2 py-1 text-right text-[var(--color-text-secondary)]",children:Ut(e.balance)})]},e.month))}),H.jsx("tfoot",{className:"border-t border-[var(--color-border)] bg-[var(--color-bg-secondary)]",children:H.jsxs("tr",{children:[H.jsx("td",{className:"px-2 py-1.5 text-[var(--color-text-muted)] font-bold",children:"Total"}),H.jsx("td",{className:"px-2 py-1.5 text-right font-bold text-[var(--color-text-primary)]",children:Ut(l)}),H.jsx("td",{className:"px-2 py-1.5 text-right font-bold text-cyan-400",children:Ut(r)}),H.jsx("td",{className:"px-2 py-1.5 text-right font-bold text-pink-400",children:Ut(o)}),H.jsx("td",{className:"px-2 py-1.5 text-right text-[var(--color-text-muted)]",children:"—"})]})})]})}),e.length>12&&H.jsx("button",{onClick:()=>s(!t),className:"text-xs text-[var(--color-text-muted)] hover:text-[var(--color-text-primary)] underline transition-colors",children:t?"Show first 12 months":`Show all ${e.length} months`})]})}function Hn(e){if(e<=0)return"No payoff data";if(e>=600)return"Payment too low to pay off";const t=new Date;t.setMonth(t.getMonth()+e);const n=t.toLocaleDateString("en-US",{month:"short",year:"numeric"}),s=Math.floor(e/12),a=e%12,r=[];return s>0&&r.push(`${s}y`),a>0&&r.push(`${a}mo`),`~${r.join(" ")} · ${n}`}function Un({bill:e,summary:t,isExpanded:n,onToggleExpand:s,onEdit:a,onDelete:r,onTogglePaid:o}){const l=(e.principalBalance??0)>0,i=e.debtType?jt[e.debtType]:null;return H.jsxs("div",{className:"rounded-lg border border-[var(--color-border)] bg-[var(--color-bg-secondary)] overflow-hidden",children:[H.jsxs("div",{className:"p-4 space-y-3",children:[H.jsxs("div",{className:"flex items-start justify-between gap-2",children:[H.jsxs("div",{className:"space-y-1 min-w-0",children:[H.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[H.jsx("h3",{className:"font-bold text-[var(--color-text-primary)] truncate",children:e.name}),i&&H.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full font-mono",style:{backgroundColor:"#ff6b3520",color:"#ff6b35",border:"1px solid #ff6b3540"},children:i}),e.isPaid&&H.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-green-500/20 text-green-400 border border-green-500/40",children:"Paid"})]}),l&&H.jsx("p",{className:"text-2xl font-bold font-mono",style:{color:"#ff6b35"},children:Ut(e.principalBalance)})]}),H.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[H.jsx(kn,{size:"sm",variant:"ghost",onClick:()=>a(e),"aria-label":"Edit",children:H.jsx(be,{size:14})}),H.jsx(kn,{size:"sm",variant:"ghost",onClick:()=>r(e.id),"aria-label":"Delete",children:H.jsx(Ae,{size:14})})]})]}),H.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[H.jsxs("div",{children:[H.jsx("p",{className:"text-xs text-[var(--color-text-muted)] font-mono",children:"Monthly Payment"}),H.jsx("p",{className:"font-mono text-[var(--color-text-primary)]",children:Ut(e.amount)})]}),null!=e.apr&&H.jsxs("div",{children:[H.jsx("p",{className:"text-xs text-[var(--color-text-muted)] font-mono",children:"APR"}),H.jsxs("p",{className:"font-mono text-[var(--color-text-primary)]",children:[e.apr.toFixed(2),"%",e.aprType&&H.jsxs("span",{className:"text-[var(--color-text-muted)] text-xs ml-1",children:["(",e.aprType,")"]})]})]})]}),l&&t.payoffMonths>0&&H.jsxs("div",{className:"rounded border border-[var(--color-border)] bg-white/5 p-3 space-y-1",children:[H.jsxs("div",{className:"flex items-center justify-between text-xs font-mono",children:[H.jsx("span",{className:"text-[var(--color-text-muted)]",children:"Payoff projection"}),H.jsx("span",{className:"text-cyan-400",children:Hn(t.payoffMonths)})]}),H.jsxs("div",{className:"flex items-center justify-between text-xs font-mono",children:[H.jsx("span",{className:"text-[var(--color-text-muted)]",children:"Total interest"}),H.jsx("span",{className:"text-yellow-400",children:Ut(t.totalInterest)})]})]}),H.jsx("button",{onClick:()=>o(e.id),className:"text-xs text-[var(--color-text-muted)] hover:text-[var(--color-text-primary)] underline transition-colors",children:e.isPaid?"Mark as unpaid":"Mark as paid"})]}),l&&H.jsxs(H.Fragment,{children:[H.jsx("div",{className:"border-t border-[var(--color-border)]",children:H.jsxs("button",{onClick:()=>s(e.id),className:"w-full flex items-center justify-between px-4 py-2 text-xs text-[var(--color-text-muted)] hover:text-[var(--color-text-primary)] hover:bg-white/5 transition-colors font-mono",children:[H.jsx("span",{children:"Amortization schedule"}),n?H.jsx(oe,{size:14}):H.jsx(se,{size:14})]})}),n&&H.jsx("div",{className:"px-4 pb-4",children:H.jsx(Vn,{schedule:t.schedule})})]})]})}const Kn=["#ff6b35","#b026ff","#00fff9","#ffff00","#39ff14","#ff0080"];function Yn({summaries:e}){const t=function(e){if(0===e.length)return[];const t=Math.max(...e.map(e=>e.payoffMonths),1),n=[];for(let s=0;s<=t;s++){const t={label:Tn(s),total:0};for(const n of e){const e=n.bill.name;let a;a=0===s?n.bill.principalBalance??0:s<=n.schedule.length?n.schedule[s-1].balance:0,t[e]=a,t.total=t.total+a}t.total=Math.round(100*t.total)/100,n.push(t)}return n}(e),n=e.map(e=>e.bill.name),s=e.some(e=>(e.bill.principalBalance??0)>0);return H.jsxs(Kt,{children:[H.jsx("h3",{className:"text-lg font-bold font-display mb-4",children:"Payoff Timeline"}),s&&0!==e.length?H.jsx("div",{className:"h-64",children:H.jsx(m,{width:"100%",height:"100%",children:H.jsxs(I,{data:t,margin:{top:5,right:10,left:0,bottom:0},children:[H.jsx(u,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.05)"}),H.jsx(p,{dataKey:"label",stroke:"var(--color-text-muted)",fontSize:11,fontFamily:"Space Mono",interval:"preserveStartEnd",tick:{fontSize:11}}),H.jsx(f,{stroke:"var(--color-text-muted)",fontSize:11,fontFamily:"Space Mono",tickFormatter:e=>`$${(e/1e3).toFixed(0)}k`}),H.jsx(y,{contentStyle:{backgroundColor:"var(--color-bg-primary)",border:"1px solid var(--color-border)",borderRadius:"8px",fontFamily:"Space Mono",fontSize:"11px"},formatter:(e,t)=>[Ut(e),t]}),H.jsx(g,{wrapperStyle:{fontFamily:"Space Mono",fontSize:"11px"}}),n.map((e,t)=>H.jsx(C,{type:"monotone",dataKey:e,stroke:Kn[t%Kn.length],strokeWidth:1.5,dot:!1,name:e},e)),e.length>1&&H.jsx(C,{type:"monotone",dataKey:"total",stroke:"#ffffff",strokeWidth:2.5,dot:!1,name:"Total",strokeDasharray:"4 2"})]})})}):H.jsx("p",{className:"text-sm text-[var(--color-text-muted)] text-center py-8",children:"Add debt accounts with balances to see payoff projections"})]})}function Gn({active:e,payload:t}){if(!e||!(null==t?void 0:t.length))return null;const n=t[0].payload;return H.jsxs("div",{style:{backgroundColor:"#0d0117",border:`1px solid ${n.color}`,borderRadius:"8px",padding:"8px 12px",fontFamily:"Space Mono, monospace",fontSize:"12px",boxShadow:`0 0 12px ${n.color}33`},children:[H.jsx("p",{style:{color:n.color,fontWeight:"bold",marginBottom:"4px"},children:n.name}),H.jsx("p",{style:{color:"#ffffff"},children:Ut(n.value)})]})}function _n({bills:e}){const t=function(e){return e.filter(e=>"debt"===e.category&&(e.principalBalance??0)>0).map((e,t)=>({name:e.name,value:e.principalBalance,color:Rn[t%Rn.length]}))}(e),n=t.reduce((e,t)=>e+t.value,0);return H.jsxs(Kt,{children:[H.jsx("h3",{className:"text-lg font-bold font-display mb-4",children:"Debt Distribution"}),0===t.length?H.jsx("p",{className:"text-sm text-[var(--color-text-muted)] text-center py-8",children:"Add debt accounts with balances to see distribution"}):H.jsxs("div",{className:"flex flex-col lg:flex-row items-center gap-6",children:[H.jsx("div",{className:"w-44 h-44 flex-shrink-0",children:H.jsx(m,{width:"100%",height:"100%",children:H.jsxs(v,{children:[H.jsx(j,{data:t,cx:"50%",cy:"50%",innerRadius:42,outerRadius:70,paddingAngle:2,dataKey:"value",children:t.map((e,t)=>H.jsx(N,{fill:e.color},t))}),H.jsx(y,{content:H.jsx(Gn,{})})]})})}),H.jsx("div",{className:"flex-1 w-full space-y-2",children:t.map(e=>H.jsxs("div",{className:"flex items-center gap-3",children:[H.jsx("div",{className:"w-3 h-3 rounded-full flex-shrink-0",style:{backgroundColor:e.color}}),H.jsx("span",{className:"text-sm flex-1 truncate",children:e.name}),H.jsx("span",{className:"text-sm font-mono text-[var(--color-text-secondary)]",children:Ut(e.value)}),H.jsxs("span",{className:"text-xs text-[var(--color-text-muted)] w-12 text-right",children:[n>0?(e.value/n*100).toFixed(1):"0","%"]})]},e.name))})]})]})}function Xn(){const{bills:e,loading:t,loadBills:s,addBill:a,updateBill:r,deleteBill:o,togglePaid:l}=St(),[i,c]=n.useState(!1),[d,x]=n.useState(),[m,h]=n.useState(null),[u,p]=n.useState(null);n.useEffect(()=>{s()},[s]);const f=e.filter(e=>"debt"===e.category),y=f.map(Ln),g=function(e){const t=e.filter(e=>"debt"===e.category);if(0===t.length)return{totalBalance:0,totalMonthlyPayment:0,totalInterest:0,weightedApr:0,earliestPayoffMonth:0,latestPayoffMonth:0};const n=t.map(Ln),s=t.reduce((e,t)=>e+(t.principalBalance??0),0),a=t.reduce((e,t)=>e+t.amount,0),r=n.reduce((e,t)=>e+t.totalInterest,0),o=t.reduce((e,t)=>e+(t.principalBalance??0)*(t.apr??0),0),l=s>0?o/s:0,i=n.map(e=>e.payoffMonths).filter(e=>e>0),c=i.length>0?Math.min(...i):0,d=i.length>0?Math.max(...i):0;return{totalBalance:Math.round(100*s)/100,totalMonthlyPayment:Math.round(100*a)/100,totalInterest:Math.round(100*r)/100,weightedApr:Math.round(100*l)/100,earliestPayoffMonth:c,latestPayoffMonth:d}}(f),b=e=>{x(e),c(!0)},v=e=>{h(t=>t===e?null:e)};return t?H.jsx(jn,{}):H.jsxs("div",{className:"max-w-5xl mx-auto space-y-6",children:[H.jsxs("div",{className:"flex items-center justify-between",children:[H.jsxs("div",{children:[H.jsx("h1",{className:"text-3xl font-bold font-display bg-gradient-to-r from-[#ff6b35] to-[#b026ff] bg-clip-text text-transparent",children:"Debt"}),H.jsxs("p",{className:"text-sm text-[var(--color-text-secondary)] mt-1",children:[f.length," account",1!==f.length?"s":""," tracked"]})]}),H.jsxs(kn,{onClick:()=>{x(void 0),c(!0)},children:[H.jsx(Ne,{size:18}),"Add Debt"]})]}),0===f.length?H.jsx(Dn,{icon:ie,title:"No debt accounts yet",description:"Track credit cards, student loans, and other debt to see payoff projections and amortization schedules.",action:H.jsxs(kn,{onClick:()=>c(!0),children:[H.jsx(Ne,{size:18}),"Add Your First Debt"]})}):H.jsxs(H.Fragment,{children:[H.jsx(Wn,{portfolio:g}),H.jsxs("div",{className:"grid gap-4 lg:grid-cols-2",children:[H.jsx(Yn,{summaries:y}),H.jsx(_n,{bills:f})]}),H.jsx("div",{className:"grid gap-4 sm:grid-cols-2",children:f.map(e=>{const t=y.find(t=>t.bill.id===e.id);return H.jsx(Un,{bill:e,summary:t,isExpanded:m===e.id,onToggleExpand:v,onEdit:b,onDelete:e=>p(e),onTogglePaid:l},e.id)})})]}),H.jsx(An,{open:i,onClose:()=>{c(!1),x(void 0)},title:d?"Edit Debt Account":"Add Debt Account",children:H.jsx(Cn,{bill:d??{category:"debt"},onSubmit:async e=>{d?await r({...d,...e}):await a({...e,category:"debt"}),c(!1),x(void 0)},onCancel:()=>{c(!1),x(void 0)}})}),H.jsxs(An,{open:!!u,onClose:()=>p(null),title:"Delete Debt Account?",children:[H.jsx("p",{className:"text-sm text-[var(--color-text-secondary)] mb-4",children:"Are you sure you want to delete this debt account? This action cannot be undone."}),H.jsxs("div",{className:"flex justify-end gap-3",children:[H.jsx(kn,{variant:"ghost",onClick:()=>p(null),children:"Cancel"}),H.jsx(kn,{variant:"danger",onClick:()=>u&&(async e=>{await o(e),p(null)})(u),children:"Delete"})]})]})]})}function Zn(){const e=mt(e=>e.theme);return n.useEffect(()=>{document.documentElement.setAttribute("data-theme",e)},[e]),H.jsxs(i,{children:[H.jsx(On,{}),H.jsx(c,{children:H.jsxs(d,{element:H.jsx(ft,{}),children:[H.jsx(d,{path:"/",element:H.jsx(Nn,{})}),H.jsx(d,{path:"/bills",element:H.jsx(zn,{})}),H.jsx(d,{path:"/debt",element:H.jsx(Xn,{})}),H.jsx(d,{path:"/income",element:H.jsx($n,{})}),H.jsx(d,{path:"/forecast",element:H.jsx(In,{})}),H.jsx(d,{path:"/settings",element:H.jsx(En,{})})]})})]})}U.createRoot(document.getElementById("root")).render(H.jsx(r.StrictMode,{children:H.jsx(Zn,{})}));
