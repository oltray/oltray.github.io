var e=Object.defineProperty,t=(t,s,n)=>((t,s,n)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n)(t,"symbol"!=typeof s?s+"":s,n);import{r as s,a as n,g as a,R as r,N as o,O as l,H as i,b as c,d}from"./react-vendor-BpfFb6RJ.js";import{c as x,R as m,A as h,C as u,X as p,Y as g,T as f,L as y,a as b,P as v,b as j,d as N,B as w,e as k,f as S,g as C,h as M,i as $,j as z,k as A,l as F,m as D}from"./chart-vendor-jlShF_xA.js";import{X as I}from"./db-vendor-DCtitoAh.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var E={exports:{}},O={},P=s,R=Symbol.for("react.element"),B=Symbol.for("react.fragment"),L=Object.prototype.hasOwnProperty,q=P.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,V={key:!0,ref:!0,__self:!0,__source:!0};function W(e,t,s){var n,a={},r=null,o=null;for(n in void 0!==s&&(r=""+s),void 0!==t.key&&(r=""+t.key),void 0!==t.ref&&(o=t.ref),t)L.call(t,n)&&!V.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===a[n]&&(a[n]=t[n]);return{$$typeof:R,type:e,key:r,ref:o,props:a,_owner:q.current}}O.Fragment=B,O.jsx=W,O.jsxs=W,E.exports=O;var T=E.exports,H={},K=n;H.createRoot=K.createRoot,H.hydrateRoot=K.hydrateRoot;
/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
var U={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};
/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=(e,t)=>{const n=s.forwardRef(({color:n="currentColor",size:a=24,strokeWidth:r=2,absoluteStrokeWidth:o,className:l="",children:i,...c},d)=>{return s.createElement("svg",{ref:d,...U,width:a,height:a,stroke:n,strokeWidth:o?24*Number(r)/Number(a):r,className:["lucide",`lucide-${x=e,x.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim()}`,l].join(" "),...c},[...t.map(([e,t])=>s.createElement(e,t)),...Array.isArray(i)?i:[i]]);var x});return n.displayName=`${e}`,n},_=Y("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]),G=Y("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),Z=Y("ArrowDownRight",[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]]),J=Y("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]),X=Y("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]),Q=Y("Brain",[["path",{d:"M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 1.98-3A2.5 2.5 0 0 1 9.5 2Z",key:"1mhkh5"}],["path",{d:"M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 14.5 2Z",key:"1d6s00"}]]),ee=Y("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),te=Y("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),se=Y("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),ne=Y("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),ae=Y("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),re=Y("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),oe=Y("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),le=Y("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]),ie=Y("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),ce=Y("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),de=Y("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),xe=Y("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),me=Y("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),he=Y("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]),ue=Y("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),pe=Y("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",key:"1xcu5"}],["circle",{cx:"17.5",cy:"10.5",r:".5",key:"736e4u"}],["circle",{cx:"8.5",cy:"7.5",r:".5",key:"clrty"}],["circle",{cx:"6.5",cy:"12.5",r:".5",key:"1s4xz9"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]),ge=Y("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),fe=Y("PiggyBank",[["path",{d:"M19 5c-1.5 0-2.8 1.4-3 2-3.5-1.5-11-.3-11 5 0 1.8 0 3 2 4.5V20h4v-2h3v2h4v-4c1-.5 1.7-1 2-2h2v-4h-2c0-1-.5-1.5-1-2h0V5z",key:"uf6l00"}],["path",{d:"M2 9v1c0 1.1.9 2 2 2h1",key:"nm575m"}],["path",{d:"M16 11h0",key:"k2aug8"}]]),ye=Y("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),be=Y("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1-2-1Z",key:"wqdwcb"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17V7",key:"pyj7ub"}]]),ve=Y("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),je=Y("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Ne=Y("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]),we=Y("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),ke=Y("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]),Se=Y("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),Ce=Y("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),Me=Y("XOctagon",[["polygon",{points:"7.86 2 16.14 2 22 7.86 22 16.14 16.14 22 7.86 22 2 16.14 2 7.86 7.86 2",key:"h1p8hx"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),$e=Y("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),ze=Y("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),Ae={},Fe=e=>{let t;const s=new Set,n=(e,n)=>{const a="function"==typeof e?e(t):e;if(!Object.is(a,t)){const e=t;t=(null!=n?n:"object"!=typeof a||null===a)?a:Object.assign({},t,a),s.forEach(s=>s(t,e))}},a=()=>t,r={setState:n,getState:a,getInitialState:()=>o,subscribe:e=>(s.add(e),()=>s.delete(e)),destroy:()=>{"production"!==(Ae?"production":void 0)&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),s.clear()}},o=t=e(n,a,r);return r};var De={exports:{}},Ie={},Ee={exports:{}},Oe={},Pe=s;var Re="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},Be=Pe.useState,Le=Pe.useEffect,qe=Pe.useLayoutEffect,Ve=Pe.useDebugValue;function We(e){var t=e.getSnapshot;e=e.value;try{var s=t();return!Re(e,s)}catch(n){return!0}}var Te="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var s=t(),n=Be({inst:{value:s,getSnapshot:t}}),a=n[0].inst,r=n[1];return qe(function(){a.value=s,a.getSnapshot=t,We(a)&&r({inst:a})},[e,s,t]),Le(function(){return We(a)&&r({inst:a}),e(function(){We(a)&&r({inst:a})})},[e]),Ve(s),s};Oe.useSyncExternalStore=void 0!==Pe.useSyncExternalStore?Pe.useSyncExternalStore:Te,Ee.exports=Oe;var He=Ee.exports,Ke=s,Ue=He;
/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ye="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},_e=Ue.useSyncExternalStore,Ge=Ke.useRef,Ze=Ke.useEffect,Je=Ke.useMemo,Xe=Ke.useDebugValue;Ie.useSyncExternalStoreWithSelector=function(e,t,s,n,a){var r=Ge(null);if(null===r.current){var o={hasValue:!1,value:null};r.current=o}else o=r.current;r=Je(function(){function e(e){if(!i){if(i=!0,r=e,e=n(e),void 0!==a&&o.hasValue){var t=o.value;if(a(t,e))return l=t}return l=e}if(t=l,Ye(r,e))return t;var s=n(e);return void 0!==a&&a(t,s)?(r=e,t):(r=e,l=s)}var r,l,i=!1,c=void 0===s?null:s;return[function(){return e(t())},null===c?void 0:function(){return e(c())}]},[t,s,n,a]);var l=_e(e,r[0],r[1]);return Ze(function(){o.hasValue=!0,o.value=l},[l]),Xe(l),l},De.exports=Ie;const Qe=a(De.exports),et={},{useDebugValue:tt}=r,{useSyncExternalStoreWithSelector:st}=Qe;let nt=!1;const at=e=>e;const rt=e=>{"production"!==(et?"production":void 0)&&"function"!=typeof e&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t="function"==typeof e?(e=>e?Fe(e):Fe)(e):e,s=(e,s)=>function(e,t=at,s){"production"!==(et?"production":void 0)&&s&&!nt&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),nt=!0);const n=st(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,s);return tt(n),n}(t,e,s);return Object.assign(s,t),s},ot=e=>e?rt(e):rt,lt=ot(e=>({theme:localStorage.getItem("finvis-theme")||"y2k",sidebarOpen:!1,setTheme:t=>{localStorage.setItem("finvis-theme",t),document.documentElement.setAttribute("data-theme",t),e({theme:t})},toggleSidebar:()=>e(e=>({sidebarOpen:!e.sidebarOpen})),setSidebarOpen:t=>e({sidebarOpen:t})})),it=[{to:"/",icon:he,label:"Dashboard"},{to:"/bills",icon:be,label:"Bills"},{to:"/income",icon:ie,label:"Income"},{to:"/forecast",icon:Se,label:"Forecast"},{to:"/settings",icon:je,label:"Settings"}];function ct(){const{sidebarOpen:e,setSidebarOpen:t}=lt();return T.jsxs(T.Fragment,{children:[e&&T.jsx("div",{className:"fixed inset-0 z-40 bg-black/50 lg:hidden",onClick:()=>t(!1)}),T.jsxs("aside",{className:x("fixed top-0 left-0 z-50 h-full w-60 bg-[var(--color-bg-secondary)] border-r border-[var(--color-border)]","flex flex-col","transform transition-transform duration-200 lg:translate-x-0 lg:static lg:z-auto",e?"translate-x-0":"-translate-x-full"),children:[T.jsxs("div",{className:"flex-shrink-0 flex items-center justify-between p-5 border-b border-[var(--color-border)]",children:[T.jsx("h1",{className:"text-xl font-bold font-display bg-gradient-to-r from-neon-pink to-neon-cyan bg-clip-text text-transparent",children:"FinVis"}),T.jsx("button",{className:"lg:hidden p-1 hover:bg-white/10 rounded",onClick:()=>t(!1),"aria-label":"Close menu",children:T.jsx($e,{size:20})})]}),T.jsx("nav",{className:"flex-1 overflow-y-auto p-3 space-y-1",children:it.map(({to:e,icon:s,label:n})=>T.jsxs(o,{to:e,onClick:()=>t(!1),className:({isActive:e})=>x("flex items-center gap-3 px-4 py-2.5 rounded-lg text-sm font-medium transition-colors",e?"bg-neon-pink/10 text-neon-pink":"text-[var(--color-text-secondary)] hover:text-[var(--color-text-primary)] hover:bg-white/5"),children:[T.jsx(s,{size:18}),n]},e))}),T.jsx("div",{className:"flex-shrink-0 p-4 border-t border-[var(--color-border)]",children:T.jsx("p",{className:"text-xs text-[var(--color-text-muted)] text-center",children:"100% Private · Your Data Stays Local"})})]}),T.jsx("nav",{className:"fixed bottom-0 left-0 right-0 z-30 bg-[var(--color-bg-secondary)] border-t border-[var(--color-border)] lg:hidden",children:T.jsx("div",{className:"flex items-center justify-around py-2",children:it.slice(0,4).map(({to:e,icon:t,label:s})=>T.jsxs(o,{to:e,className:({isActive:e})=>x("flex flex-col items-center gap-0.5 px-3 py-1 text-xs transition-colors",e?"text-neon-pink":"text-[var(--color-text-muted)]"),children:[T.jsx(t,{size:20}),T.jsx("span",{children:s})]},e))})})]})}function dt(){const e=lt(e=>e.toggleSidebar);return T.jsx("header",{className:"sticky top-0 z-20 bg-[var(--color-bg-primary)]/80 backdrop-blur-md border-b border-[var(--color-border)] lg:hidden",children:T.jsxs("div",{className:"flex items-center gap-4 px-4 py-3",children:[T.jsx("button",{onClick:e,className:"p-1.5 hover:bg-white/10 rounded-lg transition-colors","aria-label":"Toggle menu",children:T.jsx(ue,{size:22})}),T.jsx("h1",{className:"text-lg font-bold font-display bg-gradient-to-r from-neon-pink to-neon-cyan bg-clip-text text-transparent",children:"FinVis"})]})})}function xt(){return T.jsxs("div",{className:"flex min-h-screen",children:[T.jsx(ct,{}),T.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[T.jsx(dt,{}),T.jsx("main",{className:"flex-1 p-4 lg:p-8 pb-20 lg:pb-8",children:T.jsx(l,{})})]})]})}const mt={weekly:"Weekly",biweekly:"Biweekly",monthly:"Monthly",quarterly:"Quarterly",yearly:"Yearly"},ht={housing:"Housing",utilities:"Utilities",transportation:"Transportation",insurance:"Insurance",debt:"Debt",subscriptions:"Subscriptions",lifestyle:"Lifestyle",savings:"Savings",other:"Other"},ut={housing:"#ff0080",utilities:"#00fff9",transportation:"#b026ff",insurance:"#ffff00",debt:"#ff6b35",subscriptions:"#39ff14",lifestyle:"#ff69b4",savings:"#00bfff",other:"#888888"},pt={ongoing:"Ongoing",contract:"Contract",installment:"Installment","one-time":"One-Time"};const gt=new class extends I{constructor(){super("finvis"),t(this,"bills"),t(this,"incomes"),this.version(1).stores({bills:"id, name, category, dueDay, frequency, type",incomes:"id, name, payPeriod"})}},ft={getAll:async()=>gt.bills.toArray(),getById:async e=>gt.bills.get(e),async save(e){await gt.bills.put({...e,updatedAt:(new Date).toISOString()})},async delete(e){await gt.bills.delete(e)},async deleteAll(){await gt.bills.clear()},count:async()=>gt.bills.count()},yt=ot((e,t)=>({bills:[],loading:!1,error:null,loadBills:async()=>{e({loading:!0,error:null});try{const t=await ft.getAll();e({bills:t,loading:!1})}catch(t){e({error:"Failed to load bills",loading:!1})}},addBill:async s=>{try{const n=function(e){const t=(new Date).toISOString();return{id:crypto.randomUUID(),frequency:"monthly",category:"other",dueDay:1,type:"ongoing",isPaid:!1,createdAt:t,updatedAt:t,...e}}(s);await ft.save(n),e({bills:[...t().bills,n]})}catch(n){e({error:"Failed to add bill"})}},updateBill:async s=>{try{const n={...s,updatedAt:(new Date).toISOString()};await ft.save(n),e({bills:t().bills.map(e=>e.id===s.id?n:e)})}catch(n){e({error:"Failed to update bill"})}},deleteBill:async s=>{try{await ft.delete(s),e({bills:t().bills.filter(e=>e.id!==s)})}catch(n){e({error:"Failed to delete bill"})}},togglePaid:async s=>{const n=t().bills.find(e=>e.id===s);if(!n)return;const a={...n,isPaid:!n.isPaid,updatedAt:(new Date).toISOString()};await ft.save(a),e({bills:t().bills.map(e=>e.id===s?a:e)})}})),bt={weekly:"Weekly",biweekly:"Biweekly","semi-monthly":"Semi-Monthly",monthly:"Monthly",annually:"Annually"};const vt={getAll:async()=>gt.incomes.toArray(),getById:async e=>gt.incomes.get(e),async save(e){await gt.incomes.put({...e,updatedAt:(new Date).toISOString()})},async delete(e){await gt.incomes.delete(e)},async deleteAll(){await gt.incomes.clear()}},jt=ot((e,t)=>({incomes:[],loading:!1,error:null,loadIncomes:async()=>{e({loading:!0,error:null});try{const t=await vt.getAll();e({incomes:t,loading:!1})}catch(t){e({error:"Failed to load income data",loading:!1})}},addIncome:async s=>{try{const n=function(e){const t=(new Date).toISOString();return{id:crypto.randomUUID(),payPeriod:"monthly",createdAt:t,updatedAt:t,...e}}(s);await vt.save(n),e({incomes:[...t().incomes,n]})}catch(n){e({error:"Failed to add income"})}},updateIncome:async s=>{try{const n={...s,updatedAt:(new Date).toISOString()};await vt.save(n),e({incomes:t().incomes.map(e=>e.id===s.id?n:e)})}catch(n){e({error:"Failed to update income"})}},deleteIncome:async s=>{try{await vt.delete(s),e({incomes:t().incomes.filter(e=>e.id!==s)})}catch(n){e({error:"Failed to delete income"})}}})),Nt={weekly:52/12,biweekly:26/12,monthly:1,quarterly:1/3,yearly:1/12},wt={weekly:52/12,biweekly:26/12,"semi-monthly":2,monthly:1,annually:1/12};function kt(e,t){return e*Nt[t]}function St(e){return e.amount*wt[e.payPeriod]}function Ct(e){return e.reduce((e,t)=>e+kt(t.amount,t.frequency),0)}function Mt(e){return e.reduce((e,t)=>e+St(t),0)}function $t(e){const t=new Map;for(const n of e){const e=kt(n.amount,n.frequency),s=t.get(n.category)||{total:0,count:0};t.set(n.category,{total:s.total+e,count:s.count+1})}const s=Array.from(t.values()).reduce((e,t)=>e+t.total,0);return Array.from(t.entries()).map(([e,{total:t,count:n}])=>({category:e,total:t,percentage:s>0?t/s*100:0,count:n})).sort((e,t)=>t.total-e.total)}function zt(e,t,s,n){const a=Mt(t),r=[];let o=0;for(let l=0;l<n;l++){const t=new Date(s.getFullYear(),s.getMonth()+l,1),n=t.getMonth(),i=t.getFullYear(),c=t.toLocaleDateString("en-US",{month:"short",year:"numeric"}),d=e.filter(e=>{if("one-time"===e.type){if(!e.contractEndDate)return!1;const t=new Date(e.contractEndDate);return t.getMonth()===n&&t.getFullYear()===i}return"contract"===e.type&&e.contractEndDate?new Date(e.contractEndDate)>=t:"installment"!==e.type||void 0===e.paymentsRemaining||e.paymentsRemaining>l}).map(e=>({name:e.name,amount:kt(e.amount,e.frequency),category:e.category})),x=d.reduce((e,t)=>e+t.amount,0),m=a-x;o+=m,r.push({month:n,year:i,label:c,totalIncome:a,totalExpenses:x,netCashFlow:m,runningBalance:o,bills:d})}return r}function At(e){return 0===e.length?0:e.reduce((e,t)=>e+t,0)/e.length}function Ft(e){if(e.length<2)return 0;const t=At(e),s=e.map(e=>(e-t)**2);return Math.sqrt(At(s))}function Dt(e,t){const s=Ft(t);return 0===s?0:(e-At(t))/s}function It(e,t,s){return Math.min(Math.max(e,t),s)}function Et(e,t){const s=Mt(t),n=Ct(e),a=It(2.5*(s>0?(s-n)/s*100:0),0,100),r=It(35*t.length,0,100),o=["housing","insurance","debt"],l=It(100*(1-e.filter(e=>o.includes(e.category)).reduce((e,t)=>e+t.amount,0)/(e.reduce((e,t)=>e+t.amount,0)||1)),0,100),i=It(16.7*(s-n>0?6:s>0?s/n*6:0),0,100),c=It(100*(1-(e.length>0?Math.max(...e.map(e=>e.amount/(s||1))):0)),0,100),d=Math.round(.3*a+.15*r+.15*l+.25*i+.15*c);let x,m;return x=d>=85?"A":d>=70?"B":d>=55?"C":d>=40?"D":"F",m=d>=75?"low":d>=55?"moderate":d>=35?"high":"critical",{overall:d,breakdown:{savingsRate:Math.round(a),incomeStability:Math.round(r),expenseFlexibility:Math.round(l),emergencyRunway:Math.round(i),billConcentration:Math.round(c)},grade:x,riskLevel:m}}const Ot=["housing","insurance","debt"],Pt=["lifestyle","subscriptions","other","transportation"];function Rt(e,t,s=6){const n=zt(e,t,new Date,s),a=new Map;for(const u of n)for(const e of u.bills){const t=e.category;a.has(t)||a.set(t,[]);const s=a.get(t);for(;s.length<n.indexOf(u);)s.push(0);s[n.indexOf(u)]=(s[n.indexOf(u)]||0)+e.amount}const r=Array.from(a.entries()).map(([e,t])=>{const s=function(e){if(e.length<2)return 0;const t=e.length,s=(t-1)/2,n=At(e);let a=0,r=0;for(let o=0;o<t;o++)a+=(o-s)*(e[o]-n),r+=(o-s)**2;return 0===r?0:a/r}(t);let n="stable";return s>5?n="rising":s<-5&&(n="falling"),{category:e,monthlyAmounts:t,trend:n,slopePerMonth:s,volatility:Ft(t)}}),o=n.map((e,t)=>{const s=t>0?n[t-1].totalExpenses:e.totalExpenses,a=(r=s,o=e.totalExpenses,0===r?o>0?100:0:(o-r)/Math.abs(r)*100);var r,o;const l=At(n.slice(0,t+1).map(e=>e.totalExpenses));return{label:e.label,totalExpenses:e.totalExpenses,changePercent:0===t?0:a,movingAvg:l}}),l=e.filter(e=>Ot.includes(e.category)).reduce((e,t)=>e+kt(t.amount,t.frequency),0),i=e.filter(e=>Pt.includes(e.category)).reduce((e,t)=>e+kt(t.amount,t.frequency),0),c=l+i||1,d=[0,0,0,0];for(const u of e){d[Math.min(Math.floor((u.dueDay-1)/7),3)]+=kt(u.amount,u.frequency)}const x=d.indexOf(Math.max(...d)),m=r.filter(e=>"rising"===e.trend).sort((e,t)=>t.slopePerMonth-e.slopePerMonth),h=r.filter(e=>"falling"===e.trend).sort((e,t)=>e.slopePerMonth-t.slopePerMonth);return{categoryTrends:r,spendingVelocity:o,fixedVsVariableRatio:{fixed:l,variable:i,ratio:l/c},heaviestWeek:{weekLabel:["Days 1-7","Days 8-14","Days 15-21","Days 22-31"][x],amount:d[x]},topGrowingCategory:m[0]||null,topShrinkingCategory:h[0]||null}}function Bt(e){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(e)}function Lt({children:e,hover:t=!1,className:s,...n}){return T.jsx("div",{className:x("rounded-xl border border-[var(--color-border)] bg-[var(--color-bg-secondary)] p-6",t&&"transition-all hover:border-neon-pink/30 hover:shadow-glow-pink",s),...n,children:e})}function qt(e,t){return new Date(t,e).toLocaleDateString("en-US",{month:"short",year:"numeric"})}const Vt=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];function Wt(e,t){if(0===e)return"bg-white/5";const s=e/t;return s<.25?"bg-neon-pink/20":s<.5?"bg-neon-pink/40":s<.75?"bg-neon-pink/60":"bg-neon-pink/80"}function Tt({bills:e}){const t=new Date,[n,a]=s.useState(t.getMonth()),[r,o]=s.useState(t.getFullYear()),l=s.useMemo(()=>function(e,t,s){const n=new Date(t,s+1,0).getDate(),a=[];for(let r=1;r<=n;r++){const t=e.filter(e=>e.dueDay===r),s=t.reduce((e,t)=>e+kt(t.amount,t.frequency),0);a.push({day:r,amount:s,bills:t.map(e=>e.name)})}return a}(e,r,n),[e,r,n]),i=s.useMemo(()=>Math.max(...l.map(e=>e.amount),1),[l]),c=function(e,t){return new Date(t,e+1,0).getDate()}(n,r),d=function(e,t){return new Date(t,e,1).getDay()}(n,r);return T.jsxs(Lt,{children:[T.jsxs("div",{className:"flex items-center justify-between mb-4",children:[T.jsx("h3",{className:"text-lg font-bold font-display",children:"Payment Calendar"}),T.jsxs("div",{className:"flex items-center gap-2",children:[T.jsx("button",{onClick:()=>{0===n?(a(11),o(r-1)):a(n-1)},className:"p-1 hover:bg-white/10 rounded transition-colors","aria-label":"Previous month",children:T.jsx(ne,{size:18})}),T.jsx("span",{className:"text-sm font-mono min-w-[120px] text-center",children:qt(n,r)}),T.jsx("button",{onClick:()=>{11===n?(a(0),o(r+1)):a(n+1)},className:"p-1 hover:bg-white/10 rounded transition-colors","aria-label":"Next month",children:T.jsx(ae,{size:18})})]})]}),T.jsx("div",{className:"grid grid-cols-7 gap-1 mb-1",children:Vt.map(e=>T.jsx("div",{className:"text-xs text-center text-[var(--color-text-muted)] py-1",children:e},e))}),T.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[Array.from({length:d}).map((e,t)=>T.jsx("div",{className:"aspect-square"},`empty-${t}`)),Array.from({length:c}).map((e,t)=>{const s=t+1,n=l.find(e=>e.day===s),a=(null==n?void 0:n.amount)||0,r=(null==n?void 0:n.bills)||[];return T.jsxs("div",{className:`aspect-square rounded-md flex flex-col items-center justify-center relative group cursor-default ${Wt(a,i)}`,children:[T.jsx("span",{className:"text-xs font-mono",children:s}),a>0&&T.jsx("span",{className:"text-[10px] font-mono text-neon-pink",children:Bt(a)}),a>0&&T.jsx("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 hidden group-hover:block z-10",children:T.jsxs("div",{className:"bg-[var(--color-bg-primary)] border border-[var(--color-border)] rounded-lg p-2 shadow-lg min-w-[140px]",children:[T.jsx("p",{className:"text-xs font-mono text-neon-cyan mb-1",children:Bt(a)}),r.map(e=>T.jsx("p",{className:"text-xs text-[var(--color-text-secondary)]",children:e},e))]})})]},s)})]}),T.jsxs("div",{className:"flex items-center justify-end gap-2 mt-4",children:[T.jsx("span",{className:"text-xs text-[var(--color-text-muted)]",children:"Less"}),T.jsx("div",{className:"flex gap-1",children:["bg-white/5","bg-neon-pink/20","bg-neon-pink/40","bg-neon-pink/60","bg-neon-pink/80"].map(e=>T.jsx("div",{className:`w-3 h-3 rounded-sm ${e}`},e))}),T.jsx("span",{className:"text-xs text-[var(--color-text-muted)]",children:"More"})]})]})}function Ht({bills:e,incomes:t,months:n=6}){const a=s.useMemo(()=>zt(e,t,new Date,n),[e,t,n]).map(e=>({name:e.label,income:Math.round(100*e.totalIncome)/100,expenses:Math.round(100*e.totalExpenses)/100,balance:Math.round(100*e.runningBalance)/100}));return T.jsxs(Lt,{children:[T.jsx("h3",{className:"text-lg font-bold font-display mb-4",children:"Cash Flow Forecast"}),T.jsx("div",{className:"h-72",children:T.jsx(m,{width:"100%",height:"100%",children:T.jsxs(h,{data:a,margin:{top:5,right:10,left:0,bottom:0},children:[T.jsxs("defs",{children:[T.jsxs("linearGradient",{id:"incomeGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[T.jsx("stop",{offset:"5%",stopColor:"#39ff14",stopOpacity:.3}),T.jsx("stop",{offset:"95%",stopColor:"#39ff14",stopOpacity:0})]}),T.jsxs("linearGradient",{id:"expenseGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[T.jsx("stop",{offset:"5%",stopColor:"#ff0080",stopOpacity:.3}),T.jsx("stop",{offset:"95%",stopColor:"#ff0080",stopOpacity:0})]})]}),T.jsx(u,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.05)"}),T.jsx(p,{dataKey:"name",stroke:"var(--color-text-muted)",fontSize:12,fontFamily:"Space Mono"}),T.jsx(g,{stroke:"var(--color-text-muted)",fontSize:12,fontFamily:"Space Mono",tickFormatter:e=>`$${(e/1e3).toFixed(1)}k`}),T.jsx(f,{contentStyle:{backgroundColor:"var(--color-bg-primary)",border:"1px solid var(--color-border)",borderRadius:"8px",fontFamily:"Space Mono",fontSize:"12px"},formatter:e=>Bt(e)}),T.jsx(y,{wrapperStyle:{fontFamily:"Space Mono",fontSize:"12px"}}),T.jsx(b,{type:"monotone",dataKey:"income",stroke:"#39ff14",fill:"url(#incomeGradient)",strokeWidth:2,name:"Income"}),T.jsx(b,{type:"monotone",dataKey:"expenses",stroke:"#ff0080",fill:"url(#expenseGradient)",strokeWidth:2,name:"Expenses"})]})})})]})}function Kt({bills:e}){const t=s.useMemo(()=>$t(e),[e]),n=t.map(e=>({name:ht[e.category],value:Math.round(100*e.total)/100,color:ut[e.category],percentage:e.percentage}));return T.jsxs(Lt,{children:[T.jsx("h3",{className:"text-lg font-bold font-display mb-4",children:"Spending by Category"}),0===t.length?T.jsx("p",{className:"text-sm text-[var(--color-text-muted)] text-center py-8",children:"Add bills to see your category breakdown"}):T.jsxs("div",{className:"flex flex-col lg:flex-row items-center gap-6",children:[T.jsx("div",{className:"w-48 h-48 flex-shrink-0",children:T.jsx(m,{width:"100%",height:"100%",children:T.jsxs(v,{children:[T.jsx(j,{data:n,cx:"50%",cy:"50%",innerRadius:45,outerRadius:75,paddingAngle:2,dataKey:"value",children:n.map((e,t)=>T.jsx(N,{fill:e.color},t))}),T.jsx(f,{contentStyle:{backgroundColor:"var(--color-bg-primary)",border:"1px solid var(--color-border)",borderRadius:"8px",fontFamily:"Space Mono",fontSize:"12px"},formatter:e=>Bt(e)})]})})}),T.jsx("div",{className:"flex-1 w-full space-y-2",children:t.map(e=>T.jsxs("div",{className:"flex items-center gap-3",children:[T.jsx("div",{className:"w-3 h-3 rounded-full flex-shrink-0",style:{backgroundColor:ut[e.category]}}),T.jsx("span",{className:"text-sm flex-1",children:ht[e.category]}),T.jsx("span",{className:"text-sm font-mono text-[var(--color-text-secondary)]",children:Bt(e.total)}),T.jsxs("span",{className:"text-xs text-[var(--color-text-muted)] w-12 text-right",children:[e.percentage.toFixed(1),"%"]})]},e.category))})]})]})}function Ut({bills:e,incomes:t,months:n=6}){const a=s.useMemo(()=>zt(e,t,new Date,n),[e,t,n]).map(e=>({name:e.label,income:Math.round(e.totalIncome),expenses:Math.round(e.totalExpenses),net:Math.round(e.netCashFlow)}));return T.jsxs(Lt,{children:[T.jsx("h3",{className:"text-lg font-bold font-display mb-4",children:"Income vs Expenses"}),T.jsx("div",{className:"h-56",children:T.jsx(m,{width:"100%",height:"100%",children:T.jsxs(w,{data:a,margin:{top:5,right:10,left:0,bottom:0},children:[T.jsx(u,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.05)"}),T.jsx(p,{dataKey:"name",stroke:"var(--color-text-muted)",fontSize:11,fontFamily:"Space Mono"}),T.jsx(g,{stroke:"var(--color-text-muted)",fontSize:11,fontFamily:"Space Mono",tickFormatter:e=>`$${(e/1e3).toFixed(1)}k`}),T.jsx(f,{contentStyle:{backgroundColor:"var(--color-bg-primary)",border:"1px solid var(--color-border)",borderRadius:"8px",fontSize:"12px"},formatter:e=>Bt(e)}),T.jsx(y,{wrapperStyle:{fontFamily:"Space Mono",fontSize:"11px"}}),T.jsx(k,{dataKey:"income",fill:"#39ff14",radius:[4,4,0,0],name:"Income"}),T.jsx(k,{dataKey:"expenses",fill:"#ff0080",radius:[4,4,0,0],name:"Expenses"})]})})})]})}function Yt({bills:e,incomes:t}){const n=s.useMemo(()=>{if(0===t.length||0===e.length)return null;const s=t.reduce((e,t)=>e+St(t),0),n=new Map;for(const t of e){const e=kt(t.amount,t.frequency);n.set(t.category,(n.get(t.category)||0)+e)}const a=Array.from(n.entries()).sort((e,t)=>t[1]-e[1]),r=a.reduce((e,[,t])=>e+t,0),o=Math.max(s-r,0),l=300,i=[];let c=10;for(const e of t){const t=St(e),n=Math.max(t/s*260,12);i.push({label:e.name,amount:t,color:"#39ff14",x:20,y:c,height:n}),c+=n+6}const d=[];c=10;for(const[e,t]of a){const n=Math.max(t/s*260,12);d.push({label:ht[e],amount:t,color:ut[e],x:460,y:c,height:n}),c+=n+6}if(o>0){const e=Math.max(o/s*260,12);d.push({label:"Savings",amount:o,color:"#00fff9",x:460,y:c,height:e})}return{incomeNodes:i,catNodes:d,svgWidth:600,svgHeight:l,totalIncome:s}},[e,t]);if(!n)return T.jsxs(Lt,{children:[T.jsx("h3",{className:"text-lg font-bold font-display mb-2",children:"Money Flow"}),T.jsx("p",{className:"text-sm text-[var(--color-text-muted)] text-center py-8",children:"Add income and bills to see your money flow"})]});const{incomeNodes:a,catNodes:r,svgWidth:o,svgHeight:l}=n;return T.jsxs(Lt,{children:[T.jsx("h3",{className:"text-lg font-bold font-display mb-4",children:"Money Flow"}),T.jsx("div",{className:"overflow-x-auto",children:T.jsxs("svg",{viewBox:`0 0 ${o} ${l}`,className:"w-full",style:{minWidth:400,maxHeight:300},children:[a.map((e,t)=>r.map((s,o)=>{const l=s.amount/(n.totalIncome||1),i=e.height*l;if(i<.5)return null;const c=e.x+16,d=e.y+o/r.length*e.height,x=s.x,m=s.y+t/a.length*s.height,h=(c+x)/2;return T.jsx("path",{d:`M ${c} ${d} C ${h} ${d}, ${h} ${m}, ${x} ${m}`,fill:"none",stroke:s.color,strokeWidth:Math.max(i,1),opacity:.15},`${t}-${o}`)})),a.map((e,t)=>T.jsxs("g",{children:[T.jsx("rect",{x:e.x,y:e.y,width:16,height:e.height,rx:4,fill:e.color,opacity:.8}),T.jsxs("text",{x:e.x+22,y:e.y+e.height/2+4,fontSize:10,fontFamily:"Space Mono",fill:"var(--color-text-secondary)",children:[e.label," (",Bt(e.amount),")"]})]},`inc-${t}`)),r.map((e,t)=>T.jsxs("g",{children:[T.jsx("rect",{x:e.x,y:e.y,width:16,height:e.height,rx:4,fill:e.color,opacity:.8}),T.jsxs("text",{x:e.x+22,y:e.y+e.height/2+4,fontSize:10,fontFamily:"Space Mono",fill:"var(--color-text-secondary)",children:[e.label," (",Bt(e.amount),")"]})]},`cat-${t}`))]})})]})}function _t({data:e}){const t=e.map(e=>({...e,positive:e.changePercent>=0?e.changePercent:0,negative:e.changePercent<0?e.changePercent:0}));return T.jsxs(Lt,{children:[T.jsx("h3",{className:"text-lg font-bold font-display mb-4",children:"Spending Velocity"}),T.jsx("p",{className:"text-xs text-[var(--color-text-muted)] mb-4",children:"Month-over-month expense change rate with rolling average"}),T.jsx("div",{className:"h-56",children:T.jsx(m,{width:"100%",height:"100%",children:T.jsxs(S,{data:t,margin:{top:5,right:10,left:0,bottom:0},children:[T.jsx(u,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.05)"}),T.jsx(p,{dataKey:"label",stroke:"var(--color-text-muted)",fontSize:11,fontFamily:"Space Mono"}),T.jsx(g,{stroke:"var(--color-text-muted)",fontSize:11,fontFamily:"Space Mono",tickFormatter:e=>`${e.toFixed(0)}%`}),T.jsx(f,{contentStyle:{backgroundColor:"var(--color-bg-primary)",border:"1px solid var(--color-border)",borderRadius:"8px",fontSize:"12px"},formatter:(e,t)=>[`${e.toFixed(1)}%`,"positive"===t?"Increase":"negative"===t?"Decrease":"Moving Avg"]}),T.jsx(C,{y:0,stroke:"rgba(255,255,255,0.2)"}),T.jsx(k,{dataKey:"positive",fill:"#39ff14",radius:[4,4,0,0]}),T.jsx(k,{dataKey:"negative",fill:"#ff4444",radius:[0,0,4,4]}),T.jsx(M,{type:"monotone",dataKey:"movingAvg",stroke:"#00fff9",strokeWidth:2,dot:!1,name:"Avg Expenses"})]})})})]})}function Gt({bills:e}){const t=s.useMemo(()=>{if(0===e.length)return[];const t=new Map;for(const n of e){const e=kt(n.amount,n.frequency);t.set(n.category,(t.get(n.category)||0)+e)}const s=Math.max(...t.values(),1);return Array.from(t.entries()).map(([e,t])=>({category:ht[e],current:Math.round(t),fullMark:Math.round(1.2*s)})).sort((e,t)=>t.current-e.current)},[e]);return t.length<3?T.jsxs(Lt,{children:[T.jsx("h3",{className:"text-lg font-bold font-display mb-2",children:"Spending Radar"}),T.jsx("p",{className:"text-sm text-[var(--color-text-muted)] text-center py-8",children:"Add bills in 3+ categories to see radar"})]}):T.jsxs(Lt,{children:[T.jsx("h3",{className:"text-lg font-bold font-display mb-4",children:"Spending Radar"}),T.jsx("div",{className:"h-64",children:T.jsx(m,{width:"100%",height:"100%",children:T.jsxs($,{data:t,children:[T.jsx(z,{stroke:"rgba(255,255,255,0.1)"}),T.jsx(A,{dataKey:"category",tick:{fill:"var(--color-text-secondary)",fontSize:11,fontFamily:"Space Mono"}}),T.jsx(F,{tick:{fill:"var(--color-text-muted)",fontSize:10},tickFormatter:e=>`$${e}`}),T.jsx(D,{name:"Current",dataKey:"current",stroke:"#ff0080",fill:"#ff0080",fillOpacity:.2,strokeWidth:2}),T.jsx(f,{contentStyle:{backgroundColor:"var(--color-bg-primary)",border:"1px solid var(--color-border)",borderRadius:"8px",fontSize:"12px"},formatter:e=>[`$${e}`,"Monthly"]})]})})})]})}function Zt(e){return e>=75?"#39ff14":e>=55?"#00fff9":e>=35?"#ffff00":"#ff4444"}function Jt({score:e,size:t=180}){const s=(t-20)/2,n=t/2,a=t/2,r=Math.PI*s,o=e.overall/100*r,l=Zt(e.overall);return T.jsxs("div",{className:"flex flex-col items-center",children:[T.jsxs("svg",{width:t,height:t/2+20,viewBox:`0 0 ${t} ${t/2+20}`,children:[T.jsx("path",{d:`M ${n-s} ${a} A ${s} ${s} 0 0 1 ${n+s} ${a}`,fill:"none",stroke:"rgba(255,255,255,0.05)",strokeWidth:10,strokeLinecap:"round"}),T.jsx("path",{d:`M ${n-s} ${a} A ${s} ${s} 0 0 1 ${n+s} ${a}`,fill:"none",stroke:l,strokeWidth:10,strokeLinecap:"round",strokeDasharray:`${r}`,strokeDashoffset:r-o,style:{filter:`drop-shadow(0 0 8px ${l}40)`}}),T.jsx("text",{x:n,y:a-8,textAnchor:"middle",className:"fill-current",style:{fontSize:"32px",fontFamily:"Orbitron, sans-serif",fontWeight:700,fill:l},children:e.overall}),T.jsx("text",{x:n,y:a+12,textAnchor:"middle",style:{fontSize:"11px",fontFamily:"Space Mono",fill:"var(--color-text-muted)"},children:"/ 100"})]}),T.jsxs("div",{className:"text-center mt-1",children:[T.jsxs("span",{className:"text-lg font-bold font-display",style:{color:l},children:["Grade: ",e.grade]}),T.jsxs("p",{className:"text-xs text-[var(--color-text-muted)] capitalize",children:[e.riskLevel," risk"]})]}),T.jsx("div",{className:"w-full mt-4 space-y-1.5",children:Object.entries(e.breakdown).map(([e,t])=>T.jsxs("div",{className:"flex items-center gap-2",children:[T.jsx("span",{className:"text-xs text-[var(--color-text-secondary)] flex-1 capitalize",children:e.replace(/([A-Z])/g," $1").trim()}),T.jsx("div",{className:"w-24 h-1.5 bg-white/5 rounded-full overflow-hidden",children:T.jsx("div",{className:"h-full rounded-full transition-all",style:{width:`${t}%`,backgroundColor:Zt(t)}})}),T.jsx("span",{className:"text-xs font-mono w-8 text-right",style:{color:Zt(t)},children:t})]},e))})]})}function Xt({bills:e}){const t=s.useMemo(()=>{if(0===e.length)return[];const t=e.map(e=>kt(e.amount,e.frequency)),s=At(t),n=Ft(t),a=Math.max(...t),r=Math.max(Math.ceil(a/8),25),o=[];for(let e=0;e<=a;e+=r){const l=e+r,i=t.filter(t=>t>=e&&t<l).length;(i>0||e<a)&&o.push({range:`$${e}-${l}`,count:i,isOutlier:e>=s+2*n,from:e})}return o},[e]);return e.length<2?T.jsxs(Lt,{children:[T.jsx("h3",{className:"text-lg font-bold font-display mb-2",children:"Bill Distribution"}),T.jsx("p",{className:"text-sm text-[var(--color-text-muted)] text-center py-8",children:"Add more bills to see distribution"})]}):T.jsxs(Lt,{children:[T.jsx("h3",{className:"text-lg font-bold font-display mb-1",children:"Bill Distribution"}),T.jsx("p",{className:"text-xs text-[var(--color-text-muted)] mb-4",children:"Monthly amounts histogram · Red = outliers"}),T.jsx("div",{className:"h-48",children:T.jsx(m,{width:"100%",height:"100%",children:T.jsxs(w,{data:t,margin:{top:0,right:0,left:0,bottom:0},children:[T.jsx(p,{dataKey:"range",stroke:"var(--color-text-muted)",fontSize:10,fontFamily:"Space Mono"}),T.jsx(g,{stroke:"var(--color-text-muted)",fontSize:10,allowDecimals:!1}),T.jsx(f,{contentStyle:{backgroundColor:"var(--color-bg-primary)",border:"1px solid var(--color-border)",borderRadius:"8px",fontSize:"12px"},formatter:e=>[`${e} bill${1!==e?"s":""}`,"Count"]}),T.jsx(k,{dataKey:"count",radius:[4,4,0,0],children:t.map((e,t)=>T.jsx(N,{fill:e.isOutlier?"#ff4444":"#b026ff"},t))})]})})})]})}function Qt({values:e,width:t=80,height:s=28,color:n,showTrend:a=!0}){if(e.length<2)return null;const r=Math.min(...e),o=Math.max(...e)-r||1,l=e[e.length-1]-e[0],i=n||(l>=0?"#39ff14":"#ff4444"),c=e.map((n,a)=>`${2+a/(e.length-1)*(t-4)},${2+(1-(n-r)/o)*(s-4)}`).join(" ");return T.jsxs("div",{className:"inline-flex items-center gap-1.5",children:[T.jsxs("svg",{width:t,height:s,className:"flex-shrink-0",children:[T.jsx("polyline",{points:c,fill:"none",stroke:i,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),e.length>0&&T.jsx("circle",{cx:2+(e.length-1)/(e.length-1)*(t-4),cy:2+(1-(e[e.length-1]-r)/o)*(s-4),r:2,fill:i})]}),a&&T.jsxs("span",{className:"text-xs font-mono",style:{color:i},children:[l>=0?"+":"",(l/(e[0]||1)*100).toFixed(0),"%"]})]})}const es={info:{icon:me,borderClass:"border-l-neon-cyan",bgClass:"bg-neon-cyan/5",iconClass:"text-neon-cyan"},success:{icon:ee,borderClass:"border-l-neon-green",bgClass:"bg-neon-green/5",iconClass:"text-neon-green"},warning:{icon:G,borderClass:"border-l-neon-yellow",bgClass:"bg-neon-yellow/5",iconClass:"text-neon-yellow"},critical:{icon:Me,borderClass:"border-l-red-500",bgClass:"bg-red-500/5",iconClass:"text-red-400"}};function ts({insight:e,onDismiss:t}){const s=es[e.severity],n=s.icon;return T.jsxs("div",{className:x("border-l-4 rounded-r-lg p-3 flex items-start gap-3",s.borderClass,s.bgClass),children:[T.jsx(n,{size:18,className:x("flex-shrink-0 mt-0.5",s.iconClass)}),T.jsxs("div",{className:"flex-1 min-w-0",children:[T.jsxs("div",{className:"flex items-center gap-2",children:[T.jsx("h4",{className:"text-sm font-semibold",children:e.title}),e.metric&&T.jsx("span",{className:"text-xs font-mono text-[var(--color-text-muted)] bg-white/5 px-1.5 py-0.5 rounded",children:e.metric})]}),T.jsx("p",{className:"text-xs text-[var(--color-text-secondary)] mt-0.5",children:e.description})]}),t&&T.jsx("button",{onClick:()=>t(e.id),className:"text-[var(--color-text-muted)] hover:text-[var(--color-text-primary)] text-xs","aria-label":"Dismiss",children:"×"})]})}const ss=[{label:"Analyze spending",prompt:"Analyze my spending patterns and suggest optimizations."},{label:"Savings advice",prompt:"How can I improve my savings rate? Give specific suggestions."},{label:"Risk assessment",prompt:"Assess my financial risk and what I should do to improve."},{label:"Budget plan",prompt:"Create a suggested monthly budget based on my income and expenses."},{label:"Reduce bills",prompt:"Which bills or categories should I focus on reducing first?"}],ns=ot((e,t)=>({apiKey:localStorage.getItem("finvis-ai-key")||"",enabled:"true"===localStorage.getItem("finvis-ai-enabled"),messages:[],loading:!1,error:null,setApiKey:t=>{localStorage.setItem("finvis-ai-key",t),e({apiKey:t})},setEnabled:t=>{localStorage.setItem("finvis-ai-enabled",String(t)),e({enabled:t})},sendMessage:async(s,n,a,r)=>{const{apiKey:o,messages:l}=t();if(!o)return void e({error:"API key not configured. Go to Settings to add your Claude API key."});e({loading:!0,error:null});const i=[...l,{role:"user",content:s}];e({messages:i});try{const t=await async function(e,t,s,n,a){var r;const o={model:"claude-sonnet-4-5-20250929",max_tokens:1024,system:`${t}\n\n${s}`,messages:[...n.map(e=>({role:e.role,content:e.content})),{role:"user",content:a}]},l=await fetch("https://api.anthropic.com/v1/messages",{method:"POST",headers:{"Content-Type":"application/json","x-api-key":e,"anthropic-version":"2023-06-01","anthropic-dangerous-direct-browser-access":"true"},body:JSON.stringify(o)});if(!l.ok){const e=await l.text();throw new Error(`API error ${l.status}: ${e}`)}const i=null==(r=(await l.json()).content)?void 0:r.find(e=>"text"===e.type);return(null==i?void 0:i.text)||"No response generated."}(o,"You are FinVis AI, a helpful and non-judgmental financial advisor built into a privacy-first finance app. Your role:\n\n1. Analyze the user's financial data and provide actionable insights\n2. Be encouraging, never shaming about spending\n3. Focus on practical, specific suggestions\n4. Use the financial context provided to give personalized advice\n5. Keep responses concise (2-3 paragraphs max)\n6. Use currency formatting and percentages when relevant\n7. If asked about something outside your financial context, politely redirect\n\nImportant: All user financial data stays on their device. You only see aggregated summaries, never raw transaction data.",function(e,t,s){const n=Mt(t),a=Ct(e),r=n>0?(n-a)/n*100:0,o=$t(e).map(e=>`  ${ht[e.category]}: ${Bt(e.total)}/mo (${e.percentage.toFixed(1)}%)`).join("\n");return`Financial Overview:\n- Monthly income: ${Bt(n)} from ${t.length} source(s)\n- Monthly expenses: ${Bt(a)} across ${e.length} bill(s)\n- Net monthly: ${Bt(n-a)}\n- Savings rate: ${r.toFixed(1)}%\n- Financial health score: ${s.overall}/100 (Grade: ${s.grade}, ${s.riskLevel} risk)\n\nCategory Breakdown:\n${o}\n\nHealth Score Breakdown:\n- Savings Rate: ${s.breakdown.savingsRate}/100\n- Income Stability: ${s.breakdown.incomeStability}/100\n- Expense Flexibility: ${s.breakdown.expenseFlexibility}/100\n- Emergency Runway: ${s.breakdown.emergencyRunway}/100\n- Bill Concentration: ${s.breakdown.billConcentration}/100`}(n,a,r),l,s);e({messages:[...i,{role:"assistant",content:t}],loading:!1})}catch(c){e({error:c instanceof Error?c.message:"Failed to get AI response",loading:!1})}},clearHistory:()=>e({messages:[],error:null})}));function as(){const{messages:e,loading:t,error:n,enabled:a,sendMessage:r,clearHistory:o}=ns(),l=yt(e=>e.bills),i=jt(e=>e.incomes),[c,d]=s.useState(""),[m,h]=s.useState(!1),u=s.useRef(null);if(s.useEffect(()=>{var e;null==(e=u.current)||e.scrollTo(0,u.current.scrollHeight)},[e]),!a)return null;const p=Et(l,i),g=async()=>{const e=c.trim();e&&!t&&(d(""),await r(e,l,i,p))};return T.jsxs("div",{className:"rounded-xl border border-[var(--color-border)] bg-[var(--color-bg-secondary)] overflow-hidden",children:[T.jsxs("button",{onClick:()=>h(!m),className:"w-full flex items-center justify-between p-4 hover:bg-white/5 transition-colors",children:[T.jsxs("div",{className:"flex items-center gap-2",children:[T.jsx(X,{size:20,className:"text-neon-purple"}),T.jsx("h3",{className:"text-sm font-bold font-display",children:"FinVis AI"}),T.jsx("span",{className:"text-[10px] bg-neon-purple/20 text-neon-purple px-1.5 py-0.5 rounded-full",children:"Claude"})]}),m?T.jsx(se,{size:16}):T.jsx(re,{size:16})]}),!m&&T.jsxs("div",{className:"border-t border-[var(--color-border)]",children:[T.jsxs("div",{ref:u,className:"h-64 overflow-y-auto p-4 space-y-3",children:[0===e.length&&T.jsxs("div",{className:"text-center py-6",children:[T.jsx(X,{size:32,className:"mx-auto text-[var(--color-text-muted)] mb-2"}),T.jsx("p",{className:"text-sm text-[var(--color-text-secondary)]",children:"Ask me anything about your finances"}),T.jsx("div",{className:"flex flex-wrap gap-2 justify-center mt-3",children:ss.map(e=>T.jsx("button",{onClick:()=>(async e=>{t||await r(e,l,i,p)})(e.prompt),className:"text-xs px-2.5 py-1 rounded-full border border-[var(--color-border)] text-[var(--color-text-secondary)] hover:border-neon-purple hover:text-neon-purple transition-colors",children:e.label},e.label))})]}),e.map((e,t)=>T.jsx("div",{className:x("text-sm rounded-lg p-3 max-w-[90%]","user"===e.role?"bg-neon-pink/10 ml-auto":"bg-white/5"),children:T.jsx("p",{className:"whitespace-pre-wrap",children:e.content})},t)),t&&T.jsx("div",{className:"bg-white/5 rounded-lg p-3 max-w-[90%]",children:T.jsxs("div",{className:"flex items-center gap-2 text-sm text-[var(--color-text-muted)]",children:[T.jsx("div",{className:"w-2 h-2 bg-neon-purple rounded-full animate-pulse"}),"Thinking..."]})}),n&&T.jsx("div",{className:"text-xs text-red-400 bg-red-500/10 rounded-lg p-2",children:n})]}),T.jsxs("div",{className:"p-3 border-t border-[var(--color-border)] flex gap-2",children:[T.jsx("input",{value:c,onChange:e=>d(e.target.value),onKeyDown:e=>"Enter"===e.key&&g(),placeholder:"Ask FinVis AI...",className:"flex-1 bg-[var(--color-bg-primary)] border border-[var(--color-border)] rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-neon-purple",disabled:t}),T.jsx("button",{onClick:g,disabled:t||!c.trim(),className:"p-2 rounded-lg bg-neon-purple/20 text-neon-purple hover:bg-neon-purple/30 transition-colors disabled:opacity-50",children:T.jsx(ve,{size:16})}),e.length>0&&T.jsx("button",{onClick:o,className:"p-2 rounded-lg hover:bg-white/10 text-[var(--color-text-muted)] transition-colors","aria-label":"Clear chat",children:T.jsx(we,{size:16})})]})]})]})}function rs(){return T.jsx("div",{className:"flex items-center justify-center py-16",children:T.jsx("div",{className:"w-10 h-10 border-4 border-[var(--color-border)] border-t-neon-pink rounded-full animate-spin"})})}function os(){const{bills:e,loading:t,loadBills:n}=yt(),{incomes:a,loading:r,loadIncomes:o}=jt(),[l,i]=s.useState(new Set);s.useEffect(()=>{n(),o()},[n,o]);const c=s.useMemo(()=>Mt(a),[a]),d=s.useMemo(()=>Ct(e),[e]),m=s.useMemo(()=>function(e,t){const s=e.reduce((e,t)=>e+kt(t.amount,t.frequency),0),n=t-s;return{totalExpenses:s,remaining:n,savingsRate:t>0?n/t*100:0,billCount:e.length,paidCount:e.filter(e=>e.isPaid).length}}(e,c),[e,c]),h=s.useMemo(()=>Et(e,a),[e,a]),u=s.useMemo(()=>function(e,t){const s=[],n=Mt(t),a=Ct(e),r=n>0?(n-a)/n*100:0;if(0===e.length&&0===t.length)return[{id:"empty",title:"Get Started",description:"Add your income sources and bills to unlock smart insights.",severity:"info",category:"setup"}];r>=30?s.push({id:"savings-excellent",title:"Excellent Savings Rate",description:`You're saving ${r.toFixed(1)}% of your income. Outstanding financial discipline.`,severity:"success",category:"savings",metric:`${r.toFixed(1)}%`}):r>=15?s.push({id:"savings-good",title:"Healthy Savings Rate",description:`Saving ${r.toFixed(1)}% — above the recommended 15% minimum.`,severity:"success",category:"savings",metric:`${r.toFixed(1)}%`}):r>=0?s.push({id:"savings-low",title:"Low Savings Rate",description:`Only ${r.toFixed(1)}% savings rate. Consider reducing variable expenses to hit the 15% target.`,severity:"warning",category:"savings",metric:`${r.toFixed(1)}%`}):s.push({id:"savings-negative",title:"Spending Exceeds Income",description:`You're spending ${Bt(Math.abs(n-a))} more than you earn monthly. This is unsustainable.`,severity:"critical",category:"savings",metric:Bt(n-a)});const o=$t(e)[0];if(o&&o.percentage>50&&s.push({id:"concentration-high",title:"High Spending Concentration",description:`${ht[o.category]} accounts for ${o.percentage.toFixed(0)}% of all spending. Consider diversifying costs.`,severity:"warning",category:"concentration",metric:`${o.percentage.toFixed(0)}%`}),e.length>=3){const t=e.map(e=>kt(e.amount,e.frequency));for(let n=0;n<e.length;n++)Dt(t[n],t)>2&&s.push({id:`anomaly-${e[n].id}`,title:"Unusually High Bill",description:`"${e[n].name}" at ${Bt(t[n])}/mo is significantly higher than your average bill (${Bt(At(t))}/mo).`,severity:"info",category:"anomaly",metric:Bt(t[n])})}const l=zt(e,t,new Date,6).filter(e=>e.netCashFlow<0);if(l.length>0&&s.push({id:"forecast-tight",title:`${l.length} Tight Month${l.length>1?"s":""} Ahead`,description:`${l.map(e=>e.label).join(", ")} show negative cash flow. Plan ahead.`,severity:l.length>=3?"critical":"warning",category:"forecast",metric:`${l.length} months`}),e.length>=2){const n=Rt(e,t,6);n.heaviestWeek.amount>0&&s.push({id:"heavy-week",title:"Heaviest Payment Period",description:`${n.heaviestWeek.weekLabel} is your heaviest payment window at ${Bt(n.heaviestWeek.amount)}/mo. Consider spreading due dates.`,severity:"info",category:"pattern",metric:n.heaviestWeek.weekLabel}),n.fixedVsVariableRatio.ratio>.75&&s.push({id:"inflexible",title:"High Fixed Costs",description:`${(100*n.fixedVsVariableRatio.ratio).toFixed(0)}% of spending is fixed (housing, insurance, debt). Limited room to cut in emergencies.`,severity:"warning",category:"flexibility",metric:`${(100*n.fixedVsVariableRatio.ratio).toFixed(0)}%`})}const i=Et(e,t);s.push({id:"health-score",title:`Financial Health: ${i.grade}`,description:`Overall score: ${i.overall}/100 (${i.riskLevel} risk). ${i.overall>=70?"Keep it up!":"Room for improvement."}`,severity:i.overall>=70?"success":i.overall>=45?"warning":"critical",category:"health",metric:`${i.overall}/100`}),1===t.length&&s.push({id:"single-income",title:"Single Income Source",description:"All income comes from one source. Consider diversifying to reduce risk.",severity:"info",category:"income",metric:"1 source"});const c=e.filter(e=>"subscriptions"===e.category);if(c.length>=5){const e=c.reduce((e,t)=>e+kt(t.amount,t.frequency),0);s.push({id:"sub-audit",title:"Subscription Audit Recommended",description:`You have ${c.length} subscriptions totaling ${Bt(e)}/mo. Review for unused services.`,severity:"info",category:"optimization",metric:Bt(e)})}const d={critical:0,warning:1,success:2,info:3};return s.sort((e,t)=>d[e.severity]-d[t.severity]),s}(e,a),[e,a]),p=s.useMemo(()=>Rt(e,a,6),[e,a]),g=s.useMemo(()=>zt(e,a,new Date,6),[e,a]),f=g.map(e=>e.totalIncome),y=g.map(e=>e.totalExpenses),b=g.map(e=>e.runningBalance),v=u.filter(e=>!l.has(e.id)),j=m.remaining>=0;return t||r?T.jsx(rs,{}):T.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[T.jsxs("header",{className:"flex items-center justify-between",children:[T.jsxs("div",{children:[T.jsx("h1",{className:"text-3xl font-bold font-display bg-gradient-to-r from-neon-pink via-neon-purple to-neon-cyan bg-clip-text text-transparent",children:"Dashboard"}),T.jsx("p",{className:"text-sm text-[var(--color-text-secondary)] mt-1",children:"Financial command center"})]}),T.jsx("div",{className:"flex items-center gap-2",children:T.jsxs("div",{className:x("px-3 py-1.5 rounded-full text-xs font-bold font-mono border",h.overall>=70?"border-neon-green/30 text-neon-green bg-neon-green/10":h.overall>=45?"border-neon-yellow/30 text-neon-yellow bg-neon-yellow/10":"border-red-500/30 text-red-400 bg-red-500/10"),children:["Health: ",h.overall,"/100"]})})]}),T.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[T.jsxs(Lt,{children:[T.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[T.jsx(ie,{size:16,className:"text-neon-green"}),T.jsx("span",{className:"text-xs text-[var(--color-text-muted)]",children:"Monthly Income"})]}),T.jsx("p",{className:"text-xl font-bold font-mono text-neon-green",children:Bt(c)}),T.jsx("div",{className:"mt-2",children:T.jsx(Qt,{values:f,color:"#39ff14"})})]}),T.jsxs(Lt,{children:[T.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[T.jsx(be,{size:16,className:"text-neon-pink"}),T.jsx("span",{className:"text-xs text-[var(--color-text-muted)]",children:"Monthly Expenses"})]}),T.jsx("p",{className:"text-xl font-bold font-mono text-neon-pink",children:Bt(d)}),T.jsx("div",{className:"mt-2",children:T.jsx(Qt,{values:y,color:"#ff0080"})})]}),T.jsxs(Lt,{children:[T.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[j?T.jsx(fe,{size:16,className:"text-neon-green"}):T.jsx(G,{size:16,className:"text-red-400"}),T.jsx("span",{className:"text-xs text-[var(--color-text-muted)]",children:"Net Cash Flow"})]}),T.jsxs("p",{className:x("text-xl font-bold font-mono",j?"text-neon-green":"text-red-400"),children:[j?"+":"",Bt(m.remaining)]}),T.jsx("div",{className:"mt-2",children:T.jsx(Qt,{values:b})})]}),T.jsxs(Lt,{children:[T.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[T.jsx(_,{size:16,className:"text-neon-purple"}),T.jsx("span",{className:"text-xs text-[var(--color-text-muted)]",children:"Savings Rate"})]}),T.jsxs("p",{className:x("text-xl font-bold font-mono",m.savingsRate>20?"text-neon-green":m.savingsRate>0?"text-neon-yellow":"text-red-400"),children:[m.savingsRate.toFixed(1),"%"]}),T.jsxs("div",{className:"mt-2 flex items-center gap-1.5",children:[m.savingsRate>=15?T.jsx(Se,{size:14,className:"text-neon-green"}):T.jsx(ke,{size:14,className:"text-red-400"}),T.jsx("span",{className:"text-xs text-[var(--color-text-muted)]",children:m.savingsRate>=15?"On target":"Below 15% target"})]})]})]}),T.jsxs(Lt,{children:[T.jsxs("div",{className:"flex items-center justify-between mb-3",children:[T.jsx("h3",{className:"text-sm font-semibold text-[var(--color-text-secondary)]",children:"Bills Paid This Month"}),T.jsxs("span",{className:"text-sm font-mono",children:[m.paidCount,"/",m.billCount]})]}),T.jsx("div",{className:"h-2 bg-white/5 rounded-full overflow-hidden",children:T.jsx("div",{className:"h-full bg-gradient-to-r from-neon-pink to-neon-cyan rounded-full transition-all",style:{width:(m.billCount>0?m.paidCount/m.billCount*100:0)+"%"}})})]}),v.length>0&&T.jsxs("div",{children:[T.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[T.jsx(Q,{size:18,className:"text-neon-purple"}),T.jsx("h2",{className:"text-lg font-bold font-display",children:"Smart Insights"}),T.jsx("span",{className:"text-xs bg-neon-purple/20 text-neon-purple px-2 py-0.5 rounded-full",children:v.length})]}),T.jsx("div",{className:"grid gap-2 sm:grid-cols-2",children:v.map(e=>T.jsx(ts,{insight:e,onDismiss:e=>i(t=>new Set([...t,e]))},e.id))})]}),T.jsx(as,{}),T.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[T.jsx(Ht,{bills:e,incomes:a}),T.jsx(Ut,{bills:e,incomes:a})]}),T.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[T.jsx(Kt,{bills:e}),T.jsx(Yt,{bills:e,incomes:a})]}),T.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[T.jsx(_t,{data:p.spendingVelocity}),T.jsx(Gt,{bills:e})]}),T.jsx(Tt,{bills:e}),T.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[T.jsxs(Lt,{children:[T.jsx("h3",{className:"text-lg font-bold font-display mb-4",children:"Financial Health"}),T.jsx(Jt,{score:h})]}),T.jsx(Xt,{bills:e})]})]})}function ls({bill:e,onEdit:t,onDelete:s,onTogglePaid:n}){const a=kt(e.amount,e.frequency);return T.jsx(Lt,{hover:!0,className:x("relative",e.isPaid&&"opacity-60"),children:T.jsxs("div",{className:"flex items-start justify-between gap-3",children:[T.jsxs("div",{className:"flex-1 min-w-0",children:[T.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[T.jsx("div",{className:"w-2.5 h-2.5 rounded-full flex-shrink-0",style:{backgroundColor:ut[e.category]}}),T.jsx("h4",{className:"font-semibold truncate",children:e.name}),e.isPaid&&T.jsx("span",{className:"text-xs bg-neon-green/20 text-neon-green px-2 py-0.5 rounded-full",children:"Paid"})]}),T.jsxs("div",{className:"flex items-baseline gap-2",children:[T.jsx("span",{className:"text-xl font-mono font-bold text-neon-cyan",children:Bt(e.amount)}),T.jsxs("span",{className:"text-xs text-[var(--color-text-muted)]",children:["/ ",mt[e.frequency].toLowerCase()]})]}),"monthly"!==e.frequency&&T.jsxs("p",{className:"text-xs text-[var(--color-text-muted)] font-mono mt-0.5",children:[Bt(a),"/mo equivalent"]}),T.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[T.jsx("span",{className:"text-xs text-[var(--color-text-secondary)] bg-white/5 px-2 py-0.5 rounded",children:ht[e.category]}),T.jsxs("span",{className:"text-xs text-[var(--color-text-muted)]",children:["Due: Day ",e.dueDay]})]}),e.notes&&T.jsx("p",{className:"text-xs text-[var(--color-text-muted)] mt-2 italic",children:e.notes})]}),T.jsxs("div",{className:"flex flex-col gap-1",children:[T.jsx("button",{onClick:()=>n(e.id),className:x("p-1.5 rounded-lg transition-colors",e.isPaid?"bg-neon-green/20 text-neon-green":"hover:bg-white/10 text-[var(--color-text-muted)]"),"aria-label":e.isPaid?"Mark unpaid":"Mark paid",children:T.jsx(te,{size:16})}),T.jsx("button",{onClick:()=>t(e),className:"p-1.5 rounded-lg hover:bg-white/10 text-[var(--color-text-muted)] transition-colors","aria-label":"Edit bill",children:T.jsx(ge,{size:16})}),T.jsx("button",{onClick:()=>s(e.id),className:"p-1.5 rounded-lg hover:bg-red-500/10 text-[var(--color-text-muted)] hover:text-red-400 transition-colors","aria-label":"Delete bill",children:T.jsx(we,{size:16})})]})]})})}function is({variant:e="primary",size:t="md",children:s,className:n,...a}){return T.jsx("button",{className:x("inline-flex items-center justify-center gap-2 rounded-lg font-semibold transition-all","disabled:opacity-50 disabled:cursor-not-allowed",{"bg-gradient-to-r from-neon-pink via-neon-purple to-neon-cyan text-white hover:shadow-glow-pink hover:-translate-y-0.5 active:translate-y-0":"primary"===e,"border-2 border-neon-cyan text-neon-cyan hover:bg-neon-cyan/10":"secondary"===e,"border-2 border-red-500 text-red-400 hover:bg-red-500/10":"danger"===e,"text-[var(--color-text-secondary)] hover:text-[var(--color-text-primary)] hover:bg-white/5":"ghost"===e},{"px-3 py-1.5 text-sm":"sm"===t,"px-5 py-2.5 text-sm":"md"===t,"px-6 py-3 text-base":"lg"===t},n),...a,children:s})}function cs({label:e,hint:t,error:s,prefix:n,className:a,id:r,...o}){const l=r||e.toLowerCase().replace(/\s+/g,"-");return T.jsxs("div",{className:"flex flex-col gap-1.5",children:[T.jsx("label",{htmlFor:l,className:"text-sm font-semibold text-[var(--color-text-primary)]",children:e}),T.jsxs("div",{className:"relative",children:[n&&T.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-[var(--color-text-muted)] font-mono",children:n}),T.jsx("input",{id:l,className:x("w-full rounded-lg border-2 border-[var(--color-border)] bg-[var(--color-bg-secondary)]","px-3 py-2.5 text-[var(--color-text-primary)]","transition-colors focus:border-[var(--color-accent)] focus:outline-none","placeholder:text-[var(--color-text-muted)]",n&&"pl-8",s&&"border-red-500",a),"aria-describedby":t?`${l}-hint`:void 0,"aria-invalid":!!s,...o})]}),t&&!s&&T.jsx("span",{id:`${l}-hint`,className:"text-xs text-[var(--color-text-muted)]",children:t}),s&&T.jsx("span",{role:"alert",className:"text-xs text-red-400",children:s})]})}function ds({label:e,options:t,className:s,id:n,...a}){const r=n||e.toLowerCase().replace(/\s+/g,"-");return T.jsxs("div",{className:"flex flex-col gap-1.5",children:[T.jsx("label",{htmlFor:r,className:"text-sm font-semibold text-[var(--color-text-primary)]",children:e}),T.jsx("select",{id:r,className:x("w-full rounded-lg border-2 border-[var(--color-border)] bg-[var(--color-bg-secondary)]","px-3 py-2.5 text-[var(--color-text-primary)]","transition-colors focus:border-[var(--color-accent)] focus:outline-none",s),...a,children:t.map(e=>T.jsx("option",{value:e.value,children:e.label},e.value))})]})}function xs({bill:e,onSubmit:t,onCancel:n}){var a,r;const[o,l]=s.useState((null==e?void 0:e.name)||""),[i,c]=s.useState((null==(a=null==e?void 0:e.amount)?void 0:a.toString())||""),[d,x]=s.useState((null==e?void 0:e.frequency)||"monthly"),[m,h]=s.useState((null==e?void 0:e.category)||"other"),[u,p]=s.useState((null==e?void 0:e.type)||"ongoing"),[g,f]=s.useState((null==(r=null==e?void 0:e.dueDay)?void 0:r.toString())||"1"),[y,b]=s.useState((null==e?void 0:e.notes)||""),[v,j]=s.useState({});return T.jsxs("form",{onSubmit:s=>{s.preventDefault(),(()=>{const e={};o.trim()||(e.name="Name is required");const t=parseFloat(i);(!i||isNaN(t)||t<=0)&&(e.amount="Enter a valid amount");const s=parseInt(g);return(isNaN(s)||s<1||s>31)&&(e.dueDay="Enter a day between 1-31"),j(e),0===Object.keys(e).length})()&&t({...e||{},name:o.trim(),amount:parseFloat(i),frequency:d,category:m,type:u,dueDay:parseInt(g),notes:y.trim()||void 0})},className:"space-y-4",children:[T.jsx(cs,{label:"Bill Name",value:o,onChange:e=>l(e.target.value),placeholder:"e.g., Rent",error:v.name}),T.jsx(cs,{label:"Amount",type:"number",value:i,onChange:e=>c(e.target.value),placeholder:"0.00",prefix:"$",step:"0.01",min:"0",error:v.amount}),T.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[T.jsx(ds,{label:"Frequency",value:d,onChange:e=>x(e.target.value),options:Object.entries(mt).map(([e,t])=>({value:e,label:t}))}),T.jsx(ds,{label:"Category",value:m,onChange:e=>h(e.target.value),options:Object.entries(ht).map(([e,t])=>({value:e,label:t}))})]}),T.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[T.jsx(ds,{label:"Type",value:u,onChange:e=>p(e.target.value),options:Object.entries(pt).map(([e,t])=>({value:e,label:t}))}),T.jsx(cs,{label:"Due Day",type:"number",value:g,onChange:e=>f(e.target.value),min:"1",max:"31",hint:"Day of month (1-31)",error:v.dueDay})]}),T.jsx(cs,{label:"Notes",value:y,onChange:e=>b(e.target.value),placeholder:"Optional notes..."}),T.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[T.jsx(is,{type:"button",variant:"ghost",onClick:n,children:"Cancel"}),T.jsx(is,{type:"submit",children:e?"Update Bill":"Add Bill"})]})]})}function ms({open:e,onClose:t,title:n,children:a}){return s.useEffect(()=>{if(!e)return;const s=e=>{"Escape"===e.key&&t()};return document.addEventListener("keydown",s),document.body.style.overflow="hidden",()=>{document.removeEventListener("keydown",s),document.body.style.overflow=""}},[e,t]),e?T.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",role:"dialog","aria-modal":"true","aria-labelledby":"modal-title",children:[T.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:t}),T.jsxs("div",{className:"relative w-full max-w-lg rounded-2xl bg-[var(--color-bg-primary)] border border-[var(--color-border)] shadow-2xl",children:[T.jsxs("div",{className:"flex items-center justify-between p-5 border-b border-[var(--color-border)]",children:[T.jsx("h2",{id:"modal-title",className:"text-lg font-bold font-display",children:n}),T.jsx("button",{onClick:t,className:"rounded-full p-1.5 hover:bg-white/10 transition-colors","aria-label":"Close",children:T.jsx($e,{size:20})})]}),T.jsx("div",{className:"p-5",children:a})]})]}):null}function hs({icon:e,title:t,description:s,action:n}){return T.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-center max-w-sm mx-auto",children:[T.jsx("div",{className:"text-[var(--color-text-muted)] mb-4",children:T.jsx(e,{size:56,strokeWidth:1})}),T.jsx("h3",{className:"text-xl font-bold mb-2",children:t}),T.jsx("p",{className:"text-sm text-[var(--color-text-secondary)] mb-6",children:s}),n]})}function us(){const{bills:e,loading:t,loadBills:n,addBill:a,updateBill:r,deleteBill:o,togglePaid:l}=yt(),[i,c]=s.useState(!1),[d,x]=s.useState(),[m,h]=s.useState(null);s.useEffect(()=>{n()},[n]);const u=e=>{x(e),c(!0)};return t?T.jsx(rs,{}):T.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[T.jsxs("div",{className:"flex items-center justify-between",children:[T.jsxs("div",{children:[T.jsx("h1",{className:"text-3xl font-bold font-display bg-gradient-to-r from-neon-pink to-neon-cyan bg-clip-text text-transparent",children:"Bills"}),T.jsxs("p",{className:"text-sm text-[var(--color-text-secondary)] mt-1",children:[e.length," bill",1!==e.length?"s":""," tracked"]})]}),T.jsxs(is,{onClick:()=>{x(void 0),c(!0)},children:[T.jsx(ye,{size:18}),"Add Bill"]})]}),0===e.length?T.jsx(hs,{icon:be,title:"No bills yet",description:"Get started by adding your first bill. We'll help you track and forecast your expenses.",action:T.jsxs(is,{onClick:()=>c(!0),children:[T.jsx(ye,{size:18}),"Add Your First Bill"]})}):T.jsx("div",{className:"grid gap-4 sm:grid-cols-2",children:e.map(e=>T.jsx(ls,{bill:e,onEdit:u,onDelete:e=>h(e),onTogglePaid:l},e.id))}),T.jsx(ms,{open:i,onClose:()=>{c(!1),x(void 0)},title:d?"Edit Bill":"Add Bill",children:T.jsx(xs,{bill:d,onSubmit:async e=>{d?await r({...d,...e}):await a(e),c(!1),x(void 0)},onCancel:()=>{c(!1),x(void 0)}})}),T.jsxs(ms,{open:!!m,onClose:()=>h(null),title:"Delete Bill?",children:[T.jsx("p",{className:"text-sm text-[var(--color-text-secondary)] mb-4",children:"Are you sure you want to delete this bill? This action cannot be undone."}),T.jsxs("div",{className:"flex justify-end gap-3",children:[T.jsx(is,{variant:"ghost",onClick:()=>h(null),children:"Cancel"}),T.jsx(is,{variant:"danger",onClick:()=>m&&(async e=>{await o(e),h(null)})(m),children:"Delete"})]})]})]})}function ps(){const{incomes:e,loading:t,loadIncomes:n,addIncome:a,updateIncome:r,deleteIncome:o}=jt(),[l,i]=s.useState(!1),[c,d]=s.useState(),[x,m]=s.useState(""),[h,u]=s.useState(""),[p,g]=s.useState("monthly");s.useEffect(()=>{n()},[n]);const f=()=>{m(""),u(""),g("monthly"),d(void 0)},y=Mt(e);return t?T.jsx(rs,{}):T.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[T.jsxs("div",{className:"flex items-center justify-between",children:[T.jsxs("div",{children:[T.jsx("h1",{className:"text-3xl font-bold font-display bg-gradient-to-r from-neon-pink to-neon-cyan bg-clip-text text-transparent",children:"Income"}),T.jsxs("p",{className:"text-sm text-[var(--color-text-secondary)] mt-1",children:["Total monthly: ",T.jsx("span",{className:"font-mono text-neon-green",children:Bt(y)})]})]}),T.jsxs(is,{onClick:()=>{f(),i(!0)},children:[T.jsx(ye,{size:18}),"Add Income"]})]}),0===e.length?T.jsx(hs,{icon:ie,title:"No income set",description:"Add your income sources to see cash flow forecasts and spending analysis.",action:T.jsxs(is,{onClick:()=>i(!0),children:[T.jsx(ye,{size:18}),"Add Income"]})}):T.jsx("div",{className:"grid gap-4 sm:grid-cols-2",children:e.map(e=>T.jsx(Lt,{hover:!0,children:T.jsxs("div",{className:"flex items-start justify-between",children:[T.jsxs("div",{children:[T.jsx("h4",{className:"font-semibold",children:e.name}),T.jsx("p",{className:"text-xl font-mono font-bold text-neon-green mt-1",children:Bt(e.amount)}),T.jsxs("p",{className:"text-xs text-[var(--color-text-muted)]",children:[bt[e.payPeriod]," ·"," ",Bt(St(e)),"/mo"]})]}),T.jsxs("div",{className:"flex gap-1",children:[T.jsx("button",{onClick:()=>(e=>{d(e),m(e.name),u(e.amount.toString()),g(e.payPeriod),i(!0)})(e),className:"p-1.5 rounded-lg hover:bg-white/10 text-[var(--color-text-muted)] transition-colors","aria-label":"Edit income",children:T.jsx(ge,{size:16})}),T.jsx("button",{onClick:()=>o(e.id),className:"p-1.5 rounded-lg hover:bg-red-500/10 text-[var(--color-text-muted)] hover:text-red-400 transition-colors","aria-label":"Delete income",children:T.jsx(we,{size:16})})]})]})},e.id))}),T.jsx(ms,{open:l,onClose:()=>{i(!1),f()},title:c?"Edit Income":"Add Income",children:T.jsxs("form",{onSubmit:async e=>{e.preventDefault();const t=parseFloat(h);!x.trim()||isNaN(t)||t<=0||(c?await r({...c,name:x.trim(),amount:t,payPeriod:p}):await a({name:x.trim(),amount:t,payPeriod:p}),f(),i(!1))},className:"space-y-4",children:[T.jsx(cs,{label:"Source Name",value:x,onChange:e=>m(e.target.value),placeholder:"e.g., Primary Job"}),T.jsx(cs,{label:"Amount",type:"number",value:h,onChange:e=>u(e.target.value),placeholder:"0.00",prefix:"$",step:"0.01",min:"0"}),T.jsx(ds,{label:"Pay Period",value:p,onChange:e=>g(e.target.value),options:Object.entries(bt).map(([e,t])=>({value:e,label:t}))}),T.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[T.jsx(is,{type:"button",variant:"ghost",onClick:()=>{i(!1),f()},children:"Cancel"}),T.jsx(is,{type:"submit",children:c?"Update":"Add Income"})]})]})})]})}const gs=[{id:"cut-subs-50",label:"Cut subscriptions 50%",description:"What if you halved all subscription costs?",apply:e=>e.map(e=>"subscriptions"===e.category?{...e,amount:.5*e.amount}:e)},{id:"cut-lifestyle-30",label:"Cut lifestyle 30%",description:"What if you reduced lifestyle spending by 30%?",apply:e=>e.map(e=>"lifestyle"===e.category?{...e,amount:.7*e.amount}:e)},{id:"lose-10pct",label:"Income drops 10%",description:"What if your income decreased by 10%?",apply:e=>e},{id:"cut-all-10",label:"Cut everything 10%",description:"What if you negotiated 10% off all bills?",apply:e=>e.map(e=>({...e,amount:.9*e.amount}))}];function fs(){var e,t;const{bills:n,loading:a,loadBills:r}=yt(),{incomes:o,loading:l,loadIncomes:i}=jt(),[c,d]=s.useState(6),[m,h]=s.useState(null);s.useEffect(()=>{r(),i()},[r,i]);const u=gs.find(e=>e.id===m),p=u?u.apply(n):n,g="lose-10pct"===m?o.map(e=>({...e,amount:.9*e.amount})):o,f=s.useMemo(()=>zt(p,g,new Date,c),[p,g,c]),y=s.useMemo(()=>zt(n,o,new Date,c),[n,o,c]),b=s.useMemo(()=>Mt(g),[g]),v=s.useMemo(()=>Ct(p),[p]),j=s.useMemo(()=>Et(p,g),[p,g]),N=s.useMemo(()=>function(e,t,s){const n=e-t;if(n>=0)return null;const a=s/Math.abs(n);return Math.floor(30*a)}(b,v,b),[b,v]);return a||l?T.jsx(rs,{}):0===n.length&&0===o.length?T.jsx("div",{className:"max-w-4xl mx-auto",children:T.jsx(hs,{icon:Se,title:"No data to forecast",description:"Add bills and income sources to see your cash flow forecast."})}):T.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[T.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-3",children:[T.jsxs("div",{children:[T.jsx("h1",{className:"text-3xl font-bold font-display bg-gradient-to-r from-neon-pink to-neon-cyan bg-clip-text text-transparent",children:"Forecast"}),T.jsxs("p",{className:"text-sm text-[var(--color-text-secondary)] mt-1",children:[c,"-month cash flow projection",m&&T.jsx("span",{className:"text-neon-yellow ml-2",children:"(What-If active)"})]})]}),T.jsx("div",{className:"flex gap-2",children:[3,6,12].map(e=>T.jsxs(is,{size:"sm",variant:c===e?"primary":"ghost",onClick:()=>d(e),children:[e,"mo"]},e))})]}),T.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[T.jsxs(Lt,{children:[T.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[T.jsx(J,{size:16,className:"text-neon-green"}),T.jsx("span",{className:"text-xs text-[var(--color-text-muted)]",children:"Monthly Income"})]}),T.jsx("p",{className:"text-xl font-mono font-bold text-neon-green",children:Bt(b)}),T.jsx(Qt,{values:f.map(e=>e.totalIncome),color:"#39ff14"})]}),T.jsxs(Lt,{children:[T.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[T.jsx(Z,{size:16,className:"text-neon-pink"}),T.jsx("span",{className:"text-xs text-[var(--color-text-muted)]",children:"Monthly Expenses"})]}),T.jsx("p",{className:"text-xl font-mono font-bold text-neon-pink",children:Bt(v)}),T.jsx(Qt,{values:f.map(e=>e.totalExpenses),color:"#ff0080"})]}),T.jsxs(Lt,{children:[T.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[null!==N?T.jsx(G,{size:16,className:"text-neon-yellow"}):T.jsx(oe,{size:16,className:"text-neon-cyan"}),T.jsx("span",{className:"text-xs text-[var(--color-text-muted)]",children:"Runway"})]}),T.jsx("p",{className:"text-xl font-mono font-bold",children:null!==N?T.jsxs("span",{className:"text-neon-yellow",children:[N," days"]}):T.jsx("span",{className:"text-neon-green",children:"Sustainable"})})]}),T.jsxs(Lt,{children:[T.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[T.jsx(Ne,{size:16,className:"text-neon-purple"}),T.jsx("span",{className:"text-xs text-[var(--color-text-muted)]",children:"Health Grade"})]}),T.jsxs("p",{className:x("text-xl font-mono font-bold",j.overall>=70?"text-neon-green":j.overall>=45?"text-neon-yellow":"text-red-400"),children:[j.grade," (",j.overall,"/100)"]})]})]}),T.jsxs(Lt,{children:[T.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[T.jsx(ze,{size:18,className:"text-neon-yellow"}),T.jsx("h3",{className:"text-sm font-bold font-display",children:"What-If Scenarios"})]}),T.jsxs("div",{className:"flex flex-wrap gap-2",children:[gs.map(e=>T.jsx("button",{onClick:()=>h(m===e.id?null:e.id),className:x("px-3 py-1.5 rounded-lg text-xs font-medium border transition-all",m===e.id?"border-neon-yellow text-neon-yellow bg-neon-yellow/10":"border-[var(--color-border)] text-[var(--color-text-secondary)] hover:border-neon-yellow/50"),title:e.description,children:e.label},e.id)),m&&T.jsx("button",{onClick:()=>h(null),className:"px-3 py-1.5 rounded-lg text-xs text-[var(--color-text-muted)] hover:text-[var(--color-text-primary)]",children:"Reset"})]}),u&&T.jsx("p",{className:"text-xs text-neon-yellow/70 mt-2",children:u.description})]}),T.jsx(Ht,{bills:p,incomes:g,months:c}),T.jsxs(Lt,{children:[T.jsx("h3",{className:"text-lg font-bold font-display mb-4",children:"Monthly Breakdown"}),T.jsx("div",{className:"overflow-x-auto",children:T.jsxs("table",{className:"w-full text-sm",children:[T.jsx("thead",{children:T.jsxs("tr",{className:"text-left text-[var(--color-text-muted)] border-b border-[var(--color-border)]",children:[T.jsx("th",{className:"pb-2 font-medium",children:"Risk"}),T.jsx("th",{className:"pb-2 font-medium",children:"Month"}),T.jsx("th",{className:"pb-2 font-medium text-right",children:"Income"}),T.jsx("th",{className:"pb-2 font-medium text-right",children:"Expenses"}),T.jsx("th",{className:"pb-2 font-medium text-right",children:"Net"}),T.jsx("th",{className:"pb-2 font-medium text-right",children:"Balance"}),m&&T.jsx("th",{className:"pb-2 font-medium text-right",children:"vs Base"})]})}),T.jsx("tbody",{children:f.map((e,t)=>{const s=e.netCashFlow>=.2*e.totalIncome?"bg-neon-green":e.netCashFlow>=0?"bg-neon-yellow":"bg-red-500",n=m&&y[t]?e.runningBalance-y[t].runningBalance:null;return T.jsxs("tr",{className:"border-b border-[var(--color-border)]/50",children:[T.jsx("td",{className:"py-2.5",children:T.jsx("div",{className:`w-2.5 h-2.5 rounded-full ${s}`,title:e.netCashFlow>=.2*e.totalIncome?"Low risk":e.netCashFlow>=0?"Moderate risk":"High risk"})}),T.jsx("td",{className:"py-2.5 font-mono",children:e.label}),T.jsx("td",{className:"py-2.5 text-right font-mono text-neon-green",children:Bt(e.totalIncome)}),T.jsx("td",{className:"py-2.5 text-right font-mono text-neon-pink",children:Bt(e.totalExpenses)}),T.jsxs("td",{className:"py-2.5 text-right font-mono "+(e.netCashFlow>=0?"text-neon-green":"text-red-400"),children:[e.netCashFlow>=0?"+":"",Bt(e.netCashFlow)]}),T.jsx("td",{className:"py-2.5 text-right font-mono "+(e.runningBalance>=0?"text-neon-cyan":"text-red-400"),children:Bt(e.runningBalance)}),m&&T.jsx("td",{className:"py-2.5 text-right font-mono text-xs "+(null!==n&&n>=0?"text-neon-green":"text-red-400"),children:null!==n?`${n>=0?"+":""}${Bt(n)}`:"-"})]},t)})})]})}),T.jsxs("div",{className:"flex items-center gap-4 mt-3 text-xs text-[var(--color-text-muted)]",children:[T.jsxs("div",{className:"flex items-center gap-1.5",children:[T.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-neon-green"}),"Low risk"]}),T.jsxs("div",{className:"flex items-center gap-1.5",children:[T.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-neon-yellow"}),"Moderate"]}),T.jsxs("div",{className:"flex items-center gap-1.5",children:[T.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-red-500"}),"High risk"]})]})]}),T.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[T.jsxs(Lt,{children:[T.jsxs("h3",{className:"text-lg font-bold font-display mb-4",children:["Financial Health",m&&T.jsx("span",{className:"text-xs text-neon-yellow ml-2",children:"(Scenario)"})]}),T.jsx(Jt,{score:j})]}),T.jsxs(Lt,{children:[T.jsx("h3",{className:"text-lg font-bold font-display mb-4",children:"Balance Projection"}),T.jsx(Qt,{values:f.map(e=>e.runningBalance),width:300,height:120}),T.jsxs("div",{className:"mt-4 grid grid-cols-2 gap-3",children:[T.jsxs("div",{children:[T.jsx("p",{className:"text-xs text-[var(--color-text-muted)]",children:"End of Period"}),T.jsx("p",{className:x("text-lg font-mono font-bold",(null==(e=f[f.length-1])?void 0:e.runningBalance)>=0?"text-neon-cyan":"text-red-400"),children:Bt((null==(t=f[f.length-1])?void 0:t.runningBalance)||0)})]}),T.jsxs("div",{children:[T.jsx("p",{className:"text-xs text-[var(--color-text-muted)]",children:"Avg Monthly Net"}),T.jsx("p",{className:"text-lg font-mono font-bold text-neon-cyan",children:Bt(f.reduce((e,t)=>e+t.netCashFlow,0)/(f.length||1))})]})]})]})]})]})}const ys=[{id:"y2k",name:"Y2K Cyberpunk",desc:"Bold neon aesthetic",preview:"from-neon-pink to-neon-cyan"},{id:"neutral",name:"Neutral",desc:"Clean professional",preview:"from-blue-500 to-blue-600"},{id:"high-contrast",name:"High Contrast",desc:"Maximum readability",preview:"from-yellow-400 to-white"},{id:"dark-minimal",name:"Dark Minimal",desc:"Sleek and modern",preview:"from-indigo-500 to-indigo-600"}];function bs(){const{theme:e,setTheme:t}=lt(),{loadBills:n}=yt(),{loadIncomes:a}=jt(),[r,o]=s.useState(!1),[l,i]=s.useState(!1),c=s.useRef(null),{apiKey:d,enabled:m,setApiKey:h,setEnabled:u}=ns();return T.jsxs("div",{className:"max-w-3xl mx-auto space-y-6",children:[T.jsx("h1",{className:"text-3xl font-bold font-display bg-gradient-to-r from-neon-pink to-neon-cyan bg-clip-text text-transparent",children:"Settings"}),T.jsxs(Lt,{children:[T.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[T.jsx(pe,{size:20,className:"text-neon-purple"}),T.jsx("h2",{className:"text-lg font-bold",children:"Theme"})]}),T.jsx("div",{className:"grid grid-cols-2 gap-3",children:ys.map(s=>T.jsxs("button",{onClick:()=>t(s.id),className:x("p-3 rounded-lg border-2 text-left transition-all",e===s.id?"border-neon-pink bg-neon-pink/10":"border-[var(--color-border)] hover:border-[var(--color-text-muted)]"),children:[T.jsx("div",{className:`h-2 w-12 rounded-full bg-gradient-to-r ${s.preview} mb-2`}),T.jsx("p",{className:"text-sm font-semibold",children:s.name}),T.jsx("p",{className:"text-xs text-[var(--color-text-muted)]",children:s.desc})]},s.id))})]}),T.jsxs(Lt,{children:[T.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[T.jsx(X,{size:20,className:"text-neon-purple"}),T.jsx("h2",{className:"text-lg font-bold",children:"FinVis AI"}),T.jsx("span",{className:"text-[10px] bg-neon-purple/20 text-neon-purple px-1.5 py-0.5 rounded-full",children:"Optional"})]}),T.jsxs("div",{className:"space-y-4",children:[T.jsxs("div",{className:"flex items-center justify-between",children:[T.jsxs("div",{children:[T.jsx("p",{className:"text-sm font-medium",children:"Enable AI Insights"}),T.jsx("p",{className:"text-xs text-[var(--color-text-muted)]",children:"Chat with Claude about your finances"})]}),T.jsx("button",{onClick:()=>u(!m),className:x("relative w-11 h-6 rounded-full transition-colors",m?"bg-neon-purple":"bg-white/10"),children:T.jsx("div",{className:x("absolute top-0.5 w-5 h-5 rounded-full bg-white transition-transform",m?"translate-x-[22px]":"translate-x-0.5")})})]}),m&&T.jsxs(T.Fragment,{children:[T.jsx("div",{className:"border-t border-[var(--color-border)]"}),T.jsxs("div",{children:[T.jsx("label",{className:"block text-sm font-medium mb-1.5",children:"Claude API Key"}),T.jsx("div",{className:"flex gap-2",children:T.jsxs("div",{className:"relative flex-1",children:[T.jsx("input",{type:l?"text":"password",value:d,onChange:e=>h(e.target.value),placeholder:"sk-ant-...",className:"w-full bg-[var(--color-bg-primary)] border border-[var(--color-border)] rounded-lg px-3 py-2 text-sm font-mono focus:outline-none focus:border-neon-purple pr-10"}),T.jsx("button",{type:"button",onClick:()=>i(!l),className:"absolute right-2 top-1/2 -translate-y-1/2 text-[var(--color-text-muted)] hover:text-[var(--color-text-primary)]",children:l?T.jsx(de,{size:16}):T.jsx(xe,{size:16})})]})}),T.jsxs("p",{className:"text-xs text-[var(--color-text-muted)] mt-1.5",children:["Get your key from"," ",T.jsx("a",{href:"https://console.anthropic.com/settings/keys",target:"_blank",rel:"noopener noreferrer",className:"text-neon-purple hover:underline",children:"console.anthropic.com"})]})]}),T.jsx("div",{className:"border-t border-[var(--color-border)]"}),T.jsxs("div",{className:"rounded-lg bg-neon-purple/5 border border-neon-purple/20 p-3",children:[T.jsx("p",{className:"text-xs font-semibold text-neon-purple mb-1",children:"Privacy Notice"}),T.jsxs("ul",{className:"text-xs text-[var(--color-text-secondary)] space-y-1 list-disc list-inside",children:[T.jsx("li",{children:"Your API key is stored locally in your browser only"}),T.jsx("li",{children:"Only aggregated summaries (totals, ratios, categories) are sent — never raw transaction details"}),T.jsx("li",{children:"Conversations are not stored on any server"}),T.jsx("li",{children:"You can disable AI at any time and all chat history is cleared"})]})]})]})]})]}),T.jsxs(Lt,{children:[T.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[T.jsx(le,{size:20,className:"text-neon-cyan"}),T.jsx("h2",{className:"text-lg font-bold",children:"Data Management"})]}),T.jsxs("div",{className:"space-y-3",children:[T.jsxs("div",{className:"flex items-center justify-between",children:[T.jsxs("div",{children:[T.jsx("p",{className:"text-sm font-medium",children:"Export Data"}),T.jsx("p",{className:"text-xs text-[var(--color-text-muted)]",children:"Download a backup of all your data"})]}),T.jsxs(is,{size:"sm",variant:"secondary",onClick:async()=>{const e=await ft.getAll(),t=await vt.getAll(),s={version:1,exportedAt:(new Date).toISOString(),data:{bills:e,incomes:t}},n=new Blob([JSON.stringify(s,null,2)],{type:"application/json"}),a=URL.createObjectURL(n),r=document.createElement("a");r.href=a,r.download=`finvis-backup-${(new Date).toISOString().split("T")[0]}.json`,r.click(),URL.revokeObjectURL(a)},children:[T.jsx(ce,{size:16}),"Export"]})]}),T.jsx("div",{className:"border-t border-[var(--color-border)]"}),T.jsxs("div",{className:"flex items-center justify-between",children:[T.jsxs("div",{children:[T.jsx("p",{className:"text-sm font-medium",children:"Import Data"}),T.jsx("p",{className:"text-xs text-[var(--color-text-muted)]",children:"Restore from a backup file"})]}),T.jsxs("div",{children:[T.jsx("input",{ref:c,type:"file",accept:".json",onChange:async e=>{var t,s,r;const o=null==(t=e.target.files)?void 0:t[0];if(o){try{const e=await o.text(),t=JSON.parse(e);if(null==(s=t.data)?void 0:s.bills)for(const s of t.data.bills)await ft.save(s);if(null==(r=t.data)?void 0:r.incomes)for(const s of t.data.incomes)await vt.save(s);await n(),await a()}catch{alert("Invalid backup file")}c.current&&(c.current.value="")}},className:"hidden"}),T.jsxs(is,{size:"sm",variant:"secondary",onClick:()=>{var e;return null==(e=c.current)?void 0:e.click()},children:[T.jsx(Ce,{size:16}),"Import"]})]})]}),T.jsx("div",{className:"border-t border-[var(--color-border)]"}),T.jsxs("div",{className:"flex items-center justify-between",children:[T.jsxs("div",{children:[T.jsx("p",{className:"text-sm font-medium text-red-400",children:"Clear All Data"}),T.jsx("p",{className:"text-xs text-[var(--color-text-muted)]",children:"Permanently delete everything"})]}),r?T.jsxs("div",{className:"flex gap-2",children:[T.jsx(is,{size:"sm",variant:"ghost",onClick:()=>o(!1),children:"Cancel"}),T.jsx(is,{size:"sm",variant:"danger",onClick:async()=>{await ft.deleteAll(),await vt.deleteAll(),await n(),await a(),o(!1)},children:"Confirm"})]}):T.jsxs(is,{size:"sm",variant:"danger",onClick:()=>o(!0),children:[T.jsx(we,{size:16}),"Clear"]})]})]})]}),T.jsxs(Lt,{children:[T.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[T.jsx(Ne,{size:20,className:"text-neon-green"}),T.jsx("h2",{className:"text-lg font-bold",children:"Privacy"})]}),T.jsxs("div",{className:"space-y-2 text-sm text-[var(--color-text-secondary)]",children:[T.jsx("p",{children:"FinVis is 100% privacy-first:"}),T.jsxs("ul",{className:"list-disc list-inside space-y-1 text-xs",children:[T.jsx("li",{children:"All data stored locally on your device (IndexedDB)"}),T.jsx("li",{children:"No data is ever sent to any server (unless AI is enabled)"}),T.jsx("li",{children:"No analytics or tracking of any kind"}),T.jsx("li",{children:"Works completely offline"}),T.jsx("li",{children:"Open source and auditable"}),m&&T.jsx("li",{className:"text-neon-purple",children:"AI mode: only aggregated summaries are sent to the Claude API"})]})]})]}),T.jsx(Lt,{children:T.jsx("p",{className:"text-xs text-center text-[var(--color-text-muted)]",children:"FinVis v2.0.0 · Privacy-First Finance Visualizer · MIT License"})})]})}function vs(){const e=lt(e=>e.theme);return s.useEffect(()=>{document.documentElement.setAttribute("data-theme",e)},[e]),T.jsx(i,{children:T.jsx(c,{children:T.jsxs(d,{element:T.jsx(xt,{}),children:[T.jsx(d,{path:"/",element:T.jsx(os,{})}),T.jsx(d,{path:"/bills",element:T.jsx(us,{})}),T.jsx(d,{path:"/income",element:T.jsx(ps,{})}),T.jsx(d,{path:"/forecast",element:T.jsx(fs,{})}),T.jsx(d,{path:"/settings",element:T.jsx(bs,{})})]})})})}H.createRoot(document.getElementById("root")).render(T.jsx(r.StrictMode,{children:T.jsx(vs,{})}));
